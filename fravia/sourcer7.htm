<HTML>

<HEAD>

  

   <TITLE>Sourcer7</TITLE>

</HEAD>

<BODY BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<P><CENTER><FONT SIZE="+3">SOURCER 7<BR>

</FONT><FONT SIZE="+2">&quot;efficiency of a well 

positioned BPINT under DOS&quot;</FONT>

<BR><BR>

<A href="advanced.htm" tppabs="http://www.anticrack.de/fravia/advanced.htm"><IMG SRC="xtranio.gif" tppabs="http://www.anticrack.de/fravia/xtranio.gif" ALT="advanced" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></A>

<BR>

Advanced cracking series

</CENTER>



<H4><CENTER><I>by Frog's Print</I><BR>   <BR>

(29 October 1997)</CENTER></H4>



<CENTER><HR><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of fravia's page of reverse engineering<BR>

<BR><I>Well, back to DOS! Was about time! Contrarly to what some 

still choose to  

believe, dos reversing is far from being an obsolete activity: many very important 

programs are working under DOS, because Windoze simply does not give enough 

power, and as +ORC told us long ago in his tut, many of the older DOS protections 

are much more tougher and interesting than the banal <FONT color="red">cmp eax, 1</FONT> tricks inside 

&quot;compiled&quot; windoze targets...<BR>

There is another very nice lesson teached here by Frog's Pint: let's not 

be lazy! Almost anyone uses a &quot;ready cracked&quot; (read &quot;stolen&quot;) Sourcer 7 version which comes with 

a pirated serial number inside it: the 

whole Web is polluted with all pirated versions of this important tool, and 

noone seems to care about the only  thing that is really 

fascinating in our opinion: how to reverse this reverser program 

'par excellence'. And Frog's Print does exactly this, and he writes:

<FONT color="blue"><BR>As we are crackers, <U>let's throw away</U> this serial number and

crack Sourcer 7.0</FONT><BR>Right! And if you add to 

these 'strategic' thoughts the whole cursor bpinting, you'll agree with me that this 

essay deserves to be posistioned among the prestigious 

&quot;Advanced cracking series&quot;. Enjoy!



</CENTER></I>

<HR qize="6"> 

<CENTER><B><FONT SIZE="+2">SOURCER 7</FONT></B></CENTER>



<CENTER><B><FONT SIZE="+2">(efficiency of a well positioned BPINT under

DOS)</FONT></B></CENTER>



<PRE>by Frog's Print -</PRE>

Sourcer 7.0 (from <A HREF="javascript:if(confirm('http://www.v-com.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.v-com.com/'" tppabs="http://www.v-com.com/">V Communications, Inc</A>)

is an excellent DOS disassembler. Though people using it for the very first

time may worry about how it works or the fact that it looks to much complicated,

it is, indeed, one of the most important Tools of the Trade.

<BR>You can easily fetch a copy on the Net. As it is not shareware, when

you find one, you'll get with it a password (which is required during the installation process)

included in the ZIP file.

<BR>As we are crackers, <U>let's throw away</U> this serial number and

crack Sourcer 7.0 comme il faut.<BR>First it's pleasant to crack a tool working under an

&quot;old&quot; OS with the brand new SoftICE 3.21, and then, a good opportunity

not to be out of practice in DOS cracking.

<BR>Note that I am using here Sourcer v7.0 but any previous versions would

work as well, as I cracked them all using the same method.



<P>Running the INSTALL.BAT will display the following message&nbsp; :



<P><TT>&nbsp;Please enter the product serial number from the Sourcer</TT>

<BR><TT>&nbsp;diskette label (i.e. SX123456-ABCD).</TT>



<P><TT>&nbsp;S/N:<B><FONT COLOR="#990000">_</FONT></B></TT>

<BR>&nbsp;

<BR>The important thing to note is the &quot;<B><FONT COLOR="#990000">_</FONT></B>&quot;

right after &quot;S/N:&quot; : this is a blinking cursor.

<BR>The program is waiting for you input and the &lt;Enter&gt; key to be pressed.



<P>If you type any number/letter, you'll see that the cusor is moved one

collumn to the right (we are in Text mode :-) and will always follow your

last input.

<BR>That's nice.

<BR>There is one Dos Interrupt that moves the cursor from one location

to another:



<P><TT>&nbsp;Int 10h function 02h</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>&nbsp;Ah = 02h</TT>

<BR><TT>&nbsp;Dh = Rows (0..24)</TT>

<BR><TT>&nbsp;Dl = Columns (0..79)</TT>

<BR>&nbsp;



<P>In Sourcer 7.0, the cursor is first positionned at row 14 (0x0e) and

column 36 (0x24).

<BR>To verify this, quit the installation program (ctrl-c) and put a Breakpoint

on Int 10h function 02h if row=14 <U>and</U> column=36 as per follow:



<P><TT>&nbsp;BPINT 10 IF Ah==02 &amp;&amp; Dh==0x0e &amp;&amp; Dl==0x24

DO &quot;rs&quot;</TT>



<P>The &quot;rs&quot; instruction is not necessary, but it will restore the program

screen instead of SoftIce's one, each time the program will break. As&nbsp;

there may be several breaks that can occur, we could then check which one

is the correct one without having to press &lt;F4&gt; each time (I'm lazy).

<BR>Now run INSTALL.BAT. You'll get 3 breaks before getting to the blinking

cursor:



<P>-1st Break:

<BR><TT>&nbsp;Please enter the product serial number from the Sourcer</TT>

<BR><TT>&nbsp;diskette label (i.e. SX123456-ABCD).</TT>



<P><TT>&nbsp;S/N:</TT>



<P>-2nd Break:

<BR><TT>&nbsp;Please enter the product serial number from the Sourcer</TT>

<BR><TT>&nbsp;diskette label (i.e. SX123456-ABCD).</TT>



<P><TT>&nbsp;S/N: (</TT>+ a green box for our input)



<P>-3rd Break:

<BR><TT>&nbsp;Please enter the product serial number from the Sourcer</TT>

<BR><TT>&nbsp;diskette label (i.e. SX123456-ABCD).</TT>



<P><TT>&nbsp;S/N: </TT>(+ text on status line)

<BR>&nbsp;



<P>-4th Break (<FONT COLOR="#000000">This is the right one with the blinking

cursor)</FONT>:

<BR><TT>&nbsp;Please enter the product serial number from the Sourcer</TT>

<BR><TT>&nbsp;diskette label (i.e. SX123456-ABCD).</TT>



<P><TT>&nbsp;S/N:<B><FONT COLOR="#990000">_</FONT></B></TT>



<P><FONT COLOR="#000000">We are now sure: we are at the correct interrupt.</FONT>

<BR><FONT COLOR="#000000">Clear your breakpoint and put another one just

on INT 10, Ah=02h:</FONT>



<P><TT>BPINT 10 IF Ah==02</TT>



<P>Type in any letter/number and SoftICE will pop-up each time. Now press

&lt;ENTER&gt; and you'll get another break.

<BR>Diseable the BreakPoint and press &lt;F2&gt; four times and you'll land

here, in SRIN.EXE :



<P><TT>00011447: 9A04006E12&nbsp; call&nbsp;&nbsp; 0126E:00004&nbsp;&nbsp;

<FONT COLOR="#000099">; That's where we come from</FONT></TT>

<BR><TT>0001144C: 83C406&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;

sp,006</TT>

<BR><TT>0001144F: 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ss</TT>

<BR><TT>00011450: 8D46EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;

ax,[bp][-0012]<FONT COLOR="#000099">; User's Input =&gt;Ax</FONT></TT>

<BR><TT>00011453: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ax</TT>

<BR><TT>00011454: 9A7F360000&nbsp; call&nbsp;&nbsp; 00000:0367F</TT>

<BR><TT>00011459: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;

sp,004</TT>

<BR><TT>0001145C: 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ss</TT>

<BR><TT>0001145D: 8D46EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;

ax,[bp][-0012]</TT>

<BR><TT>00011460: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ax</TT>

<BR><TT>00011461: 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

nop</TT>

<BR><TT>00011462: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; cs</TT>

<BR><TT>00011463: E8A100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

000011507</TT>

<BR><TT>00011466: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;

sp,004</TT>

<BR><TT>00011469: 8BF8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

di,ax</TT>

<BR><TT>0001146B: 0BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;

di,di&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

Is_Password_Correct?</FONT></TT>

<BR><TT>0001146D: 7429&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;&nbsp;

000011498&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">; Yes, jump to

Check_Again..</FONT></TT>

<BR><TT>0001146F: 9AA415F31A&nbsp; call&nbsp;&nbsp; 01AF3:015A4&nbsp;&nbsp;

<FONT COLOR="#000099">; Otherwise..</FONT></TT>

<BR><TT>00011474: 1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; ds&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Bad_guy and let him know</FONT></TT>

<BR><TT>00011475: 68981F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

01F98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

&quot;The number you have entered is not correct..&quot;</FONT></TT>

<BR><TT>00011478: 6A0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

00E</TT>

<BR><TT>0001147A: 6AFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

0FF</TT>

<BR><TT>0001147C: 6A11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

011</TT>

<BR><TT>...</TT>

<BR><TT>...</TT>

<BR><TT>0001148A: 6A0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

00E</TT>

<BR><TT>0001148C: 6AFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

0FF</TT>

<BR><TT>0001148E: 6A12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;

012</TT>

<BR><TT>00011490: 9AB502F31A&nbsp; call&nbsp;&nbsp; 01AF3:002B5</TT>

<BR><TT>00011495: 83C40A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;

sp,00A</TT>

<BR><TT>00011498: 0BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;

di,di&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

Check_Again if Pass OK!!</FONT></TT>

<BR><TT>0001149A: 7403&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;&nbsp;

00001149F&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">; Good_guy</FONT></TT>

<BR><TT>0001149C: E96CFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp&nbsp;&nbsp;&nbsp;

00001140B&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">; Bad_guy</FONT></TT>

<BR>&nbsp;

<BR>&nbsp;To crack this just change the first &quot;or di,di&quot; into a &quot;xor di,di&quot;

and the installation will work.



<P>As you can see, it's quite easy as long as you take the time to examine

your program working and know well the DOS interrupts.

<BR>You can crack ANY DOS program with the right BPINT (on that interrupt

(10h) as well as INT 21h (ah=0A...).. :- ) just because any *.Com or Dos

*.Exe files needs Interrupts to work!



<P>Frog's Print October 1997 -</PRE><FONT color="green">

(c) Frog's Print, 1997. All rights reversed.</FONT>

		<HR size="2">

<CENTER><I>You are deep inside fravia's page of reverse

engineering, choose your way out:</I></CENTER>





<P><CENTER>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="advanced.htm" tppabs="http://www.anticrack.de/fravia/advanced.htm">Back to the Advanced cracking section</A>





<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to project 1</A>



<HR width="33%">



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage </A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> <A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0" NATURALSIZEFLAG="0"> <A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity

</A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools

</A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails </A><BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database </A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia

</A><BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">is reverse engineering legal? </A></FONT></CENTER></P>



<P><CENTER><FONT SIZE="-1"><HR></FONT></CENTER>

</BODY>

</HTML>



