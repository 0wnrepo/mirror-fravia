<HTML>

                 <HEAD>

                 <!--  formamus.htm version 02 February 1998 

                       INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

                       SEARCH THIS TEXT FOR THE STRING "Your_" 

                       AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

                       THANKS A LOT: this will allow automated retrieval -->

                 <TITLE>Linux cracking</TITLE>

                 </HEAD>



                 <BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%

                 HEIGHT=" 22">

                 <TR><td></td>

                 <td>

                 <center><FONT SIZE="+2">Linux cracking</fonT><br>

                         <FONT SIZE="+1">How to crack in Linux without a

                 disassembler</fonT>

                 </center>

                 </td>



                 <td>

                 <!-- Choose  a PROJECT GIF, leave this if unsure -->

                 <center><a href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif"

                 ALT="student" 

                 ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

                 HSPACE=0></a>

                 <br>

                 <font color=gray>Not Assigned</FonT>

                 </center></td></tr>

                 <tR>

                 <td bgcolor="#FFFFEA"><center>

                 <FONT COLOR="890000">

                 <!-- CHOOSE A DATE (will probably be changed) -->

                 26th October 1998

                 </FONT></center>

                 </td>

                 <td bgcolor="#FFFFEA"><center>by <font size=+3>

                 <!-- CHOOSE A HANDLE (wont be changed) -->

                 adq

                 </fonT></center>

                 </td>

                 <td VALIGN="center" bgcolor="#FFFFEA">

                 <!--

                 <a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 

                 WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

                 -->

                 </td>

                 </tr>

                 <TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

                 ALIGN="BOTTOM" 

                 BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>

                 <TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 

                 reverse engineering</center> 

                 </center></TD>

                 <td BGCOLOR="898030">

                 <center>

                 </center></td>

                 </TR>

                 <!-- this is for the

                 data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->

                 <tr><td><font

                 color="#C4C0CF">fra_00xx<bR>98xxxx<br>handle<br>1100<br>NA<br>PC<br></fonT></td><td><i><center>

                 Well, well: adq is back with a Linux reversing essay that will surely 

be welcome among the rapidly growing community of Linux users among my readers (I wonder how comes that noone that 

made the 'great sprung' and went from windoze to Linux, happened to go back to Windoze :-) 

As a matter of fact many good reversers are (almost) not publishing essays any more because they 

have lost any interest whatsoever in windozed targets... in fact -as you should know- 

if you'r seriously working (and not just playing with a mouse) you can work in Linux 

QUICKER, BETTER, and with a greater efficacity... I guess that the last one of my readers 

 remaining in windoze will have soon to turn the lights off in an empty room... 

you don't believe me? Look 

better around you: see Micro$oft's building over there? Getting dark isn't it? That's 

because there 

are less and less people behind 

its windows... :-)

                 </i></center></td>

                 <td></td>

                 </tr>

                 <TR><td></td>

                 <!-- Leonard Coehn's old song, because we are poets, not only crackers

                 -->

                 <TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in

                 everything 

                 That's how the light gets in</b></center>

                 <!-- Leonard Coehn's old song, because we are poets, not only crackers

                 -->

                 </center></TD><td></td>

                 </TR>

                 <TR>

                 <td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

                 Rating</FONT></FONT></center>

                 </TD>

                 <td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

                 <!-- CHOOSE A RATING (may be changed) -->

                 ( )<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> (

                 )<B>Expert</B></FONT>

                 </center></td>

                 <td></td>

                 </tr>

                 </table>

                 <!-- END HEAD  -->

                 <bR>

                 <!-- CORPUS  -->



                 <!-- CHOOSE A COMMENT (may be changed)  -->

                 This is for anyone running linux with gcc and who knows a bit of C.

                 <hR>

                 <center>

                    <FONT SIZE="+2">

                 <!-- CHOOSE A TITLE (wont probably be changed) -->

                 Linux cracking

                    </FONT><BR>

                    <FONT SIZE="+2">

                 <!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->

                 How to crack in Linux without a disassembler

                    </FONT><BR>

                    <FONT COLOR="0B7FC1">

                 <!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 

                 adq

                    </FONT>

                 </center><br><br>



                 <!-- INTRO STARTS HERE -->

                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"

                 HEIGHT="22" >

                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font

                 color=blue>Introduction</fonT>

                 </fonT></center></td></tr></table>

                 The following describes how to modify the behaviour of a linux program

                 by 

                 replacing any external library functions it uses.

                 <br><br>



                 <!-- TOOLS STARTS HERE -->

                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"

                 HEIGHT="22" >

                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools

                 required</fonT>

                 </fonT></center></td></tr></table>

                 Linux, gcc, emacs

                 <br><br>





                 <!-- REAL ESSAY  STARTS HERE -->

                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"

                 HEIGHT="22" >

                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font

                 color=blue>Essay</fonT></fonT>

                 </center></td></tr></table>

                 I have been reading the various other essays on linux, but no one else

                 seems to have mentioned this very easy way of modifying a compiled

                 program's

                 behaviour... without even looking at a disassembly.<P>



                 First of all, write a demo program, called timetest:<BR>



                 <PRE>

                   #include &lt;stdio.h>

                   #include &lt;time.h>



                   int main(int argc, char* argv[])

                   {

                     time_t curTime;

                     struct tm *curTimeDecoded;



                     time(&curTime);

                     curTimeDecoded = localtime(&curTime);

                  

                     if (curTimeDecoded->tm_year > 95)

                       printf("Too late\n");

                     else

                       printf("In time\n");

                   }

                 </PRE>



                 Put this in a file, "timetest.c", and compile as follows:<BR>

                 <PRE>

                         gcc -o timetest timetest.c

                 </PRE>



                 You will end up with a program which checks the year. If the year

                 is more than 1995, it will print "Too late". If less than or equal to

                 1995, it prints "In time".



                 To patch this in windows so that it always prints "In time", would be

                 a simple

                 matter of loading the thing into a debugger, tracing through it to

                 find the

                 call & patching it. Or perhaps you prefer to use a dead-listing and

                 IDA.<P>



                 On linux, there is another, much easier way. Edit a new file, this

                 time

                 called "time.c", and put the following in it:

                called "time.c", and put the following in it:

                 <PRE>

                   #include &lt;time.h>

                   #include &lt;stdio.h>



                   time_t time(time_t* tp)

                   {

                     printf("haha\n");

                   

                     return(2000);

                   }

                 </PRE>



                 As you can see, this is a replacement time() function, which prints

                 "haha", and

                 returns a system time of 2000.<P>



                 This time, compile it as follows:<BR>

                 <PRE>

                         gcc -c time.c -o time.o

                         ld -shared -o time.so time.o

                 </PRE>



                 The second line transforms the normal object file produced by the

                 first line

                 into a shared object library. This step is essential, or you will end

                 up with strange errors such as "ELF file's phentsize not the expected

                 size".<P>



                 Now, to fix the program, type "export LD_PRELOAD=./time.so". This

                 instructs

                 the linux runtime linker (ld.so* or ld-linux.so*) to look in this

                 library

                 for functions before consulting the normal system libraries, when it

                 is

                 attempting to satisfy the program's dependencies.<P>



                 Run the program, and it will print "haha", followed by "In time", no

                 matter

                 what the system time is. Be warned though... since you exported

                 LD_PRELOAD,

                 this will affect every program in your current shell until you either

                 unset 

                 LD_PRELOAD, or exit the shell.<P>



                 However, there is a slight problem. If you only want to fiddle the

                 times on certain occasions, but use the normal time() call on others,

                 you 

                 cannot simply call time() - that will call yourself and you will end

                 up with 

                 a nasty recursive loop. The way I got round this was by finding the

                 import

                 table in the ELF binary, and changing the name of the function it

                 imports

                 from "time" to something like "Xime". Then, I wrote my own version of

                 Xime,

                 which is obviously then free to call the real time() function, since

                 we

                 haven't overridden it. This can all be done within emacs, using normal

                 text

                 search & replace. There is probably a better way to do this though.<P>









                 <br><br>



                 <!-- FINAL NOTES STARTS HERE -->

                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"

                 HEIGHT="22" >

                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final

                 Notes</fonT>

                 </fonT></center></td></tr></table>

                 I wish windows could do this :)

                 <br><br>



                 <!-- OB DUH STARTS HERE -->

                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"

                 HEIGHT="22" >

                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob

                 Duh</fonT></fonT>

                 </center></td></tr></table>

                  <center>

                    <i>doesn't apply</i>

                 </center>



                 <!-- WAY OUT STARTS HERE -->

                 <hr>

                 <center><i>You are deep inside fravia's page of reverse engineering,  

                 choose your way out:</i></center>

                 <br><center>

                 <!-- EITHER A NICE GIF LIKE THIS -->



                 <!-- 

                 <a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" 

                 ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0

                 HSPACE=0></a>

                 <br>

                 <font color=gray>Back to project 3</FonT>

                 <br><bR>

                 -->



                 <!-- OR JUST A LINK LIKE THIS -->



                 <!--

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to

                 Your_chosen_project</A> 

                 <hr width=33%>

                 -->



                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>

                 <br>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality cracking</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how to search</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>

                 <br>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity academy</A> 

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A

                 HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>



                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

                 <br>

                 <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering

                 legal?</A>

                 </CENTER>

                 <hr>

                 <!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

                 </BODY>

                 </HTML>