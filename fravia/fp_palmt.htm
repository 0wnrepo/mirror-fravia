<HTML>

<HEAD>

<TITLE>Palmtops cracking (HP100/200lx)</TITLE>

</HEAD>

<BODY BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<CENTER><FONT size="+3">Palmtops cracking (HP100/200lx)</FONT>

<BR>(A -LATE- TUTORIAL FOR THE HP 100/200lx)

<H2>by <FONT color="#5500AA">Frog's Print</FONT></H2>

(10 December 1997, slightly edited by fravia+)</H4>

<!--<a href="protecti.htm" tppabs="http://www.anticrack.de/fravia/protecti.htm"><IMG SRC="tough.gif" tppabs="http://www.anticrack.de/fravia/tough.gif" ALT="our protections" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><Font color= gray>Our protections</fonT>-->

<HR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of fravia's page 

of reverse engineering<HR>       

<I>Well, Frog's Print brings us all in the palmtop realm, and demonstrates brilliantly how  relatively 

easy it is (once he has explained it :-) to crack software that is not even supposed to run on your PCs... nothing is impossible for the wizards of assembly and of DOS interrupt cracking!<BR>Therefore the most amusing (and amazing) teaching from this very nice essay is: WindowsCE (Gates' 

dream: porting his pathetically slow and overbloated operating system inside every domestic appliance) will be defeated (I mean, turned to our, not his, advantage) through simple assembly... QED (quod erat demonstrandum :-)

</I></CENTER><HR size="6">



<CENTER><B><FONT SIZE="+3">PALMTOPS CRACKING</FONT></B></CENTER>



<CENTER><B><FONT SIZE="+2">- A (LATE) TUTORIAL FOR THE HP 100/200lx -</FONT></B></CENTER>



<CENTER><FONT SIZE="+1">(ex: QuickStar Fax Pro V1.10 for HP)</FONT></CENTER>

&nbsp;



<P><TT>by Frog's Print -: )</TT>



<P><FONT SIZE="+1">You probably know (or at least have heard about) those

small computers that fit in the palm of your hand and in your pocket: Hewlett

Packard HP 95/100/200LX.</FONT>

<BR><FONT SIZE="+1">Though other companies (i.e. Psion...) have released

such products as well, we will only discuss here Hewlett Packard Palmtops

just because they are 100% DOS compatible (Psion are not).</FONT>



<P>

<HR ALIGN="LEFT" WIDTH="90%">

<BR><FONT SIZE="+1">So, first, a little bit of history:</FONT>

<BR><FONT SIZE="+1">In 1991, HP announced the 95lx (code name &quot;Jaguar&quot;).</FONT>

<BR><FONT SIZE="+1">LCD screen, MDA (Monochrome Display Adapter) displaying

16 rows x 40 columns (240 x 128 pixels), MS-DOS v3.22, with 512Kb or 1Mb

RAM, including a File Manager, Lotus (v2.2), a note editor, a diary, calculator....,

a PCMCIA slot for PC Cards (type I and II v1.0).</FONT>

<BR><FONT SIZE="+1">The product was great but soon, its specs got unadapted

to its users due to PC's evolution.</FONT>



<P><FONT SIZE="+1">During May 1993, they released the 100lx (code name &quot;Couguar&quot;).</FONT>

<BR><FONT SIZE="+1">It was the most amazing Palmtop ever created:</FONT>

<BR><FONT SIZE="+1">LCD screen, CGA (Color Graphic Adapter) displaying 25

rows x 80 columns (640 x 200 pixels), MS-DOS v5.0, 1Mb or 2Mb RAM, a ROM

full of miscellaneous apps, and utilities, including a File Manager closed

to Norton Commander, Lotus (v2.4), Lotus ccMAIL, word processor, database,

macro, IR communications, financial and programmer calculator, a PCMCIA

slot for PC Cards (type I and II v2.0) for RAM, Flash or Fax/Modem...or

any other kind of communications,</FONT>

<BR><FONT SIZE="+1">IR and serial ports, full printing capabilities...</FONT>



<P><FONT SIZE="+1">A year later (1994) came the 200lx.</FONT>

<BR><FONT SIZE="+1">It was similar to the 100lx except that the Graphic interface

was re-designed and looked far much better, the ROM was increased to 2Mb,

the RAM from 1 to 2 and, lately, to 4Mb and a version of Pocket Quicken

added.</FONT>



<P>

<HR ALIGN="LEFT" WIDTH="90%">

<BR><FONT SIZE="+1">The 100 and the 200lx were so succesful, that a huge

amount of hardware products (floppy drive, fax, printers, wireless communications

stuffs, GPS, BareCode, etc...) were created for them as well as an amazing

quantity of professional softwares (medical, electronic cicuit analysys,

radiation detection, Internet browsers...), newspapers (HP Palmtop Paper),

www-ftp sites and a nice forum on Compu$erve (HPHand).</FONT>



<P><FONT SIZE="+1">And, of course, a lot of succes (as well as the released,

at that time, of 80Mb PCMCIA flash memory cards!) means... a LOT of beautiful

<B>sharewares</B> with passwords, '.key' files, nagscreens... to feed our

cracker's appetite! At least mine, because I owned those 3 palmtops (and

still got my 200lx 4Mb baby) and spent nights and days to crack them using

<B>A86/D86</B> (from Eric Isaacson, latest version available at <A HREF="javascript:if(confirm('http://www.eji.com/a86/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.eji.com/a86/'" tppabs="http://www.eji.com/a86/">http://www.eji.com/a86</A>)

and <B>DIS86</B> (from James R. Van Zandt, latest version available via

FTPSearch ).</FONT>

<BR><FONT SIZE="+1">It was a real pleasure because, in the Palmtops world,

it's a place where you can meet some of the most amazing shareware (and

most of the time freeware) ASM and C programmers you'll ever see. I really

mean it!</FONT>



<P>

<HR ALIGN="LEFT" WIDTH="90%">

<BR><FONT SIZE="+1">A lot of people still own and use those Palmtops today

(I saw 2 weeks ago an engineer working with Lotus 123 on his 200LX&nbsp;

in the street )but, due to the apparition of Window$ CE, there shouldn't

be any more products or softwares developed for them using the good old

DOS 5.0.</FONT>

<BR><FONT SIZE="+1">Hewlett Packard released the HP 360, a 8 Mb RAM / 10

Mb ROM 60Mhz Windows CE based computer ( with all Micro$oft craps: Excel,

Words, Internet Explorer...) and announced and 16 Mb RAM, 16 colors new

serie 300 for 1998.</FONT>

<BR><FONT SIZE="+1">There are already a couple of Windows CE Internet sites,

and, of course, quite a lot of Sharewares available.</FONT>

<BR><FONT SIZE="+1">But right before we start to crack Windows CE (I will

soon take care of that..) let's see and study how the &quot;old&quot; HP100/200lx

works:</FONT>



<P><FONT SIZE="+1">On your PC, you boot, then can stay under DOS to run any

DOS .exe or .com files, or launch your graphic interface (Window$) by typing

&quot;WIN&quot; at the prompt and then, run programs adapted to (and only to) this

interface (Window$ crappy sharewares...). You can even open DOS shells

from it to run DOS softwares.</FONT>



<P><FONT SIZE="+1">The HP100/200lx works exactly the same:</FONT>

<BR><FONT SIZE="+1">It boots, loads Command.com. Then you can stay under

DOS or launch the graphic interface (called System Manager) by typing &quot;100&quot;

on the 100lx, or &quot;200&quot; on the 200lx (you can even type &quot;$ysmgr&quot; as well,

but you really must have time to waste to do so), and you can open a DOS

shell (only one at a time) while the System Manager is running.</FONT>



<P><FONT SIZE="+1">For this reason, there a 2 different kinds of executable

files that can run on the Palmtop:</FONT>



<P><FONT SIZE="+1">1/ DOS exe/com files:</FONT>

<BR><FONT SIZE="+1">They must run with DOS v5.00, and require a CGA video

board.</FONT>



<P><FONT SIZE="+1">2/ System Manager compliant applications:</FONT>

<BR><FONT SIZE="+1">These files have a .exm extension for &quot;EXecute in Memory&quot;

(there were few .xip - eXecute In Place - files as well for programs located

on PCMCIA cards :- ).</FONT>

<BR><FONT SIZE="+1">I will not write a lot about them, though it is very

interesting to program Exm files. When running, such files have access

to the same set of services that are used by the built-in applications.

This enables the program to share a non-preemptive multitasking environment

with the built-in applications so that the user can conveniently switch

between tasks.</FONT>

<BR><FONT SIZE="+1">They must be programmed in C and ASM only to create a

special .exe file that will be transformed, later, into a Exm. The most

important part is that Hewlett Packard developpers are really smart guys:

they provided independant programers with a lot of infos they needed (and

some tools) to help them to develop Exm programs. They gave a great support

(even much more than what they were supposed to) to anyone interested with

that. Just think about Micro$oft, which only support is to tell you that

if you're having problem with their programs, it is not because they have

bugs but because you may not be smart enough to use them well....</FONT>



<P><FONT SIZE="+1">There are no real reasons to crack Exm files because most

of them are commercial programs. 99% of sharewares are Exe or Com files.

The main reason is that a Exm file has a lot of limitations. For instance,

it doesn't accept command line arguments (like &quot;Myfile.exm Mydata.dat&quot;

or &quot;Myfile.exm /B -1&quot;). Another limitation is that you cannot highlight

one of them in the File Manager and launch it by pressing &lt;Enter&gt; because

they must be added to the Program Manager, then assiociated to an Icon.

It will be launched by clicking on this icon ( you could only crack it

using a Dead Listing approach). And, finally, the Program Manager has a

limitation about the total amount of Exm files it can handle.</FONT>



<P><FONT SIZE="+1">So, HP100/200lx sharewares are Exe/Com files that look

like ordinary Exe/Com files. You could think you could crack a program

written for the 100/200lx with SoftICE on your PC and then transfer it

back to your Palmtop. But you can't. They could ONLY run on the Palmtop

for the following reasons:</FONT>

<BR><FONT SIZE="+1">The Ms-Dos version has been enhanced to fit the Palmtop

specifications. Quite a lot of new interrupts and functions have been added

and/or modified. Here is a quick list of them:</FONT>

<BR><FONT SIZE="+1">(I added at the end of this essay a list of HP's interrupts)</FONT>



<P><B><FONT SIZE="+1">INT 15h:</FONT></B>

<BR><FONT SIZE="+1">Display control status, power off timeout, display contrast,

buzzer, serial interface, system time, installation check, power and battery,

announciators.</FONT>

<BR><B><FONT SIZE="+1">INT 16h (ah=10h/11h):</FONT></B>

<BR><FONT SIZE="+1">Special function/Menu keys.</FONT>

<BR><B><FONT SIZE="+1">INT 1Ah:</FONT></B>

<BR><FONT SIZE="+1">PCMCIA</FONT>

<BR><B><FONT SIZE="+1">INT 2Fh:</FONT></B>

<BR><FONT SIZE="+1">Key200 and Pushkeys installation check</FONT>

<BR><B><FONT SIZE="+1">INT 5Fh (Graphics Primitives):</FONT></B>

<BR><FONT SIZE="+1">Video mode, fill mask, graphic info, logical origin,

clip region, drawing line, rectangle..., move pen, set color, replacement

rules, line type, get pixel, get image, put image, write text, get/set

font pointer.....</FONT>

<BR><B><FONT SIZE="+1">INT 60h:</FONT></B>

<BR><FONT SIZE="+1">System Manager</FONT>

<BR><B><FONT SIZE="+1">INT 63h:</FONT></B>

<BR><FONT SIZE="+1">Memory map...</FONT>



<P><FONT SIZE="+1">A program written for the HP100/200lx will extensively

use, at least, the functions of the INT 5Fh (graphics primitives) to set

the video mode, write text and to draw its interface.</FONT>

<BR><FONT SIZE="+1">That why it will not run on a PC as DOS doesn't recognise

this INT 5Fh (as well as all others above mentioned interrupts or functions).</FONT>



<P><FONT SIZE="+1">Here is now, how works a Exe/Com program for the Palmtop

100/200lx:</FONT>



<P><TT>Check_If_HP100_200&nbsp;&nbsp; : mov ax,&nbsp;&nbsp;&nbsp; 4DD4h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Are we running</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; on a HP palmtop?</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp bx,&nbsp;&nbsp;&nbsp; 4850h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; 0x4850='HP'.</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; No, Exit.&nbsp;</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp cx,&nbsp;&nbsp;&nbsp; 0102h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Is it a HP95lx or 100/200lx?</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; No, it is a 95lx, so Exit otherwise.</FONT></TT>

<BR><TT>Initialize_HP_Graph&nbsp; : mov ax,&nbsp;&nbsp;&nbsp; 0006h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Set HP graph mode</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5Fh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; to 640x200 CGA.</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ax,&nbsp;&nbsp;&nbsp; 0A08h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Set replacement rule</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5Fh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; to 'Text'.</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov ah,&nbsp;&nbsp;&nbsp; 09h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Set pen color</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov al,&nbsp;&nbsp;&nbsp; 01h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; to black.</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5Fh</TT>

<BR><TT>My_nice_Program&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : ...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Put your stuff here.</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

...</TT>

<BR><TT>Restore&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

: mov ax,&nbsp;&nbsp;&nbsp; 0003h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Restore HP DOS</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5Fh...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; text mode.</FONT></TT>

<BR><TT>Exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

: mov ah,&nbsp;&nbsp;&nbsp; 4Ch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Have a nice day.</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21h</TT>



<P><FONT SIZE="+1">The graph mode and replacement rule could be set differently

as there are different options available but these ones are the most usual.</FONT>



<P>

<HR ALIGN="LEFT" WIDTH="90%">



<P><FONT SIZE="+1">Now, let's crack!</FONT>

<BR><FONT SIZE="+1">Of course, it is not possible to use SoftICE or any other

similar debuggers/tracers like TR196 on a Palmtop (except Borland Turbo

Debugger).</FONT>

<BR><FONT SIZE="+1">And I said above that you are not supposed to be able

to run a Exe/Com file written for the HP100/200lx on your PC in order to

crack it with SoftICE.</FONT>

<BR><FONT SIZE="+1">But this is <U>pure theory</U>, not reality...</FONT>

<BR><FONT SIZE="+1">I will show you how to do it anyway, even on your new

P266MMX with SoftICE 3.22.</FONT>



<P><FONT SIZE="+1">For this, we will crack <B>QuickStar FAX Pro V1.10 HP</B>

written by Anthony &quot;<I>I am a proud member of the Association of Shareware

Professionals</I>&quot; Mai. It is available at <A HREF="javascript:if(confirm('http://www.qfax.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.qfax.com/'" tppabs="http://www.qfax.com/">http://www.qfax.com</A>.</FONT>

<BR><FONT SIZE="+1">This is a good, fast program for sending, receiving and

viewing faxes on a HP100/200 lx.</FONT>



<P><FONT SIZE="+1">Run it on your Palmtop (or just assume you get one -:

) and analyse it. The program's graphic interface (CGA 640x200) is definitely

designed for, and only for, the HP100/200lx. It looks something like this:</FONT>

<BR>&nbsp;

<BR>&nbsp;

<TABLE BORDER COLS="1" WIDTH="94%">

<TR>

<TD><TT><B>Filename</B>: FILE_ID.DIZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<B>FaxNumber:_____________</B></TT></TD>

</TR>



<TR>

<TD><TT>C:\FAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<B>SubDir:</B></TT></TD>

</TR>



<TR>

<TD><TT><B>FILE_ID.DIZ</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|..</TT>&nbsp;

<BR><TT>QFREC.EXE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|[-A-]</TT>&nbsp;

<BR><TT>QFAX.EXE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|[-B-]</TT>&nbsp;

<BR><TT>QFAX.CFG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|[-C-]</TT>&nbsp;

<BR><TT>....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|[-D-]</TT>&nbsp;

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|[-E-]</TT>&nbsp;

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|</TT>&nbsp;

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

|</TT></TD>

</TR>



<TR>

<TD><TT><B>FType</B>: TXT - FAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <B>CFont</B>:

16 - 24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <B>Pause</B>: Yes

- No&nbsp;&nbsp;&nbsp;&nbsp; <B>Send</B>&nbsp;&nbsp;&nbsp;&nbsp; <B>Quit</B></TT></TD>

</TR>

</TABLE>

<TT>&nbsp;</TT>

<BR><FONT SIZE="+1">The program picks up the first file (here, File_id.diz)

in your current directory (C:\Fax).</FONT>

<BR><FONT SIZE="+1">You can select another one with the UP and Down arrow

keys. By pressing &lt;Tab&gt; or &lt;Enter&gt;, the cursor is moved to &quot;FaxNumber&quot;

where you have to type the fax number. Pressing &lt;Tab&gt; or &lt;Enter&gt;

again, will move the cursor to &quot;FType&quot; (TXT or FAX), then to &quot;CFont&quot; (choose

fonts), then to &quot;Pause&quot; (prompt before sending) and then to &quot;Send&quot;. Pressing

the &lt;Enter&gt; key will leave the graphic interface and return to the Dos

text mode. Then, you'll get the following message:</FONT>



<P><TT><FONT COLOR="#000099">&nbsp;&nbsp;&nbsp; The unique serial Number

of this software is:</FONT></TT>

<BR><TT><FONT COLOR="#000099">&nbsp;&nbsp;&nbsp; R.3001369</FONT></TT>

<BR><TT><FONT COLOR="#000099">&nbsp;&nbsp;&nbsp; What's your registration

license number?_</FONT></TT>



<P><FONT SIZE="+1">You have to type your license number + &lt;Enter&gt; to send

your fax. If it is wrong, the program will ask you to press a specific

key (at random) before processing.</FONT>

<BR><FONT SIZE="+1">&nbsp;</FONT>

<BR><FONT SIZE="+1">&nbsp;Transfer Qfaxe.exe on your PC and run it. You'll

see:</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">This program only runs

on a HP palmtop computer</FONT></TT>

<BR><TT><FONT COLOR="#000099">&nbsp;&nbsp;&nbsp; Ask the author for a parallel

version for regular PCs</FONT></TT>

<BR>&nbsp;



<P><FONT SIZE="+1">Usually, as described above, to check if a program is

running on a HP palmtop you must call Int 15h function 4DD4h. The return

values are:</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; bx=4850h if it is a HP Palmtop (0x48=&quot;H&quot; &amp;

0x50=&quot;P&quot;)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; cx=model (0101h=HP95lx &amp; 0102h=HP100/200lx)</TT>



<P><FONT SIZE="+1">Other values returned (dh, dl) concern the Bios and language

versions.</FONT>



<P><FONT SIZE="+1">Just put a BPINT on Int 15h:</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; :BPINT 15 IF ax==0x4DD4</TT>



<P><FONT SIZE="+1">(note: SoftICE will break on Int 15h but will NOT on other

HP's special interrupts (i.e. int 5Fh...) -: ).</FONT>



<P><FONT SIZE="+1">Run again QFax and ...you'll get nothing!</FONT>

<BR><FONT SIZE="+1">So, how the hell does it know it is not running on a

HP?</FONT>



<P><FONT SIZE="+1">To find out what is going on, with SoftICE put a BPINT

on Int21/ah=4Ch (exit program interrupt) and, in the meantime check the

stack:</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; :BPINT 21 If AH==4C DO &quot;Stack&quot;</TT>



<P><FONT SIZE="+1">Run again QFax and you'll get:</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; xxxx:5A5F&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp;

ax, [bp+arg_0]</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:5A62&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp;

ah, 4Ch</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:5A64&nbsp;&nbsp;&nbsp; int&nbsp;&nbsp;&nbsp;&nbsp;

21h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Quit with exit code</FONT></TT>



<P><TT>&nbsp;&nbsp;&nbsp; :Stack</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Owner Is QFAX at xxxx:11E1 [?]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#000099">&nbsp;

; &lt;= the caller</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; =&gt;Owner Is QFAX at xxxx:5A64 [?]</TT>

<BR><TT>&nbsp;</TT>

<BR><FONT SIZE="+1">Check at xxxx:11E1 to see why the program doesn't want

to run:</FONT><TT>&nbsp;</TT>

<BR><TT>&nbsp;</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; :U 11E1</TT>



<P><TT>&nbsp;&nbsp;&nbsp; xxxx:11B7&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

ax, 1000h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">; ???</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11BA&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;

bx, bx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

???</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11BC&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;

dx, dx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

???</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11BE&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

cx, 0A0Bh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">; ???</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11C1&nbsp;&nbsp;&nbsp; int&nbsp;&nbsp;&nbsp;

5Fh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; ???</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11C3&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;

[5528],ax</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11C6&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;

w,[5528],008</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11CB&nbsp;&nbsp;&nbsp; jz&nbsp;&nbsp;&nbsp;&nbsp;

11E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Jmp to Good_Guy...</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; ...</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:11E1&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;

59dc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Otherwise, exit.</FONT></TT>

<BR><TT>&nbsp;</TT>

<BR><FONT SIZE="+1">This is what I call &quot;another_nice_stupid_little_trick_from_a_hopeless_protectionist&quot;.</FONT>

<BR><FONT SIZE="+1">We can see just above our JZ a call to Int 5Fh with:</FONT>

<BR><TT>&nbsp;&nbsp;&nbsp; ax=1000h</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; bx=0</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; cx=0A0Bh</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; dx=0</TT>

<BR><FONT SIZE="+1">&nbsp;</FONT>

<BR><FONT SIZE="+1">Function 10h of Int 5Fh is used to get the Palmtop font

pointer:</FONT>

<BR><TT>&nbsp;&nbsp;&nbsp; Int 5Fh</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; ah = 10h</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; cx = font size</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

0808h&nbsp; 8x8&nbsp; small&nbsp; (80x25 text)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

0A0Bh 11x10 medium (64x18 text)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

100Ch 12x16 large&nbsp; (40x16 text)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

dx:ax -&gt; pointer to font or 0000h:fontID# if built-in font</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (ax=4

for small fonts, 2 for large fonts and 8 for medium fonts)</TT>



<P><FONT SIZE="+1">The program stores AX value in [5528] and just compares

it to what it was expecting to get: 8.</FONT>

<BR><FONT SIZE="+1">If it is different, it is not a HP palmtop.</FONT>



<P><FONT SIZE="+1">Get rid of the JZ and make it JMP for ever.</FONT>



<P><FONT SIZE="+1">It is clear that the call to Get_Font_Pointer is only

used here as a protection trick, because after a call to this function,

you MUST call immediately the Set_Current_Font function (ah=11h) otherwise

it is absolutely useless and will never work (see list of Int at the bottom

of this essay -: ). Note as well, that the program doesn't check if it

is running on a HP95lx. This means that if you ran it on a 95lx, the program

would tell you that it is not a HP Palmtop, though is is!</FONT>



<P><FONT SIZE="+1">What's going to happen now if we run the program on our

PC? Will it crash?</FONT>

<BR><FONT SIZE="+1">No, it won't. In fact you'll get <U>a blank screen</U>

as your computer will not recognise HP graphics interrupts but it will

still work because the Palmtop needs Int 16h functions 00h/01h/02h for

its keyboard like any other PC (except for one special key: the &quot;Menu&quot;

key (ASCII code #200) , used to display pull down menus -function 10h- but

we do not need it here.).</FONT>



<P><FONT SIZE="+1">We know that when we run QFax it will first pick up the

first file in your current directory, so just press &lt;ENTER&gt; and you

should reach the Fax Number input field. Type any number and then, press

4 times the &lt;ENTER&gt; or &lt;TAB&gt; key. Though you still don't see anything

on your screen, your cursor should be positioned on &quot;Send&quot;. If you pressed

&lt;ENTER&gt;, the program would get back to the DOS text mode and this part

<U>would be displayed on your screen</U>!</FONT>

<BR><FONT SIZE="+1">But before, as we know that it will wait for us to type

in our serial number, with SoftIce put another BPINT on Int 21h function

0Ah (return the buffer filled with user input including CR):</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; BPINT 21 IF ah==0x0A</TT>



<P><FONT SIZE="+1">And press &lt;ENTER&gt; (&quot;Send&quot;). SoftICE breaks. Press &lt;F11&gt;

and you'll see the message asking for your password. Type anything you

want and press &lt;ENTER&gt;. S-Ice pops here:</FONT>



<P><TT>&nbsp;&nbsp;&nbsp; xxxx:A32855&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

mov&nbsp;&nbsp;&nbsp; [05528],ax&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

Store our password</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:4E92: FF362655&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

push&nbsp;&nbsp; w,[05526]</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:4E96: E8370B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

call&nbsp;&nbsp; 59D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Calculate correct_password</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:4E99: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pop&nbsp;&nbsp;&nbsp; bx</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxx4x:E9A: 3B062855&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

cmp&nbsp;&nbsp;&nbsp; ax,[05528]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#000099">;

Compare both</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:4E9E: 7525&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

jne&nbsp;&nbsp;&nbsp; 4EC5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<FONT COLOR="#000099">; Bad_Guy jump</FONT></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; xxxx:4EA0: C70680550100&nbsp; mov&nbsp;&nbsp;&nbsp;

w,[05580],0001 <FONT COLOR="#000099">; Good_Guy flag.</FONT></TT>



<P><FONT SIZE="+1">No explanations needed.... except the fact that the program

stores our password into [5528] which is the memory location where it has

previously stored the return value of AX for the Get_Font_Pointer routine

we cracked above.</FONT>

<BR><FONT SIZE="+1">If you crack this part, the program will automatically

create a REG.DAT file with the following line:</FONT>



<P><TT>&nbsp;&nbsp; <FONT COLOR="#000099">License Number: xxxx This program

is registered.</FONT></TT>



<P><FONT SIZE="+1">And now you can use a registered soft to send beautiful

faxes with a 200g / 7oz computer from anywhere in the World.</FONT>

<BR><FONT SIZE="+1">&nbsp;</FONT>

<BR><FONT SIZE="+1">&nbsp;</FONT>

<BR><FONT SIZE="+1">&nbsp;</FONT>

<BR>

<HR ALIGN="LEFT" WIDTH="90%">

<HR ALIGN="LEFT" WIDTH="90%">



<P><FONT SIZE="+1">&nbsp;Here is now a list of the HP Palmtop's interrupts

that will give return codes that could be used to check it the program

is running on a 100/200lx or not:</FONT>



<P><B><FONT SIZE="+1">INT 15h</FONT></B>



<P><TT>&nbsp;&nbsp;&nbsp; AH = 47h&nbsp; <B><I>GET/SET DISPLAY CONTRAST</I></B></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; AL = subfunction</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00h set contrast</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; BL = new contrast (00h-0Fh, 0Fh is darkest,

10h-FFh are same as 0Fh)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; other get current

contrast</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: AL = contrast (00h-0Fh, 0Fh is darkest)</TT>

<BR>&nbsp;



<P><TT>&nbsp;&nbsp;&nbsp; AX = 4DD4h&nbsp; <B><I>INSTALLATION CHECK</I></B></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: BX = 4850h (&quot;HP&quot;) if HP 95LX/100LX/200LX</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

CX = model</TT>&nbsp;<TT>&nbsp; (0101h HP 95LX</TT>&nbsp; - <TT>0102h HP

100LX/200LX</TT> )

<BR><TT>&nbsp;</TT>



<P><TT>&nbsp;&nbsp;&nbsp; AX = 6000h&nbsp; <B><I>GET MAIN BATTERY LEVEL</I></B></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: AX = battery level</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

(multiply the returned value with 1Bh and add 622h to get millivolts)</TT>

<BR>&nbsp;



<P><TT>&nbsp;&nbsp;&nbsp; AX = 6001h&nbsp; <B><I>GET BACKUP BATTERY LEVEL</I></B></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: AX = battery level</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

(multiply the returned value with 1Bh and add 622h to get millivolts)</TT>

<BR>&nbsp;



<P><TT>&nbsp;&nbsp;&nbsp; AX = 6002h&nbsp; <B><I>GET POWER INFO</I></B></TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: AL = power settings (see below)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Bitfields for power settings:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Bit(s)&nbsp; Description</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

0-1&nbsp;&nbsp;&nbsp; unused ???</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; card battery status low (OK if bit clear)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; battery charging off (disabled if bits

3-5 clear)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; battery charging slow</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; battery charging fast</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; power adaptor active</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; battery type NiCad (alkaline if bit clear)</TT>

<BR>&nbsp;



<P><B><FONT SIZE="+1">INT 2Fh</FONT></B>

<BR><TT>&nbsp;</TT>



<P><TT>&nbsp;&nbsp;&nbsp; AX = C0AFh</TT>&nbsp;&nbsp; <B><I><TT>PUSHKEYS

- INTERNAL - GET BUFFER ADDRESS</TT></I></B>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: ES:DI -&gt; buffer (behind code)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Range:&nbsp; AH=C0h to AH=FFh, selected by scanning

for signature with AL=AEh</TT>

<BR><TT>&nbsp;</TT>

<BR>&nbsp;

<BR><TT>&nbsp;</TT>

<BR><B><FONT SIZE="+1">INT 5Fh</FONT></B>

<BR><TT>GRAPHICS PRIMITIVES</TT>



<P><TT>&nbsp;&nbsp;&nbsp; AH = 02h</TT>&nbsp;&nbsp; <B><I><TT>GET CURRENT

GRAPHICS INFO</TT></I></B>

<BR><TT>&nbsp;&nbsp;&nbsp; ES:DI -&gt; graphics info record</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: DX:AX -&gt; filled graphics info record

(for return to high-level langs)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Format of HP Palmtops graphics info record:</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Offset&nbsp; Size&nbsp;&nbsp;&nbsp; Description</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

00h&nbsp;&nbsp;&nbsp; BYTE&nbsp;&nbsp;&nbsp; current video mode</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

01h&nbsp;&nbsp;&nbsp; BYTE&nbsp;&nbsp;&nbsp; default video mode</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

02h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; display width in pixels</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

04h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; display height in pixels</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

06h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current pen column</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

08h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current pen row</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

0Ah&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current line type</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

0Ch&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current replacement rule</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

0Eh&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current pen color</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

10h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current leftmost column of

clip region</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

12h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current rightmost column of

clip region</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

14h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current topmost row of clip

region</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

16h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current bottommost row of

clip region</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

18h&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current column of logical

origin</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

1Ah&nbsp;&nbsp;&nbsp; WORD&nbsp;&nbsp;&nbsp; current row of logical origin</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

1Ch&nbsp; 8 BYTEs&nbsp;&nbsp; current fill mask</TT>

<BR>&nbsp;

<BR>&nbsp;



<P><TT>&nbsp;&nbsp;&nbsp; AH = 0Ch</TT>&nbsp;&nbsp;&nbsp; <B><I><TT>GET

PIXEL</TT></I></B>

<BR><TT>&nbsp;&nbsp;&nbsp; DX,CX = row,column of pixel to read</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: AX = pixel color</TT>



<P><TT>&nbsp;</TT>



<P><TT>&nbsp;&nbsp;&nbsp; AH = 10h</TT>&nbsp;&nbsp;&nbsp; <B><I><TT>GET

FONT POINTER</TT></I></B>

<BR><TT>&nbsp;&nbsp;&nbsp; CX = font size of desired font</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0808h&nbsp; 8x8&nbsp;

small&nbsp; (80x25 text)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0A0Bh 11x10 medium

(64x18 text)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 100Ch 12x16 large&nbsp;

(40x16 text)</TT>

<BR><TT>&nbsp;&nbsp;&nbsp; Return: DX:AX -&gt; ptr to font or 0000h:fontID#

if built-in font</TT>



<P><TT>&nbsp;</TT>



<P><TT>&nbsp;&nbsp;&nbsp; AH = 11h</TT>&nbsp;&nbsp;&nbsp; <B><I><TT>SET

CURRENT FONT</TT></I></B>

<BR><TT>&nbsp;&nbsp;&nbsp; ES:DI -&gt; ptr to font or 0000h:fontID# for built-in

font</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

(this function should be called immediately after AH=10h with the</TT>

<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

pointer supplied by that call</TT> )

<BR><TT>&nbsp;</TT>

<BR><TT>&nbsp;</TT>&nbsp;

<HR ALIGN="LEFT" WIDTH="90%">

<HR ALIGN="LEFT" WIDTH="90%">

<BR><FONT SIZE="+1">Hope this will help the HP100/200lx nostalgic users...</FONT>



<P>Frog's Print&nbsp; December 1997

</PRE>

<FONT color="green">(c) <FONT color="#5500AA">FootSteps </FONT> All rights reversed</FONT>

<HR ALIGN="CENTER" WIDTH="100%" SIZE="3">

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>

<!--<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="protecti.htm" tppabs="http://www.anticrack.de/fravia/protecti.htm">Our Protections</A>            <hr width=33%>-->



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A><BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia</A><BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering legal?</A></CENTER>

<CENTER><HR ALIGN="CENTER" WIDTH="100%" SIZE="2"></CENTER>

</BODY>

</HTML>







