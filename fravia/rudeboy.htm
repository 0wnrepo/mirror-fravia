<HTML>

<HEAD>

<!--  formamus.htm version 02 February 1998 

      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

      SEARCH THIS TEXT FOR THE STRING "Your_" 

      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

      THANKS A LOT: this will allow automated retrieval -->

<TITLE>rudeboy.htm Thinking Like a Cracker</TITLE>

</HEAD>



<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%  HEIGHT=" 22">

<TR><td></td>

<td>

<!-- Choose  a TITLE probably wont be changed -->

<center><FONT SIZE="+2">Thinking Like a Cracker</fonT><br>

        <FONT SIZE="+1">A Lesson For Beginners</fonT>

</center>

</td>



<td>

<!-- Choose  a PROJECT GIF, leave this if unsure -->

<center><a href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif" ALT="student" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></a>

<br>

<font color=gray>Not Assigned</FonT>

</center></td></tr>

<tR>

<td bgcolor="#FFFFEA"><center>

<FONT COLOR="890000">

<!-- CHOOSE A DATE (will probably be changed) -->

15 March 1998

</FONT></center>

</td>

<td bgcolor="#FFFFEA"><center>by <font size=+1>

<!-- CHOOSE A HANDLE (wont be changed) -->

The _RudeBoy_ [PC]

</fonT></center>

</td>

<td VALIGN="center" bgcolor="#FFFFEA">

<!--

<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 

WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

-->

</td>

</tr>

<TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" 

BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>

<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 

reverse engineering</center> 

</center></TD>

<td BGCOLOR="898030">

<center>

<!-- Your truly+ will edit only if really necessary -->

slightly edited<br>

by fravia+</center></td>

</TR>

<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->

<tr><td><font color="#C4C0CF">fra_00F5<bR>980314<br>tudeboy<br>1000<br>NA<br>xx<br></fonT></td><td><i><center>

<!-- Your truly+ comments -->

An important essay: RudeBoy underlines a VERY IMPORTANT truth: targets are made by programmers 

(of course) and programmers use a STANDARD approach. Cracking and reversing should 

always TAKE ACCOUNT of this. A simple truth that you better learn, understand and use. 

</i></center></td>

<td></td>

</tr>

<TR><td></td>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 

That's how the light gets in</b></center>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

</center></TD><td></td>

</TR>

<TR>

<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

Rating</FONT></FONT></center>

</TD>

<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

<!-- CHOOSE A RATING (may be changed) -->

(x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>

</center></td>

<td></td>

</tr>

</table>

<!-- END HEAD  -->

<bR>

<!-- CORPUS  -->



<!-- CHOOSE A COMMENT (may be changed)  -->



<hR>

<center>

   <FONT SIZE="+2">

<!-- CHOOSE A TITLE (wont probably be changed) -->

Thinking Like a Cracker

   </FONT><BR>

   <FONT SIZE="+2">

<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->

A lesson for beginners

   </FONT><BR>

   <FONT COLOR="0B7FC1">

<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 

The _RudeBoy_ [PC]

   </FONT>

</center><br><br>



<!-- INTRO STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>

</fonT></center></td></tr></table>

<pre>

<!-- PASTE HERE YOUR INTRODUCTION -->

	This essay is aimed towards beginning crackers, and helping them to think like a

cracker.  I can't count how many times I have been asked by a beginning cracker about why

they can patch a program so that it says that it's been registered, but then when they 

restart the application it no longer says that it's registered.  The solution is usually

quite simple, but requires you to "think like a cracker".

</prE>

<br><br>



<!-- TOOLS STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>

</fonT></center></td></tr></table>

W32Dasm 8.9 (or whatever version you prefer)<br>  <!-- PASTE HERE YOUR REQUIRED TOOLS -->

Hex Workshop (or your favorite hex editor)<br>

PolyView 3.00 beta 9

<br><br>



<!-- TARGET URL STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>

</fonT></center></td></tr></table>

<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->

<a href="javascript:if(confirm('http://www.polybytes.com/betafiles/pvbeta.exe  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.polybytes.com/betafiles/pvbeta.exe'" tppabs="http://www.polybytes.com/betafiles/pvbeta.exe">http://www.polybytes.com/betafiles/pvbeta.exe</a>

<br><br>



<!-- PROGRAM HISTORY STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>

</fonT></center></td></tr></table>

<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->

<br><br>



<!-- REAL ESSAY  STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>

</center></td></tr></table>

<!-- PASTE HERE THE TEXT OF YOUR ESSAY

     THIS IS OF COURSE THE MOST IMPORTANT PART

     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 

     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE

     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->

<pre>

Before we get started with cracking our target, PolyView 3.00 beta 9, we need

a lesson in thinking like a cracker/programmer.  Programmers are taught that 

whenever you have a task that is going to be done more that once, you should

create a function to do that task, and just call the function when you need to 

perform the task.  Now, most programs that use a name/serial # combination 

check the code at least twice, once when you enter the code, and once when the

program starts up.  Because of this the programmer will usually call a function

to test your reg code.  And usually, this function will be called every time the

code is checked.  At this point you should probably see where I am going with

this.  If you patch the function that is called to test the reg code, it will 

show up as valid whenever the program does it's check.



Now, for an example of this technique, on to PolyView 3.00 beta 9.



When you run the program you should notice on the menubar the "Registration" section,

and under that, "License Information".  It has a place to enter a name and a license

code.  Enter whatever you like for these values and press "OK".  If you have not

entered an integer into the license code box, you will receive an error saying "Please

enter a positive integer", otherwise you will receive the error "Registration Unsuccessful".



Fire up W32Dasm, and load PolyView.exe.  When this is done go to the string references

and look for "Registration Unsuccessful".  When you find it in the list, notice that

just above it is the string "Registration successful", and then double click on 

"Registration Unsuccessful".  You should see this section of code:



* Referenced by a  Jump at Address:004400C9(C)

|

* Possible Reference to String Resource ID=00141: "Unregistered"

                                  |

:0044016C 688D000000              push 0000008D

:00440171 8BCF                    mov ecx, edi

:00440173 E8D9070600              call 004A0951

:00440178 53                      push ebx

:00440179 53                      push ebx



* Possible StringData Ref from Data Obj ->"Registration unsuccessful. please "

                                        ->"verify that you have entered the "

                                        ->"information exactly as shown on "

                                        ->"your registration letter."

                                  |

:0044017A 684C364F00              push 004F364C

:0044017F 899E70010000            mov dword ptr [esi+00000170], ebx

:00440185 E8D88A0600              call 004A8C62



You should notice first that this section of code was referenced by a

conditional jump at 004400C9. Scroll up in w32dasm until you get 

to that location, you should see this code:



:004400B7 50                      push eax

:004400B8 51                      push ecx

:004400B9 898670010000            mov dword ptr [esi+00000170], eax

:004400BF E8DCF0FEFF              call 0042F1A0    ;IsValidCode()

:004400C4 83C408                  add esp, 00000008

:004400C7 85C0                    test eax, eax    ;The infamous test

:004400C9 0F849D000000            je 0044016C      ;je Bad_Guy



Here is where we apply what we learned earlier.  If you were to simply

NOP out the je 044016C the program would say that it is registered when

you enter in your code.  However, When you restart the program, it would

still say "Unregistered".  Remember what I said about programmers writing

one function, and calling it many times to see if the code is valid?  That

is what this author has done, the call to 0042F1A0 is the program calling

that function.  In w32dasm, goto code location 0042F1A0, and you will see

this:



* Referenced by a CALL at Addresses:

|:0040423B   , :004046B8   , :004055FA   , :0042DDBE   , :0042DE36   

|:004395C4   , :0043CE1A   , :0043D6B0   , :0043E35A   , :00440025   

|:004400BF   , :004419BC   , :0044234D   , :00452FF9   , :004531CB   

|:004B9033   

|

:0042F1A0 64A100000000            mov eax, dword ptr fs:[00000000]



Every one of those addresses is a place where this program calls the 

IsValidCode() routine to see if the program is registered.  Now, the 

question remains.how do you patch this program so that it is 

registered.  Look again to the section of code that calls the 

IsValidCode() routine, specifically at the jump to Bad_Guy.  It will 

jump if eax = 0.  So, the easiest way to patch this program is to write 

over the mov eax, dword ptr fs:[00000000] in the called function with:



push   00000001

pop    eax

ret



(In hex that would be 6A0158C3)



The function now always returns 1 in eax, and the program thinks that 

it has been registered.



</prE>

<br><br>



<!-- FINAL NOTES STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>

</fonT></center></td></tr></table>

<pre>

The techniques employed here do not only apply to cracking programs with

name/reg code routines.  Do not limit yourself by thinking "Inside the Box",

these techniques can be used with many other types of protections as well.

(for example, many times a date check and a nag screen are done by

one function)

</pre>

<br><br>



<!-- OB DUH STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>

</center></td></tr></table>

 <center>

   <i>I wont even bother explaining you 

   that you should BUY this target program if you intend to use it for a longer 

   period than the allowed one. Should you want 

   to STEAL this software instead, you don't need to crack its protection 

   scheme at all: you'll 

   find it on most Warez sites, complete and already regged, farewell.</i>

</center>



<!-- WAY OUT STARTS HERE -->

<hr>

<center><i>You are deep inside fravia's page of reverse engineering,  

choose your way out:</i></center>

<br><center>

<!-- EITHER A NICE GIF LIKE THIS -->



<a href="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm"><IMG SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif" 

ALT="student" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 

VSPACE=0 HSPACE=0></a>

<br>

<font color=gray>Back to the student essays</FonT>

<br><bR>





<!-- OR JUST A LINK LIKE THIS -->



<!--

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to Your_chosen_project</A> 

<hr width=33%>

-->



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality cracking</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how to search</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity academy</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering legal?</A>

</CENTER>

<hr>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML>