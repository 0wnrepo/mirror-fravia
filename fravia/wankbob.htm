<HTML>
<HEAD>
<TITLE>Acme.htm FlexLM - Alternative Method for License Generation</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%  HEIGHT="22">
<TR><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><FONT SIZE="+2">FlexLm - Alternative License Generation</fonT><br>
        <FONT SIZE="+1">Using FlexLM Internal Diagnostics to reveal ALL</fonT>
</center>
</td>
<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG
SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif" 
ALT="student"
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>
<br>
<font color=gray>Not Assigned</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
July 1999
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->
Acme
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif"
ALT="+cracker" ALIGN=BOTTOM
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td>
</tr>
<TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG
SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM"
BORDER="0" VSPACE="0" HSPACE="0"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Fravia's page
of
reverse engineering</center>
</center></TD>
<td BGCOLOR="898030">
<center>
<!-- Your truly+ will edit only if really necessary
-->
slightly edited<br>
by fravia+</center></td>
</TR>
<!-- this is for the
data.....fra_00xx....yymmdd....handle..beg+int...not 
ass... -->
<tr><td><font 
color="#C4C0CF">fra_00xx<bR>980704<br>Acme<br>1100<br>NA<br>PC<br></fonT></td><td>
<font color=blue>"FLEXlm is the most popular license manager used in the software industry.
FLEXlm is best known for its ability to allow software licenses to be available (or float)
anywhere on a network, instead of being tied to specific machines. Floating licensing benefits
both users and license administrators. Users can make more efficient use of fewer licenses by
sharing them on the network. License administrators can control who uses the licensed
application, and the node(s) where the licenses will be available."</fonT>
<hr width=44%><center>
<i>Words, as usual, just words. "Commercial" protection schemes are inehrently weak, and 
my advice to all software developers perusing my site is to STEER CLEAR from them.<br>The reason there 
are so many FlexLM cracks allover the web (since 1997) will be apparent to anyone reading this essay.
</i><hr width=44%></center>
<font color=blue>
"Let me just say how can FLEXLM be so stupid as to
generate a key and then 
COMPARE it
and leaving such a large amount of room for the casual
programmer to extend 
the working operation of their own program."</fonT><br><center><i>Indeed I believe that the 
programmers at FlexLM should take due note of the weaknesses we are pointing out and modify accordingly their 
protection scheme. See: the problem is that the inehrent weakness of FlexLM is responsable 
for the hundred thousands of existing cracks and keygenerators for all software "protected" through this 
"most popular license manager used in the software industry".<bR>The point is that FlexLM claim to 
"reduce software piracy" does not held for the reasons discussed in this, and other papers.
<bR>Software programmers should KLEEP CLEAR from using 
such a weak protection scheme for their products, and, together with the programmers 
at FlexLM, should have a thorough look at our <a href="protec.htm" tppabs="http://www.anticrack.de/fravia/protec.htm">how to protect better</a> 
section in order to build a more robust protection.

</i></center></td>
<td></td>
</tr>
<TR><td></td>
<!-- Leonard Coehn's old song, because we are poets,
not only crackers -->
<TD BGCOLOR="898030"><center></i><b>There is a crack,
a crack in everything
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets,
not only crackers -->
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font
color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font
color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
( )<B>Beginner</B> (x)<B>Intermediate</B> (
)<B>Advanced</B> ( 
)<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<bR>
<!-- CORPUS  -->


An essay on the simplicity of using inbuilt Diagnostic
functions inside 
Flexlm to reveal
information normally kept hidden. Many previous
methods offered by Pilgrim (<a href="flexm11.htm" tppabs="http://www.anticrack.de/fravia/flexm11.htm">flexm11.htm</a>: <i>FlexLm 
handy hints</i> (more stuff on FlexLm) and  <a href="pflexlo1.htm" tppabs="http://www.anticrack.de/fravia/pflexlo1.htm">pflexlo1.htm</a>: <i>FlexLock...less secure than the rest of FLEXlm</i>) 
 and <a href="siulflex.htm" tppabs="http://www.anticrack.de/fravia/siulflex.htm">SiuL+Hacky</a> (Linux advanced cracking: flexlm Advanced)  utilised
the SDK from globetrotters (Flexlm Programmers). This
essay utilises the 
inbuilt generation of ACCESS keys
in the lmgr325c.dll to supply codes for any type of
license and uses the 
diagnostics function to deliver
the information to the user.<br>
<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
FlexLM - Alternative Method for License Generation
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
Using FlexLM Internal Diagnostics to reveal ALL
   </FONT><BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by
Acme
   </FONT>
</center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" 
 >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font 
color=blue>Introduction</fonT>
</fonT></center></td></tr></table>

Previous essays on Flexlm required the use of the SDK
to generate licenses.
Since i couldn't be bothered downloading 7MB files I
originally investigated 
the information
at hand which involved the executable and the standard
lmgr325c.dll. 
<BR><BR>

SIDE NOTE : If anyone has a program similiar in nature
to w32dasm that 
allows loading of a dll without
decompiling the main executable... could you please leave a
message at fravia's? 
Decompiling a 5-10MB executable
is a real pain.

<br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" 
 >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Tools 
required</fonT>
</fonT></center></td></tr></table>
W32dasm, Hex editor, ASM Knowledge (Who doesn't)
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" 
 >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Target's 
URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
No target just our dear old FlexLM
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" 
 >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font 
color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<pre>
Anyway lets get to it

<b>BACKGROUND INFORMATION</b>

Examination of the lmgr325c.dll string references
shows an interesting 
String
"FLEXLM_DIAGNOSTICS". This is a global variable which
flexlm uses to 
indicate the level of diagnostic information
that is required to be shown when a lm_checkout
returns an error.
The global variable is stored in the registry at

[HKEY_LOCAL_MACHINE\SOFTWARE\FLEXlm License Manager]
"Service"="FLEXlm License Manager"
"FLEXLM_DIAGNOSTICS"="2"
"LM_A_DIAGS_ENABLED"="1"

LM_A_DIAGS_ENABLED = 0 	Deactivates Diagnostics
LM_A_DIAGS_ENABLED = 1 	Activates Diagnostics
FLEXLM_DIAGNOSTICS = 1	Basic Diagnostics
FLEMLM_DIAGNOSTICS = 2  Enhanced Diagnostics

This Registry key is only present if you have
installed the SDK.

<b> GENERATION OF KEYS </b>

1)Information required for Generation of key

The serial key would be required for the license file.
This key is generated 
internally by
the lmgr325c.dll from information inside the license
file.

Before commencing generate a FAKE license file

FEATURE f1 VENDOR 1.000 1-jan-0 0 
1<b>0</B>2<b>0</b>3<b>0</b>4<b>0</b>567898765432 "" ANY
FEATURE f2 VENDOR 1.000 1-jan-0 0 
1<b>0</B>2<b>0</b>3<b>0</b>4<b>0</b>567898765432 "" ANY
FEATURE f3 VENDOR 1.000 1-jan-0 0 
1<b>0</B>2<b>0</b>3<b>0</b>4<b>0</b>567898765432 "" ANY
FEATURE f4 VENDOR 1.000 1-jan-0 0 
1<b>0</B>2<b>0</b>3<b>0</b>4<b>0</b>567898765432 "" ANY

<b><u>NOTE : </b></u> The 2nd 4th 6th 8th digit in the
key is used for the date so they must be zero
This is only valid for ver 5.12. In version 6 i believe these are missing.
<I>f1,f2,f3,f4 </i> are feature names for your program.
Search around for these or just run the program and let it tell you which 
feature is missing in the license file.
<i>VENDOR</i> - This is needed and can easily be found
(See pilgrims essays)
1-jan-0 - Unlimited time access
1<b>0</B>2<b>0</b>3<b>0</b>4<b>0</b>567898765432 - serial key (required)

<b><u>NEXT STEP</b></u>

If you follow pilgrims essays you will find the key 5
generation point. 
Continue steping over
local functions until you see the extract date
followed by another call

E8A2940000              call 10030850			<- Key 5 Generation
83C40C                  add esp, 0000000C
8B4510                  mov eax, dword ptr [ebp+10]
8B4004                  mov eax, dword ptr [eax+04]
3345FC                  xor eax, dword ptr [ebp-04]
8945DC                  mov dword ptr [ebp-24], eax	<- Seed 1
8B4510                  mov eax, dword ptr [ebp+10]
8B4008                  mov eax, dword ptr [eax+08]
3345FC                  xor eax, dword ptr [ebp-04]
8945E0                  mov dword ptr [ebp-20], eax	<- Seed 2
8D45D8                  lea eax, dword ptr [ebp-28]
50                      push eax
8B450C                  mov eax, dword ptr [ebp+0C]
83C048                  add eax, 00000048
50                      push eax
* Reference To: LMGR325C.l_extract_date
                                  |
E815BDFDFF              call 100030EE	    <- Extract date from fake license file
83C404                  add esp, 00000004
50                      push eax
8B450C                  mov eax, dword ptr [ebp+0C]
50                      push eax
8B4508                  mov eax, dword ptr [ebp+08]
50                      push eax
E8261BFFFF              call 10018F10			<- Look at what this returns
83C410                  add esp, 00000010

Examine the location EAX is pointing to. Does this
look like a KEY for the license file.

You don't think that the FLEXLM would really create a
system where the license key is generated
and the COMPARED to the one in the license file. YES
they would because this is exactly what they do.
And not only that they leave it in memory untouched
when they are finished with it.

Note this key generated by lmgr325c.dll matches the
license file criteria i.e ANY and 1-jan-0

So note the location of this CODE

2)Let FLEXLM do the work for you.

Now wouldn't it be nice if FLEXLM would display this
code along with the feature name when you ran it

Now for some information Diagnostics only comes into
effect when the key is incorrect. With our FAKE
license file the diagnostics kick in and save a
flexNNN.log file in the directory where you ran it.
Examining a typical flexnnn.log file on DIAGNOSTICS
level 2 shows that they kindly show

FLEXlm checkout error: Invalid (inconsistent) license key (-8,130)
license file(s):  c:\flexlm\license.dat
lm_checkout("f1", VENDOR, (null), 0x12345678, ..., 0x12345678)

Lets use this lm_checkout line to show us the Feature
name and the correct KEY
Search through the dead listing and find
lm_checkout("%s", %s, %d, 0x%x, ..., 0x%x)"
Now patch the routine before it to push the location
of the CODE/KEY and voila

The first time you run your program it will report an
error and give you the correct key to use.
replace the key with the Generated key in the license
file and its up and running

The nice thing about this patch is that it does not
interfere with the operation of the
program The patch only operates when there is a
problem.

Having just read pilgrims essay about using lc_baddate
as a place to insert code wouldn't it be
easier to use the diagnostic function to spit out the
keys and seeds and anything else you need

Note : To add more information to the print out edit
the lm_checkout("%s", %s, %d, 0x%x, ..., 0x%x) to anything
you like
LM %s,%s,%s,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x) will supply
a lot of information as long as you push it
to the stack before calling it.

</prE>
<BR><BR>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" 
 >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT
color=blue>Final 
Notes</FONT>
</FONT></CENTER></TD></TR></TABLE>

Let me just say how can FLEXLM be so stupid as to
generate a key and then 
COMPARE it
and leaving such a large amount of room for the casual
programmer to extend 
the working operation of their own program.
Anyway let us further examine FLEXLM in order to find easy
solutions to complex problems

<BR><BR>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" 
 >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT
color=blue>Ob 
Duh</FONT></FONT>
</CENTER></TD></TR></TABLE>
<CENTER>
   <I>I wont even bother explaining you
   that you should BUY this target program if you
intend to use it for a 
longer
   period than the allowed one. Should you want
   to STEAL this software instead, you don't need to
crack its protection
   scheme at all: you'll
   find it on most Warez sites, complete and already
regged, farewell.</I>
</CENTER>

<!-- WAY OUT STARTS HERE -->
<HR>
<CENTER><I>You are deep inside fravia's pages of
reverse engineering,
choose your way out:</I></CENTER>
<BR><CENTER>
<!-- EITHER A NICE GIF LIKE THIS -->

<!--
<a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif"
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43
BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->

<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back
to 
Your_chosen_project</A>
<hr width=33%>
-->

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>
<BR>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality cracking</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how
to search</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>
<BR>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity academy</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ahref/index.html" tppabs="http://www.anticrack.de/fravia/ahref/index.html"http://fravia.org/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>
<br>
<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is
reverse engineering 
legal?</A>
</CENTER>
<hr>
</BODY>
</HTML>

"