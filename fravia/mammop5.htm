<HTML>

<HEAD>

<TITLE>mammop5</TITLE>

</HEAD>

<BODY BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<CENTER><FONT size="+3">Customizing Netscape's buttons and menus</FONT>

<BR>(Resource editing galore)<BR>

  <BR>



<H4>by Mammon_<BR>

<BR>

(20 September 1997)</H4>

<HR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of fravia's page 

of reverse engineering<BR><BR>

Well, this is a VERY interesting essay from Mammon_. I noticed part of this 

work on Mammon_'s own and very <A href="tppmsgs/msgs2.htm#225" tppabs="http://www.anticrack.de/fravia/tppmsgs/msgs2.htm#225">good page</A> more than four week ago, and I'm happy to see that he sent a nice ameliorated essay to the +HCU. As you'll read in Mammon_'s essay, there is a lot of resource editing going on, so let's clear these things out a little.<BR><BR>

I &quot;presented&quot; myself the BRW resource editor to the scene some time ago with my <A href="ultrae2.htm" tppabs="http://www.anticrack.de/fravia/ultrae2.htm">ultraedit essay</A>, many knew this stuff already, yet many other did not, and anyone can see that resource editors are now much more used than a year ago :-).<BR><BR>There are on this planet (to my knowledge) following <U>main resource editors</U>:<BR><FONT color="blue">

WRT</FONT> = Whitewater Resource Toolkit for Windows 3.1, A very good tool, greeted as &quot;Wizard stab&quot; when it appeared, father of all the following ones. Whitewater has been BOUGHT by Symantec in order to get this extraordinary 16-bit project<BR><BR>

<FONT color="blue">BRW</FONT> = Borland Resource Workshop, last version 4.5 shipped with Borland C++ 4,5 (you can have it <FONT color="red">now</FONT> once more for less than 4 UK pounds on the next new <FONT color="red">October 1997</FONT> issue of PcPLUS, a UK computer magazine, see my <A href="blackbo.htm" tppabs="http://www.anticrack.de/fravia/blackbo.htm">blackboard</A>)<BR>This resourec editor is still the best one IMO. Borland seems to have kept rights on WRT until 1994/5<BR><BR>

<FONT color="blue">SRS</FONT> = Symantec Resource Studio 32, Version 1.0, (c) 1995, 

nice graphic and frills, 

works not as good as BRW. This is the Whitewater product <U>without</U> the knowledge of the Wizards at Borland, &quot;restyled&quot; and &quot;updated&quot; to 32 bit by the average programmers at Symantec.<BR><BR>

<FONT color="blue">WRE</FONT> = Watcom resource Editor for Windows NT, versioN 11.0. A good resource editor, yet not as good as Borland's BRW 4.5. WRE.EXE is only 174.592, but it needs a lot of other &quot;parts&quot; and *.dlls to work<BR><BR>

I am awaiting your contributions on these matters. As soon as enough material arrives, we'll move the above introduction to a special +HCU's section (Hackmore, are you reading this?)...<BR><BR>

<I>

And now enjoy this very interesting essay: I always hated those stupid useless &quot;Directory Buttons&quot; in Navigator :-)</I></CENTER><HR size="6">



<FONT size="+2">

More Work On Project5<P></FONT>

by Mammon_<P>





Target File: Netscape.exe version 3.01 Gold, 3.02 MB (42.4 MB 

Decompiled &quot;dead listing&quot;)<P>





It is now, as I write, 1997. The Internet has become a combination 

library, software warehouse, and television: more than ever before, a 

cracker's Web Browser is as vital as his debugger, his disassembler, 

even his hex editor. It is necessary, then, to trim these browsers so 

they do not hinder our progress, and to tailor them to a style that 

suits us. ACP and +YOSHi have both done well with Netscape Navigator's 

windowing annoyances; I will here demonstrate how to customise the 

application's user interface.<P>

<BR>

<FONT size="+2">

<B>1. The Location Bar</B></FONT><P>

The best way to start out is with a string data search, as our targets 

are going to be menus and buttons. As I was planning to do some extra 

work in the .exe, I opened up Netscape in W32Dasm and got coffee while 

it was disassembling. I exported the String Data Reference list into 

WordPad (Notepad being, alas, not up to the task) and did a quick search 

for &quot;http://&quot;, finding the string values relating to the items we will 

be changing along (e.g., 

&quot;http://guide.netscape.com/guide/what'snew.html&quot;). For the record, I 

found a number of strings using BRW that were not in the W32Dasm 

disassembly.<P>



Here is where it gets interesting: I was scrolling through the string 

data listing, waiting for my eyes to glaze over, when I cam across a 

command I knew--&quot;about:global&quot;, which when typed in the location bar 

causes the Netscape.hst file to be dumped onscreen. The first thought 

that flashed through my mind was &quot;Undocumented commands!&quot;, and after 

many minutes of sifting through meaningless strings I came up with the 

following list of location-bar commands:<P><PRE>

about:xxxx           xxxx text appears on blank page (1.43K limit)

about:               Displays the Netscape &quot;About Box&quot;

about:blank          Displays a blank page

about:cache          Dumps the contents of the URL cache

about:document       The same as View-&gt;Document Info

about:editfilenew    Opens a blank document called file:///Untitiled

about:global         Shows the URL history from the Netscape.hst file

about:image-cache    Dumps the contents of the image cache

about:license        Displays the Netscape product license (snore)

about:memory-cache   Displays the contents of the memory cache

about:plugins        Displays stats on all of the plug-ins

File:///             Opens a file in the browser; .,.., drive letter are all valid

Javascript:          Opens a Javascript console (OK, we knew this one...)

Mailto:              Opens the send-mail dialogue box (OK, we knew this one too)

view-source:         Same as View-&gt;Document Source<P></PRE>

It gets even better. First of all, remember that these go in the 

location bar, and therefore one can place them in the href= parameter of 

an <A> tag  <FONT color="blue">--instantly, lots of new web-page tricks</FONT>. I experimented a bit 

with the about: command and quickly learned that anything you type after 

&quot;about:&quot; will show up on a blank document. I typed <B>&quot;about:When in danger 

or in doubt, run in circles, scream and shout.&quot;</B> There it was, in black, 

on a black page.<P>

So I experimented some more, typing &quot;about:&lt;center&gt;When in &lt;font 

color=&quot;ff0000&quot;&gt;danger&lt;/font&gt; or in doubt, &lt;P&gt; Run in circles, scream and 

shout. &lt;/center&gt;&quot;, and sure enough it appeared in its full HTML-formatted 

glory. <FONT color="blue">As good as document.writeln() without javascript!</FONT><P>

Of course the next thing I tried was dumping the entire source code of 

my tools page (after changing the double quotes to singles, and vice 

versa) into the href= parameter of an <A> tag that read, originally 

enough, TEST. I clicked it and a new page loaded with maybe <U>a tenth</U> of my 

tools page displayed (due, of course, to the limitation of a Windows 

edit control...effectively, the location bar can take up to a 1.43K text 

file, as I found by testing).<P>

Now what are we left with? An undocumented &quot;document.writeln()&quot;-ish 

feature that allows you to enter up to 1400 characters of HTML code 

(sans &lt;HTML&gt; and &lt;BODY&gt; tags) directly from an &lt;a&gt; tag! And who says 

Netscape has no surprises.....<P>

<BR>

<FONT size="+2">

<B>2. The Buttons</B></FONT><P>

The first thing to change in our target is going to be the buttons --you know 

the ones, 

those useless &quot;Directory Buttons&quot; that you always turn off (Options/ Show directory buttons) because they have 

horrible titles (and contents) like &quot;What's New&quot;, &quot;What's Cool&quot;, and &quot;People&quot;. 

If you 

look in BRW you will find the labels for those buttons, and the URLs that 

match them, inside strings 621-635. Needless to say, you can edit the strings 

to reflect your six most-visited web pages. I chose to remap them as 

follows:<P>



<LI>621 (What's New): from ...whats-new.html to 

http://207.30.50.126/fravia (New Title: <FONT color="blue">+HCU</FONT>)

<LI>622 (What's Cool): from ...whats-cool.html to 

http://kryten.eng.monash.edu.au/gspamt.html (New Title: <FONT color="blue">Net

Tools</FONT>) 

<LI>623 (Destinations): from ...index.html to http://www.hotmail.com 

(New Title: <FONT color="blue">HotMail</FONT>) 

<LI>624 (Net Search): from ...search.html to 

http://cuiwww.unige.ch/eao/www/Internet/Nedashkovsky.html (New

Title: <FONT color="blue">Search Engines</FONT>) 

<LI>625 (People): from ...white-pages.html to 

http://www.anonymizer.com/open.html (New Title: <FONT color="blue">Anonymizer</FONT>) 

<LI>626 (Software): from ...upgrades.html to about: &lt;applet  

codebase=&quot;file:///F|/Jdk/&quot; code=&quot;AppletKiller.class&quot; width=100 

height=100&gt;Applet Killer&lt;/applet&gt; (New Title:

<FONT color="blue">Applet Killer</FONT>)<P>



Notice this last one: an application of the above principle, basically a 

one-line web page that calls the compiled AppletKiller.class (watch it, 

this thing makes your system very unstable) from the hard-drive. The 

rest of them are pretty standard, your typical useful web pages...<P>

<BR>

<FONT size="+2">

<B>3. The Menus</B></FONT><P>

But we are not done yet; there are still a couple of useless menus 

lurking around here (Look at your Netscape window: &quot;Directories&quot; once again and also &quot;Help&quot;, both of 

which use URLs to define their actions)...you'll find their strings 

between 65000-65399, though I would suggest editing only the URLs and 

changing the menus directly by editing the Menu2 resource through BRW.

The menus originally look as follows:<P>

Directory:

<LI>&quot;Netscape's Home&quot; <I>http://homenetscape.com</I>

<LI>&quot;What's New&quot; <I>http://guide.netscape.com/guide/what'snew.html</I>

<LI>&quot;Whats Cool&quot; <I>http://guide.netscape.com/guide/what'scool.html</I>

<LI>&lt;SEPARATOR&gt;

<LI>&quot;Customer Showcase&quot; 

<I>http://home.netscape.com/home/netscape-galleria.html</I>

<LI>&quot;Netscape Destinations&quot; <I>http://netscape.yahoo.com/guide</I>

<LI>&quot;Internet Search&quot; 

<I>http://home.netscape.com/escapes/search/ntsrchrnd-2.html</I>

<LI>&quot;People&quot; <I>http://guide.netscape.com/guide/people.html</I>

<LI>&quot;About the Internet&quot; <I>http://home.netscape.com/home/about-the-internet.html</I>

<BR><BR>

Help: 

<LI>&quot;About Netscape&quot; <I>about:</I>   ;Note the use of the about: tag!

<LI>&quot;About plugins&quot; <I>about:plugins</I>

<LI>&quot;Registration&quot; Information 

<I>http://home.netscape.com/netcenter/prodreg/start.html</I>

<LI>&quot;Software&quot; 

<I>http://home.netscape.com/comprod/upgrades/index.html</I>

<LI>&quot;Web Page Starter&quot; <I>http://home.netscape.com/home/starter.html</I>

<LI>&lt;SEPARATOR&gt;

<LI>&quot;Handbook&quot; <I>http://home.netscape.com/eng/mozilla/3.0/handbook</I>

<LI>&quot;Release Notes&quot; 

<I>http://home.netscape.com/eng/mozilla/3.0/relnotes/windows-3.0Gold.html</I>

<LI>&quot;Frequently Asked Questions&quot; 

<I>http://help.netscape.com/faqs.html</I>

<LI>&quot;On Security&quot; <I>http://home.netscape.com/info/security-doc.html</I>

<LI>&lt;SEPARATOR&gt;

<LI>&quot;How to Give Feedback&quot; 

<I>http://cgi.netscape.com/cgi-bin/autobug.cgi</I>

<LI>&quot;How to Get Support&quot; <I>http://help.netscape.com</I>

<LI>&quot;How to Create Web Services&quot; 

<I>http://http://home.netscape.com/home/how-to-create-web-services.html</I><P>



These will never do. I opted to keep the layout of the separators, 

though by all means I could have added or removed a few, and went with 

the following layout:<P>



Cracking:

<LI>Mammon_ (Home) <I>I'll avoid the obvious free plug :)</I>

<LI>Mammon_ (Links)

<LI>Mammon_ (Tools) 

<LI>&lt;SEPARATOR&gt;

<LI>Fravia <I>http://207.30.50.126/fravia/</I>

<LI>Greythorne <I>http://www.cracking.net/gthorne/ </I>

<LI>Hacker's Layer <I>http://www.lordsomer.com/ </I>

<LI>L0pht <I>http://www3.l0pht.com/ </I>

<LI>Silicon Toad <I>http://www.silitoad.org/ </I><P>



Resources:

<LI>AngelFire <I>http://www.angelfire.com </I>

<LI>FortuneCity <I>http://www.fortunecity.com </I>

<LI>Geocities <I>http://www.geocities.com </I>

<LI>Send Fax <I>http://www-usa.tpc.int/sendfax.html </I>

<LI>Supernews <I>http://supernews.com </I>

<LI>&lt;SEPARATOR&gt;

<LI>FTP Search <I>http://ftpsearch.ntnu.no/ftpsearch/ </I>

<LI>SwiftSearch <I>file:///C|/Tools/SwiftSearch/SwiftSearch.exe</I>

<LI>NetInfo <I>file:///C|/Tools/NetInfo.exe </I>

<LI>JPadPro <I>file:///F|/Jdk/JPadPro/JPadPro.exe </I>



<LI>&lt;SEPARATOR&gt;

<LI>Webside Story 

<I>http://www.hitbox.com/wc/MAKElists/Top100HackingPhreaking.html</I>

<LI>HTML Reference <I>http://sdcc8.ucsd.edu/~m1wilson/htmlref.html </I>

<LI>Javascript Reference <I> 

http://home.netscape.com/eng/mozilla/3.0/handbook/javascript/index.html 

</I><P>



Ah, much better. Once more now, theory into practice, by using the file:/// 

tags to access files on my hard drive. To get this to work right, you 

have to set the Netscape action for &quot;.exe&quot; to &quot;Launch this application:&quot; 

with the application field left blank. This will give you a SaveAs... 

box when you click on one of the &quot;file:///&quot; menu items (i.e., NetInfo); 

if you press OK, the .exe will save, and if you press CANCEL, the .exe 

will run (we could disable the box, but then you could never save .exe's 

that you downloaded...).<P>

To top it all off, I shuffled around the main items in Menu2 so that my 

menu bar now reads 

File...Edit...View...Go...Cracking...Resources...Bookmarks...Options...Window:

perfecto! Now you just need to change the title bar to Crackscape....<P>

<BR><FONT size="+2">

<B>4. Notes about the Registry</B></FONT><P>

The obvious place to look for the URLs linked to each button and menu 

item would have been the Registry, and this was in fact the first place 

I checked. As shown above, however, the string values are hard-coded in 

the executable itself. Netscape does keep a number of interesting values 

in the Registry, all of them in<PRE>

HKey_Current_User\Software\Netscape\Navigator</PRE> 

(the HKey_Local_Machine\SOFTWARE key simply stores the version number of the 

program), which has the following subkeys:

<LI>Address Book (where it is located)

<LI>Automation Protocols

<LI>Automation Shutdown

<LI>Automation Startup

<LI>Automation Viewers

<LI>Bookmark List (where it is stored)

<LI>Bookmark Window (schematics)

<LI>Cache (where it is stored)

<LI>Compose Window (schematics)

<LI>Cookies (where they are stored)

<LI>Default Plugin (name)

<LI>Editor (preferences)

<LI>History (URLs that drop down from Location Bar)

<LI>Images (settings)

<LI>INTL (settings)

<LI>Java (on or off)

<LI>Mail (settings/account info)

<LI>Mail Window (schematics)

<LI>Main (preferences)

<LI>Main Window (schematics)

<LI>Network (preferences)

<LI>News (preferences)

<LI>News Window (schematics)

<LI>Page Setup (schematics)

<LI>Proxy Information (proxy servers/IPs)

<LI>Publish (settings/account info)

<LI>Security (settings)

<LI>Services (servers for POP3, etc)

<LI>Settings (preferences)

<LI>Suffixes (file extensions)

<LI>Temporary File URL Resolution (file location)

<LI>Tool Bar (settings)

<LI>User (identity from Mail/News prefs)

<LI>User Trusted External Applications (file loactions)

<LI>Viewers (file locations)<P>



It is generally a good idea to locate things like URL history and Cache 

in a temp directory that gets <FONT color="blue">deleted</FONT> at bootup; these files will all 

re-create themselves. Cookies.txt, however, cannot be replaced with a 

nonexistent file; the last time I tried that I went to microsoft.com to 

test it and my computer GPF'd so hard that soft-ice only showed a column 

of &quot;FFFFFF: INVALID&quot; opcodes when I tried to pull out of it....<P>

<BR>



There's not much to sum up in this essay, unless it is to point out how 

simple it is to customise these programs with a good resource editor. Strings 

are by all means a good starting point in reverse-engineering or 

cracking a program; if you follow any one of the &quot;http:&quot; strings through  

W32Dasm, you'll find that the first or second call following, leads to 

the &quot;URL Parsing&quot; routine, an interesting routine which is referenced by about a hundred 

different lines of code. <P>

As a note of interest, I did the work on this project twice, once with 

BRW, once with Symantec Resource Studio; both were equal until I juggled 

the menus, which then did NOT link to the URLs in the Symantec version. 

This is not to put down Resource Studio as an editor: in fact, it allows 

me to edit at least some of explorer.exe while BRW flat-out crashes. But 

it is more food for thought; some day we may have to &quot;repair&quot; these 

tools....<PRE>Mammon_ </PRE>

<FONT color="green">(c) Mammon_ 1997. All rights reversed</FONT>

<HR ALIGN="CENTER" WIDTH="100%" SIZE="3">

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="project5.htm" tppabs="http://www.anticrack.de/fravia/project5.htm">Back to Project 5</A> (&quot;Netscape reversing&quot;)<HR width="22%">



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="javascript:if(confirm('http://fravia.org/tppmsgs/msgs0.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tppmsgs/msgs0.htm#84'" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="javascript:if(confirm('http://fravia.org/tppmsgs/msgs0.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tppmsgs/msgs0.htm#73'" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="javascript:if(confirm('http://fravia.org/tppmsgs/msgs0.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tppmsgs/msgs0.htm#82'" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82">students' essays</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A><BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia</A><BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering legal?</A></CENTER>

<CENTER><HR ALIGN="CENTER" WIDTH="100%" SIZE="2"></CENTER>

</BODY>

</HTML>



