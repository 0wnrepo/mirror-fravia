<HTML>

<HEAD>

<!--  formamus.htm version 02 February 1998 

      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

      SEARCH THIS TEXT FOR THE STRING "Your_" 

      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

      THANKS A LOT: this will allow automated retrieval -->

<TITLE> twd_vss5.htm Cracking Micro$oft Visual SourceSafe 5.00 </TITLE>

</HEAD>



<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%  HEIGHT=" 22">

<TR><td></td>

<td>

<!-- Choose  a TITLE probably wont be changed -->

<center><FONT SIZE="+2">Cracking Micro$oft Visual SourceSafe 5.00</fonT><br>

        <FONT SIZE="+1">Cracking a quite easy timeprotection</fonT>

</center>

</td>



<td>

<!-- Choose  a PROJECT GIF, leave this if unsure -->

<center><a href="project9.htm" tppabs="http://www.anticrack.de/fravia/project9.htm"><IMG

SRC="project9.gif" tppabs="http://www.anticrack.de/fravia/project9.gif"  ALT="project9" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></a>

<br>

<font color=gray>Microsoft bashing</FonT>

</center></td></tr>

<tR>

<td bgcolor="#FFFFEA"><center>

<FONT COLOR="890000">

<!-- CHOOSE A DATE (will probably be changed) -->

31 March 1998

</FONT></center>

</td>

<td bgcolor="#FFFFEA"><center>by <font size=+3>

<!-- CHOOSE A HANDLE (wont be changed) -->

TWD

</fonT></center>

</td>

<td VALIGN="center" bgcolor="#FFFFEA">



</td>

</tr>

<TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

 ALIGN="BOTTOM" 

BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>

<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 

reverse engineering</center> 

</center></TD>

<td BGCOLOR="898030">

<center>

<!-- Your truly+ will edit only if really necessary -->

slightly edited<br>

by fravia+</center></td>

</TR>

<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->

<tr><td><font color="#C4C0CF">fra_00xx<bR>98xxxx<br>handle<br>1100<br>NA<br>PC<br></fonT></td><td><i><center>

<!-- Your truly+ comments -->

Well, TWD is specialising in Micro$oft bashing, as it seems. That's very good. I'm a little 

deceived that so many reversers ignore totally Micro$oft's awful applications (and silly 

protections). This is a MISTAKE! Micro$oft's programs are extremely overbloated and buggy, 

yet they are also SOLD and WIDESPREAD. Let's take account of this simple (if very sad) reality. 

Reversing Micro$oft's application is therefore USEFUL for a series of reasons:<br></center>

1) It could be helpful -say for some far-away forgotten study institute in Africa without any money- to have the 

possibility to use the SAME (stupid) applications that all other study institutes all 

over the 'developed' world are (unfortunately) using... excel instead of 1-2-3, so to say: not 

that it works better (it does not) nor quicker (it does not), but excel is unfortunately, 

like it or not, the <i>de facto</i> 'standard' of these aera of software decadence.<bR>

2) We could find -reversing deep and reversing well- some of the faul TRICKS that the Micro$oft's 

programmers have hidden inside their applications in order to get, say, a complete list of 

the software running on a given machine, or to delay a little netscape's browser, or to 

send to their sites on line some registration informations without asking you.<center>

</i></center></td>

<td></td>

</tr>

<TR><TD BGCOLOR="898030">(TWD) ></td>

<!-- We love the beautiful in live, not only cracks -->

<TD BGCOLOR="898030"><center></i><b>



Life is but a dream therefore, 

where there is no dream,

there is no life - it's your life



</b></center>

<!-- We are funny, not only crackers -->

</center></TD><td></td>

</TR>

<TR>

<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

Rating</FONT></FONT></center>

</TD>

<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

<!-- CHOOSE A RATING (may be changed) -->

(x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>

</center></td>

<td></td>

</tr>

</table>

<!-- END HEAD  -->

<bR>

<!-- CORPUS  -->



<!-- CHOOSE A COMMENT (may be changed)  -->



A very easy crack, but it's a Micro$oft crack. That's worth an essay.





<hR>

<center>

   <FONT SIZE="+2">

<!-- CHOOSE A TITLE (wont probably be changed) -->

  Cracking Micro$oft Visual SourceSafe 5.00



   </FONT><BR>

   <FONT SIZE="+2">

<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->



TimeNag - cracking at it's most easy



   </FONT><BR>

   <FONT COLOR="0B7FC1">

<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 

TWD



   </FONT>

</center><br><br>



<!-- INTRO STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>

</fonT></center></td></tr></table>

<pre>

  You wont believe it, but Micro$oft distributes a german developer CD-ROM

  With a lot of crap on it, but also with on or two "time-protected" programs.

  One of the programs is Visual SourceSafe 5.00

</prE>

<br><br>



<!-- TOOLS STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>

</fonT></center></td></tr></table>

  Tools I used :  - SoftICE 3.22

                  - IDA 3.7

                  - UltraEdit 5.0  (just for editing and writing essays)                





<br><br>



<!-- TARGET URL STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>

</fonT></center></td></tr></table>



Maybe at     www.microsoft.com



<br><br>



<!-- PROGRAM HISTORY STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>

</fonT></center></td></tr></table>



Which history ???



<br><br>



<!-- REAL ESSAY  STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>

</center></td></tr></table>

<!-- PASTE HERE THE TEXT OF YOUR ESSAY

     THIS IS OF COURSE THE MOST IMPORTANT PART

     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 

     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE

     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->

<pre>



After starting Visual SourceSafe 5.00 and logging in, a window appears and 

tells us that only 30 days a remaining, before VSS expires.



Thanx a lot, I finished it and started it again. Before finishing the login,

I set a breakpoint on   GetLocalTime   and continued.



SoftICE breaks up here :



10037843 8D 44 24 08                 lea eax, [esp+18h+var_10]

10037847 50                          push eax

10037848 FF 15 34 44 06 10           call ds:GetLocalTime

1003784E 66 8B 44 24 08              mov ax, word ptr [esp+18h+var_10]

10037853 8A 4C 24 0A                 mov cl, [esp+18h+var_E]





Nice, nice, but not the thing we are looking for. You can look around by pressing

some "^p ret;" in your SoftICE, but this is not the right position, at least not 

in the moment.



After carrying on, SoftICE pops up at exact the same position as the last time, but

this time called by another procedure :





100025C7 E8 74 52 03 00              call ?DT_GetCur@@YAJXZ      ; <-- Our proc

100025CC 2B 44 24 78                 sub eax, [esp+204h+var_18C]   <-- eax=days passed

100025D0 B9 80 51 01 00              mov ecx, 15180h

100025D5 99                          cdq

100025D6 F7 F9                       idiv ecx

100025D8 83 F8 3C                    cmp eax, 3Ch

100025DB 7C 23                       jl  short loc_10002600

100025DD C7 05 18 86 05 10 01 00+    mov dword_10058618, 1

100025E7 6A 3C                       push 3Ch

100025E9 68 70 D6 FF FF              push 0FFFFD670h

100025EE E8 0D 83 01 00              call ?Error@MSERR@@SAHHZZ   ; <-- Output Error 1





The call at  "100025C7"  checks the time. The days since installation are stored in eax.

If more than sixty days are gone, a special message box pops up. (Error 1).

There are more error messages like this one. This one is called if more than 30 days 

have passed since SourceSafe expired. If you have just installed Visual SourceSafe, 

it shouldn't be expired, that means it jumps to :



10002600 83 F8 1E                    cmp eax, 1Eh

10002603 7C 17                       jl  short loc_1000261C

10002605 68 71 D6 FF FF              push 0FFFFD671h

1000260A E8 F1 82 01 00              call ?Error@MSERR@@SAHHZZ   ; <-- Output Error 2

1000260F 83 C4 04                    add esp, 4

10002612 33 C0                       xor eax, eax

10002614 5E                          pop esi

10002615 81 C4 00 02 00 00           add esp, 200h

1000261B C3                          retn



If more than 30 days and less than 60 days passed by, another message box pops up (Error 2).

Else we keep going on jumping to :



1000261C B9 1E 00 00 00              mov ecx, 1Eh

10002621 2B C8                       sub ecx, eax

10002623 51                          push ecx

10002624 68 72 D6 FF FF              push 0FFFFD672h

10002629 E8 D2 82 01 00              call ?Error@MSERR@@SAHHZZ   ; Error 3

1000262E 83 C4 08                    add esp, 8

10002631 33 C0                       xor eax, eax

10002633 5E                          pop esi

10002634 81 C4 00 02 00 00           add esp, 200h

1000263A C3                          retn



If less than 30 days are gone, SourceSafe calculates the remaining days, stores them

in ecx and outputs it with a message box. This is no real error, but it disturbs.



To kick this silly protection and to remove the message box (Error 3), the only thing 

to do, is to change the 



    100025DB 7C 23                       jl  short loc_10002600



to 



    100025DB EB 54                       jmp 10002631





This will jump short behind the message box (error 3), but it shouldn't jump on

the 



    1000262E 83 C4 08                    add esp, 8



because this will kill the program by modifying the stack.





As usual questions, ideas, suggestions, etc can be send to 



   mailto:twd(point)rulez(at)gmx(point)net

   <a href="javascript:if(confirm('http://twdrulez.home.ml.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://twdrulez.home.ml.org/'" tppabs="http://twdrulez.home.ml.org/">http://twdrulez.home.ml.org</a>

</pre>

<br><br>



<!-- FINAL NOTES STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>

</fonT></center></td></tr></table>

<pre>



Cracking this program was very simple. One breakpoint on GetLocalTime was enough.

Why some one should use this program is very easy to explain. The overbloated 

M$ - programs make it necessary. 



</pre>

<br><br>



<!-- OB DUH STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>

</center></td></tr></table>

 <center>

   <i>I wont even bother explaining you 

   that you should BUY this target program if you intend to use it for a longer 

   period than the allowed one. Should you want 

   to STEAL this software instead, you don't need to crack its protection 

   scheme at all: you'll 

   find it on most Warez sites, complete and already regged, farewell.</i>

</center>



<!-- WAY OUT STARTS HERE -->

<hr>

<center><i>You are deep inside fravia's page of reverse engineering,  

choose your way out:</i></center>

<br><center>

<!-- EITHER A NICE GIF LIKE THIS -->



<center><a href="project9.htm" tppabs="http://www.anticrack.de/fravia/project9.htm"><IMG

SRC="project9.gif" tppabs="http://www.anticrack.de/fravia/project9.gif"  ALT="project9" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></a>

<br>

<font color=gray>Microsoft bashing</FonT>

</center>

<br><bR>







<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascript:if(confirm('http://www.anticrack.de/fravia/index-1.htm  \n\nThis file was not retrieved by Teleport Pro, because the server reports that this file cannot be found.  \n\nDo you want to open it from the server?'))window.location='http://www.anticrack.de/fravia/index-1.htm'" tppabs="http://www.anticrack.de/fravia/index-1.htm">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"  ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"  ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"  ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality cracking</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how to search</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"  ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity academy</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"  ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut

CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering

legal?</A>

</CENTER>

<hr>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML>



