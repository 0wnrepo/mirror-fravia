<HTML>

 <HEAD>

  <TITLE>ind_tra1.htm: Pluckit 3.0 ~ Hip Hip Hurray for Smartcheck </TITLE>

 </HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="5" BORDER="0">

<TR>

  <TD VALIGN="MIDDLE" BGCOLOR="898030">

   <FONT SIZE="2" COLOR="FFFFFF">

    <CENTER><A href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></A></CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">

<!-- CHOOSE A PROJECT GIF (may be changed) -->



<A href="project8.htm" tppabs="http://www.anticrack.de/fravia/project8.htm"><IMG

SRC="visualba.gif" tppabs="http://www.anticrack.de/fravia/visualba.gif" 

ALT="Visual Basic" ALIGN=RIGHT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0

HSPACE=0></A>

   <FONT SIZE="+2">

<CENTER>

<!-- CHOOSE A TITLE (may be changed) -->

Pluckit 3.0 ~ Hip Hip Hurray for Smartcheck

   </FONT><BR>by 



<FONT size=+3>



<!-- CHOOSE A HANDLE (wont be changed) -->







+Indian_Trail







    </FONT>, 



 <FONT COLOR="890000">



<!-- CHOOSE A DATE (wont be changed, unless necessary) -->



04 May 1998





</FONT><BR>



  </CENTER>



  </TD>



 </TR>



<TR>



  <TD BGCOLOR="898030">   <FONT SIZE="2" COLOR="898030">f</TD>



  <TD BGCOLOR="898030"><CENTER>Courtesy of Fravia's page of 



reverse engineering</CENTER> 



  </CENTER>



  </TD>



 </TR>



<TR>



  <TD VALIGN="MIDDLE" BGCOLOR="898030">



   <FONT SIZE="2" COLOR="FFFFFF">



    <CENTER>fravia's comments</CENTER>



   </FONT>



  </TD>



  <TD BGCOLOR="C0C0C0"><I><CENTER>

An interesting essay for beginners, which underlines an old truth:<BR> 

<FONT color=green>IF</FONT> visual basic <FONT color=green>THEN</FONT> cracked at once<BR>

Protectors working in visual basic should be aware of the existence of Smartcheck (I can't 

imagine anyone working vith ANY programming language that doesn't know of this GREAT 

incredible reversing tool..., as I have written myself repeatedly :-)

<TR>



  <TD BGCOLOR="898030">   <FONT SIZE="2" COLOR="898030">f</TD>



  <TD BGCOLOR="898030"><CENTER></I><B>There is a crack, a crack in

everything<BR>



That's how the light gets in</B></CENTER>



  </CENTER>



  </TD>



 </TR>







<TR>



  <TD VALIGN="MIDDLE" BGCOLOR="2C142B">



   <FONT SIZE="2">



    <CENTER><FONT COLOR="FFFFFF">Rating</FONT></CENTER>



   </FONT>



  </TD>



  <TD BGCOLOR="C0C0C0">



   <FONT FACE="Courier New">



<!-- CHOOSE A RATING (may be changed) -->



    (x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> (

)<B>Expert</B>



   </FONT><BR><I>



<!-- CHOOSE A COMMENT (may be changed)  -->







We have all seen fine examples on how to use smartcheck. This essay will

be about how to get a valid serial number from smartcheck rather than

finding a byte to patch. I don't think it's possible to write a clever

protection in visual basic so thereof this protection is not interesting

at all...







</I>



  </TD>



 </TR>











   </FONT>



  </TD>



 </TR>



 <TR>



  <TD VALIGN="MIDDLE" BGCOLOR="890000">



   <FONT SIZE="2" COLOR="FFFFFF">



    <CENTER>Title</CENTER>



   </FONT>



  </TD>



  <TD BGCOLOR="C0C0C0">



   <FONT SIZE="+2">



<!-- CHOOSE A TITLE (may be changed) -->







Pluckit 3.0 Hip Hip Hurray for Smartcheck







   </FONT><BR>



   <FONT COLOR="0B7FC1">



    Written by +Indian_Trail



<!-- REPEAT YOUR CHOSEN HANDLE HERE -->







   </FONT>



  </TD>



 </TR>







 



 <TR>



  <TD VALIGN="MIDDLE" BGCOLOR="FF7F21">



   <FONT SIZE="2">



    <CENTER>Introduction</CENTER>



   </FONT>



  </TD>



  <TD BGCOLOR="C0C0C0">







<!-- PASTE HERE YOUR INTRODUCTION -->



<P>A friend of mine asked me to crack this program. It a newsscanner

that downloads pictures from newsgroups, probably written for porno

lusers. Anyway I didn't know that Pluckit was written with Visual Basic. 

So this was my first attempt at a visual basic program.</P> 

<P>

I never liked Visual Basic or delphy, I don't see the point in using a

language that produce bad code. The obvious way shuld be to try to write as

small and efficent programs as possible and to do that -as you all know-

you have to write tha meain routines in pure assembler. Anyway I don't

mind people using Visual Basic as an introduction language to

computer programming. Most of us learned basic as a start on the first

home computers like Zx80 or Sinclair Spectrum and C64. But, programs

that are written in toy languages like this should be free for all people.</P>

<P>

Applications that are slow and filled with bugs should not be

commercial, they should be freeware (this is valid for word an Excel as well, btw). 

Unfortunatley the author of this lame

crap has another idea about this. On startup there is an ugly nagscreen

with some text inside it and an "ok_ button" and a "cancel_button".

After the nagscreen is a register screen where you can input a

serialnumber, if you don't have a serial# you'll only be able to

download 15 files. We will focus on the serial#.</P>

</TD>

 </TR>



 <TR>

  <TD VALIGN="MIDDLE" BGCOLOR="B04A53">

   <FONT SIZE="2">

    <CENTER>Tools Required</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">



   <B>



<!-- PASTE HERE YOUR REQUIRED TOOLS -->



Smartchecker 5.0 <BR>Win32Dasm



<BR>~<BR>



<!-- DON'T FORGET TO PASTE HERE ALSO THE URL/FTP OF YOUR TARGET -->



<A href="javascript:if(confirm('http://www.pluckit.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.pluckit.com/'" tppabs="http://www.pluckit.com/">www.pluckit.com</A>



</B></TD>



 </TR>



 <TR>



  <TD VALIGN="MIDDLE" BGCOLOR="FFFFEA">



   <FONT SIZE="+3" COLOR="C0C0C0">



    <CENTER>T<BR>H<BR>E<BR> <BR>E<BR>S<BR>S<BR>A<BR>Y</CENTER>



   </FONT>



  </TD>



  <TD VALIGN="TOP" BGCOLOR="C0C0C0">



    <H3>Step I: loading the target through smartcheck.</H3>

<HR>

<P>

As I mentioned this is my first attempt to crack a VB program. In my

first approach I changed some jumps in memory, but there were too many

jumps to change so I decided to go for the serialnumber. I'm not gonna

cover how to set up smartcheck cause Fravia+ has already done that. Well

lets fire smartcheck...<BR><BR>



On startup you'll get two 'invalid arguments' errors, like I said, this crap 

is filled with bugs. Proceed to the registration screen and type in any#.

In smartcheck choose view "specific events.. " so you can easily

navigate and find what we are looking for.</P>

<P>

After the "invalid..." dialogbox appears, terminate Pluckit3 and go to

smartcheck and look around. At sequence# 16745 you'll see your false

serial number. Now what follows is:</P>

<PRE>

16752	Trim (variant: string"false#")	4d4260

16763	Val (string"false": 	

	| 

	|

16931	msgbox

-----

</PRE><P>

Now it's time to choose view "All events".  I reached this point after 3

seconds, and What you'll see now is the first barricade of the

protection scheme. The last things that are done before the messagebox

as you'll see (if you chosen view all events) is :

<PRE>

16926	__VbaVarOr()		

16927	__VbaBoolVarNull()	Return dword FFFFF

16928	_vbaVarDup(VARIANT: string "invalid", Variant boolean false)

----

</PRE>

This looks very strange, no manipulations at all so far execpt from the

basic ones ie calculate length of string and so on. I don't know what

__vbaVarOr or __vbaBoolVarNull does exactly but judging from their names

they must check something from beeing either true or false. That was

what I thought when I first glanced at it. But what could it be?

It could be three things:

<PRE>

1 A letter 

2 A char ie "%" or whatever

3 both of them

</PRE></P><P>

So start all over again and this time enter your name as registration#.

Remeber to choose view "specific events and errors" if you want to skip

alot of unimportant "code".

<BR><BR>

There are some significant changes, first obvious one is we passed the

__vbaBoolVarNull and second the sequence numbers has shrinked !!?  The

messagebox is now at sequence# 14764. But what's more interesting is the

lines above 14764. From 14731 ---> 14758 are a bunch of

Integer(#)-->Long(#) where # is starting from 0 and ending at 9. View

all events and you'll see that under each Integer(#) there is a a

different number that is tested against a variable called double:0. The

values that are tested against double:0 are:

<BR><BR>

55276<BR>

39824<BR>

68684<BR>

75268<BR>

12367<BR>

59826<BR>

48927<BR>

65826<BR>

34096<BR>

15824<BR>

<BR></P><P>

This means that double:0 should have a value equal to one of these

numbers and the registration code must contain a letter(s) for us to

pass __vbaBoolVarNull(). We also know that double:0 is zero when we only

entered letters. So the registration code must have some numbers and one

or more letters

</P>

<H3>step II </H3>

<P>

Start again (I know this begins to be boring but we are almost

finished). This time we must use systematical inputs. Lets begin with

123A and see what happens what value is given to double:0. Hmmn we

didn't pass the __vbaBoolVarNull() function with 123A. Well my

experience in registration codes tells me that the letter may be a

separator of two numbers. Lets try 123A123.</P>

<P>

Great (balls of fire) we passed the evil __vbaBoolVarNull(), lets find

out if double:0 has a value. Just click on one of the __vbaVarTestEq at

sequence# 14909 for example wich is the first one. As you'll see

double:0 has the value of 15129 and is therefore called double:15129

instead of double:0. How did it get that value?

<BR><BR>

14347	__vbaVarMull(variant:double:123, variant:double:123) returns dword

6FF714

<BR><BR>

Well 123*123=15129 and thats where double:15129 got it's value from. So

the form of the regisration code is #####X#####=Y where # is a number

and X is a letter and Y any of the valid numbers that our double:15129

is tested against. Lets pic one of the valid numbers and use them in our

code like this:

<BR><BR>

55276A1000 = 55276*1000 = 55276000

<BR><BR>

Since such a visual programmer is assumed to be a moron, he will 

probably only check

the five first numbers but hey, should he check all numbers we still

have the equation... so it would be really easy to solve it. 

But lets first try the

above to see how dumb such a "programmer" can be... 

Could you believe that? It worked at once! What a moron programmer! 

<BR><BR>

Numega deserves all credits for its Smartcheck, this is truly an amazing

tool. Thats it for now.

<BR><BR></P>

<I>Indian_Trail<BR><FONT color="red"> (Saddle all the horses far on the

Indian Trail, 'til it's time to change the key and jump to a different

scale...a boogie woogie on the

run)</I></FONT>                             

</PRE>

  </TD>

 </TR>



 <TR>

  <TD VALIGN="MIDDLE" BGCOLOR="00B645">

   <FONT SIZE="2">

    <CENTER>Ob duh</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">

   <I>I wont even bother explaining you 

   that you should BUY this target program if you intend to use it for a

longer

   period than the allowed one. Should you want 

   to STEAL this software instead, you don't need to crack its

protection 

   scheme at all: you'll 

   find it on most Warez sites, complete and already regged,

farewell.</I>

  </TD>

 </TR>



 <TR>

  <TD VALIGN="MIDDLE" BGCOLOR="2AB6B6">

   <FONT SIZE="2">

    <CENTER>Final Notes</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">

<!-- PASTE HERE YOUR FINAL NOTES (if any) -->

I don't know why one should choose visual basic to make an application

like this one. But this Author is probably just a greedy looser, who only want 

to make some fast money instead of taking pride in a good, lean and fast 

program.

</TD>

 </TR>

<TR>

  <TD VALIGN="MIDDLE" BGCOLOR="898030">

   <FONT SIZE="2" COLOR="FFFFFF">

    <CENTER>way out</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>



<A href="project8.htm" tppabs="http://www.anticrack.de/fravia/project8.htm"><IMG SRC="visualba.gif" tppabs="http://www.anticrack.de/fravia/visualba.gif" 

ALT="visual basic" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0

HSPACE=0></A>



<BR>







<FONT color=gray>Back to Visual Basic</FONT>



-->

<!--

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to

Your_chosen_project</A> 

-->

           <HR width=33%>







<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity</A> 



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN=BOTTOM



BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>



<BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering

legal?</A>

</CENTER>

  </TD>

 </TR>

</TABLE>

</BODY>

</HTML>

