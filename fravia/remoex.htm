<HTML>

<HEAD>

<TITLE>remoex.htm ~ Remote Explorer:  McAfee's selling trick or an interesting target?</TITLE>

</HEAD>



<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>



<CENTER><TABLE border= "2"><TR><TD bgcolor="#FFFFEA"><CENTER>

<H3>Remote Explorer:  McAfee's selling trick or an interesting target?</H3></CENTER></TD><TD width="114"><CENTER><A href="project9.htm" tppabs="http://www.anticrack.de/fravia/project9.htm">

<IMG SRC="project9.gif" tppabs="http://www.anticrack.de/fravia/project9.gif" ALT="M$bashing" ALIGN=BOTTOM WIDTH=114 

EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></A></CENTER></TD></TR></TABLE></CENTER>

<BR>Remote Explorer is this the virus to study?<BR>

<BR> The

"Remote Explorer" virus runs on Micro$oft Windoze NT servers and affects

common programs like Micro$oft Word. It cannot run on Windoze 9x because

this  virus/trojan runs as a "service", which is only possible if you 

are running Windoze NT as your op/sys and because Windows 9x lacks the 

RPC functions that allow it to spread to it in the first place. You can 

nevertheless have a file in win95 that's infected with the virus but 

it won't do any damage to your system.  Remote Explorer will only 

affect NT computers.

<BR><BR>

Users clicking on their Word icon

might experience a slight delay, but otherwise would be unable to detect the

presence of the virus; meanwhile, the virus is busy corrupting files and

spreading to other programs.  Micro$oft officials say they're "aware of

other viruses that have the same characteristics," and Network Associates

says it has developed a Remote Explorer detector and is working on a

solution to decode the affected files.  

<BR><BR>

    Remote Explorer. Here are the facts I found:<BR>

Discovered on December 17, 1998. Probably released by NAI (MacAffee) itself with 

the complicity of MCI, else 

heavily used by NAI to promote itself. <BR>

Primarily targets Microsoft Windows NT Servers and Workstation systems. 

The virus is memory resident, encrypts EXE, TXT, and HTML files. 

Spreads through a LAN/WAN environment. 



<BR><BR>

    Indications you are hosting the virus:<BR>

Open up the Services applet in the NT Control Panel. If you find 

"Remote Explorer" listed as a service, this system is infected. 

Through the Start Menu, run TASKMGR.EXE. When viewing the Processes tab, 

if IE403R.SYS or TASKMGR.SYS (not EXE) are listed as processes, the 

system is infected. 

<BR><BR>

Virus Characteristics<BR>

The most outstanding characteristics is that it can move/transport 

itself without typical user intervention (passed on floppy, via email) 

and replicate like a worm.<BR>

It is the first infection program that spreads on either NT Servers, 

and/or NT Workstations. It does so by compressing the target executable.

<BR> 

The virus installs itself on a system by creating a copy of itself in 

the NT Driver directory and calls itself IE403R.SYS. It also installs 

itself as a service with the name "Remote Explorer". It also carries a 

DLL that supports it in the infecting and encryption process. 

<BR>

If the DLL is deleted it will make another copy. <BR>

Remote Explorer spreads by stealing 

security privileges of the domain administrator, which allows it to 

propagate to other Windows systems. Once there it infects files and 

compresses them in addition to encrypting data on a random basis. 

<BR>

Windows NT is the primary method for the continued spread of this virus. 

Other Windows operating systems can host infected files, but the virus 

can not spread further on these platforms. <BR>

Can infect any EXE and when doing so uses a compression routine to 

make the file unusable. <BR>

It uses an encryption algorithm on data files including TXT and HTML 

formats. It appears to choose a directory randomly, and infects files 

that meets the criteria it has set, and encrypts others that it can't 

infect. <BR>

It is a 125-kilobyte file infector, comprised of approximately 50,000 

lines of code. This is an extremely large and complex virus.<BR> 

 This large virus has been written in Microsoft Visual

C++ and

 is about 125K.

<BR>The original virus code occupies about 14K

<BR>GZIP routines - 20K

<BR>C run-time libraries - 40K

<BR>Other data are occupied by

virus/C++ data,

 resources and so on<BR>

 The virus has quite an unusual structure: the infected files have

code and

 data segments, as well as three resources that contain compressed

 executable files. 

<BR><BR>

The first resource contains the standard NT4

PSAPI.DLL

 that is used by the virus to access processes in the system memory.

<BR><BR>

 The second resource is the original virus code itself (including the

same

 compressed PSAPI.DLL in the resource). This copy of virus code is

used as

 the original data to install the virus into the system and to infect

EXE

 files.

<BR><BR>

 The third resource is the host file that is extracted and

decompressed,

 when the virus needs to run the host program.

<BR><BR>

 System Registry: while installing its SYS driver to the system the

virus

 uses standard NT API calls. That cause the system to register the

virus

 drivers in the system registry - the

 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Remote Explorer

is sowith 

 created.

<BR><BR>

 Temporary files: while compressing/decompressing files the virus

needs to

 create temporary files. It creates them in the Windows temporary

directory

 with the random names ~xxxdddd.TMP (where 'x' - letters, 'd' -

digits).<BR><BR>

It goes Memory Resident. Thus the infected system must be powered down, 

and scanned from a "clean state" with a command line scanner (convenient 

courtesy of NAI 

itself :-)<BR> 

Detection and removal are  available<BR>



The virus has a time routine, which is designed to speed up the search 

and infection process.<BR>

 The virus infection, hiding and damage routines do work only in

non-working

 hours: full day on Sunday and Saturday, only from

21:00

 till 6:00 on other days. Otherwise the virus sets lowest priority

for

 itself, and "sleeps" for long periods of time. So the virus runs its

 routine in work-hours, but only in case nobody is accessing the

computer

 for the long time.<BR>



<BR>Hiding routine is run next to infection routine, and "cleans" virus

traces in

 the system. First of all it looks for the windows with "TASKMGR.SYS, 

 Application Error" and "Dr.Watson for Windows NT" titles and closes

them if needs be.<BR>

 So the virus bypasses the error messages caused by its bugs.

 The virus then checks if its driver "sleeps" for too long time (more

that

 one hour). In this case the virus kills the service.

<BR>

 The virus also deletes the DRWTSN32.LOG file as well as all "~*"

files in

 the Windows temporary directory.

<BR>

 NAI conveniently provided 

a program (late 12/21/98) that will removes it from memory 

without a reboot, removes the virus as a service, cleans and repairs 

the encrypted data files, and all infected executables. 

</PRE>

<BR>

There are now a couple of things that I must add... this whole story has some 

tracts of a typical urban legend/scam, made in order to sell 

NAI products (which are lousy to say the least, btw). Yet some 

of the descriptions I found seem to have a solid base.

<BR>Let's put some order in all this mess:<BR>

first of all 

the Remote Explorer virus seems to be extremely rare. Likelihood of 

infection seems to me therefore very low. 

<BR>At this time, only one company has 

been known to have been infected and I couldn't find the virus on 

any Internet sites, anti-virus ftps or hacker BBSs (and I know how to search 

the web)<BR> Es ist sure that McAfee over-hyped the panic 

for PR purposes.  They have always been very good at this.<BR>

I don't know if they went so far as to create it themselves (M$ C++? Mmmm... 

could be)<BR>I doubt that this virus  

has really escaped 'in the wild', but if it is, 

and if anyone of my readers gets 

his hands on a copy of it, we may try to reverse its code.<BR>

I have searched the web -until now in vain- and 

I'll keep trying.<BR>As soon as I catch or get a copy of Remote Explorer 

it I'll reverse it.<BR>

If anyone out there discovers a file called IE403R.SYS, having a

date/time stamp of 12/20/98-1:22:48am (EDT I believe), and a size of

125,440 bytes, please send me a copy. I'll publish the code as soon as

I have reversed it.<BR>

Yet many small things make me believe that this is only a silly 

McAfee's hype and a marketing trick... have a look at 

their disgusting banners at 

<A href="javascript:if(confirm('http://www.nai.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.nai.com/'" tppabs="http://www.nai.com/">http://www.nai.com/</A>...<BR>

The hyperbole that is oozing out of some corporation's marketing and PR

wings is getting pretty hard to take, and I believe we should begin 

to retaliate... a reason more to disassemble this virus... as you probably know, 

each programmer has his 'style' (even in overbloated M$ C++) and it 

should be possible to understand if really a 'disgruntled employee' at MCI 

or some of the guys at NAI has concocted this.<BR><BR>Some snippets from 

the wide web:<BR><BR>

Russ, the NTBugtraq moderator): 

<BR><FONT color=purple><PRE>

 I have been contacted by Intel, Panda Software, Symantec, and other

 private virus researchers hoping to get copies of the virus. NAI did not

 make the virus available to the anti-virus community until late this

 afternoon. A source told me that Microsoft were told they had to sign a

 non-disclosure agreement with NAI in order to get a copy of it

 themselves</FONT></PRE>

<BR>

ISS Security Advisory:

<FONT color=purple><PRE>

 There have been no confirmed reports of the virus existing

 outside of the original reporting site, with the exception of copies

 obtained by virus researchers.  There are indications that the original

 virus may have been installed by a disgruntled employee.

</FONT>

</PRE>

<BR>Sounds all pretty fishy from a reverser standpoint, yet 

some real experts on this field seem to believe that a limited 

number of copies may indeed 

have escaped 'in the wild'.

<BR>

Now, since NAI is clearly the real culprit of this situation 

and the only 

responsible of the possible spreading of this virus, and since 

our interest for this kind of virii in the context of our 

"Micro$oft bashing" campaign and our reversing capabilities

is obvious... our reversing deed 

would also hit NAI right on their heads... reversing code and at the same 

time reversing a marketing department trick... nice deed, wouldn't you say? 

Bye bye McAffee... eh?

<BR><BR>

So, go forth and catch it, friends NT-administrators!

<BR><HR width=44%>

Pattern files that will detect as clean the virus:<BR>

<A href="javascript:if(confirm('ftp://ftp.intel.com/pub/support/files/outgoing/vp30cs.zip  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='ftp://ftp.intel.com/pub/support/files/outgoing/vp30cs.zip'" tppabs="ftp://ftp.intel.com/pub/support/files/outgoing/vp30cs.zip">

ftp://ftp.intel.com/pub/support/files/outgoing/vp30cs.zip</A>

<BR>

<A href="javascript:if(confirm('ftp://ftp.intel.com/pub/support/files/outgoing/up484.zip  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='ftp://ftp.intel.com/pub/support/files/outgoing/up484.zip'" tppabs="ftp://ftp.intel.com/pub/support/files/outgoing/up484.zip">

ftp://ftp.intel.com/pub/support/files/outgoing/up484.zip</A>

<BR><BR><HR>

 Resume<BR>

 The virus is the first native "memory resident" NT infector, so it

might

 look as some super-virus. Actually the virus was written by some

 middle-level developer that has access to the NT

DeviceDevelopmentKit

 documentation.

 The virus does not hook any NT event, does not use any network

protocols,

 does not try to access the passwords, and spread its copy over the

global

 network. Moreover, the ordinary DOS parasitic viruses have the same

network

 spreading abilities like this virus has - they also can infect files

on

 remote shared drives, stays in the system memory, e.t.c.

<BR><BR>

 This is just a standard parasitic virus, but with NT service

infection

 ability. It is not more complex than some other already known

Windows

 viruses are, and definitely not more complex than the well-known BO

trojan

 (BackOrifice) from our CoDC friends...

<BR><BR>In conclusion 

 this virus is not a shock at all - it is the long awaited

WindowsNT-service

 virus. Let's catch it and reverse it!

<BR><BR>

<HR>Remember:<BR>

 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Remote Explorer

<HR><PRE>

For more information:



CERT(R) Incident Note IN-98-07 "Windows NT 'Remote Explorer' Virus" at

http://www.cert.org/incident_notes/IN-98-07.html



Central Command Antivirus Center "Antiviral Toolkit Pro (AVP)" at

http://www.avp.com (free detector-cleaner)



Data Fellows Computer Virus Information Pages for RemExp, also known as

Rich, Remote_Explorer, IE403R.SYS, RICHS at 

http://www.datafellows.com/v-descs/rich.htm



Microsoft Security Advisor "Information on the 'Remote Explorer' or

'RICHS' Virus" at http://www.microsoft.com/security/bulletins/remote.asp

<HR>