<HTML>

<HEAD>

<!--  formamus.htm version 02 February 1998 

      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

      SEARCH THIS TEXT FOR THE STRING "Your_" 

      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

      THANKS A LOT: this will allow automated retrieval -->

<TITLE>neto_03.htm HTMLPad: A nasty protection</TITLE>

</HEAD>



<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 

"100%  HEIGHT=" 22">

<TR><td></td>

<td>

<!-- Choose  a TITLE probably wont be changed -->

<center><FONT SIZE="+2">HTMLPad</fonT><br>

        <FONT SIZE="+1">A nasty protection</fonT>

</center>

</td>



<td>

<!-- Choose  a PROJECT GIF, leave this if unsure -->

<center><a href="protecti.htm" tppabs="http://www.anticrack.de/fravia/protecti.htm"><IMG SRC="protecti.gif" tppabs="http://www.anticrack.de/fravia/protecti.gif" 

ALT="our protections" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></a>

<br>

<font color=gray>Our Protections</FonT>

</center></td></tr>

<tR>

<td bgcolor="#FFFFEA"><center>

<FONT COLOR="890000">

<!-- CHOOSE A DATE (will probably be changed) -->

25 July 1998

</FONT></center>

</td>

<td bgcolor="#FFFFEA"><center>by <font size=+3>

<!-- CHOOSE A HANDLE (wont be changed) -->

Miguel Neto

</fonT></center>

</td>

<td VALIGN="center" bgcolor="#FFFFEA">

<!--

<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" 

ALIGN=BOTTOM 

WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

-->

</td>

</tr>

<TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" 

ALIGN="BOTTOM" 

BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>

<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 

reverse engineering</center> 

</center></TD>

<td BGCOLOR="898030">

<center>

<!-- Your truly+ will edit only if really necessary -->

slightly edited<br>

by fravia+</center></td>

</TR>

<!-- this is for the

data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->

<tr><td><font 

color="#C4C0CF">fra_00xx<bR>980725<br>MiguelNeto<br>0100<br>OP<br>PC<br

></fonT></td><td><i><center>

<font color=purple>"Sorry.  You'll have to crack

the code again.  In the mean

time you can fix the little

presents that are going to be left on

your machine!"</fonT><bR>Well, my first natural reaction, like that of Miguel Neto, 

was of anger against Intermania (Portland, Oregon) and its product (HTMLPad, version 2.6), yet, come to think of it inside the perspective of the 'larger scheme of things', this 

is actually not a bad idea at all 

for a (lame but working) protection scheme.<bR>In fact no 'real' cracker would 

have any difficulty in cracking any protection scheme, however complex, therefore 

concentrating on 'heavy' protection schemes does not 

make much sense. See: shareware authors are 

not loosing money because a couple of dozens of real crackers, out there, study (or even 

explain to other 'studiosi') their protection schemes, they are 

loosing money because million of morons, that would not 

understand what a byte is if it come out of the screen in order to bite them, use ready made patches (made by some 

real cracker of the darker side) in order to steal software. Therefore it makes A LOT of sense 

to concnetrate in punishing the lusers, since outsmarting the crackers is much too difficult for 

programmers that have drunk too much visual basic and too few assembly.<br>This 

kind of protection schemes (I have seen other on the same lines) are patently 

directed against 

all those morons that seek ready-made cracks and use them in order to steal targets 

<br>Anyway why should we care? We are NOT friends of the 

luser little thieves, are we? So I reckon that this is actually <u>a pretty good idea</u> and 

easy to implement: 1) Release your soft with 

dummy cracker/password couples and a simple protection scheme that is ready to wreak havoc inside 

the luser's machine.  

2) A couple of weeks later, if your soft is worth something (a very big if most of the time) you'll 

find a dozen of ready made cracks on any warez site. 3) Release a second version of your soft 

that has this time 'real' cracker/password couples and screw up the lusers' machines.

<br>Not bad: I like it!<br>(You may also find very useful -along similar protection lines- 

to read 

<a href="javascript:if(confirm('http://www.chocbar.demon.co.uk/ghiribizzo/ghiric31.pdf  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.chocbar.demon.co.uk/ghiribizzo/ghiric31.pdf'" tppabs="http://www.chocbar.demon.co.uk/ghiribizzo/ghiric31.pdf">Ghiribizzo's ideas</a> 

about a 'later implemented' part of the serial number).

<br>BTW: does really exist a 

cracker "thatguy"? Or did they mean 'thatdude'? Or did they purposely seed some ready made 

cracks with name 'thatguy'? Who knows?

</i></center></td>

<td></td>

</tr>

<TR><td></td>

<!-- Leonard Coehn's old song, because we are poets, not only crackers

-->

<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in 

everything 

That's how the light gets in</b></center>

<!-- Leonard Coehn's old song, because we are poets, not only crackers

-->

</center></TD><td></td>

</TR>

<TR>

<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

Rating</FONT></FONT></center>

</TD>

<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

<!-- CHOOSE A RATING (may be changed) -->

()<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> ( 

)<B>Expert</B></FONT>

</center></td>

<td></td>

</tr>

</table>

<!-- END HEAD  -->

<bR>

<!-- CORPUS  -->



<!-- CHOOSE A COMMENT (may be changed)  -->

This essay will show you how to deprotect HPAD, a nag and function

disabled 

protected program<hR>

<center>

   <FONT SIZE="+2">

<!-- CHOOSE A TITLE (wont probably be changed) -->

HTMLPad

   </FONT><BR>

   <FONT SIZE="+2">

<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->

A nasty protection

   </FONT><BR>

   <FONT COLOR="0B7FC1">

<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 

Miguel Neto

   </FONT>

</center><br><br>



<!-- INTRO STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 

"100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font 

color=blue>Introduction</fonT>

</fonT></center></td></tr></table>

<p>

Hi, it's me again. This protection is slightly more difficult than the

ones I 

tackled in my former essays, so, in order to spare you (and me) some

time, 

I'll try to avoid the usual jokes (fravia+ cuts most of them off anyway

:-)   <p>

The target you will need for this cracking session is called HTMLPad,

it is 

a nice web-design utility. Basically, it provides shortctus for the

HTML tags;

You have more control over the HTML code than if you used a standard

editor, but 

you don't loose as much time as if you wrote the code with UltraEdit. 



</p>



<!-- TOOLS STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 

"100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools 

required</fonT>

</fonT></center></td></tr></table>

Wdasm<br>Soft-Ice<br>Your Favourite HexEditor<!-- PASTE HERE YOUR 

REQUIRED TOOLS -->

<br><br>





<!-- REAL ESSAY  STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 

"100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font 

color=blue>Essay</fonT></fonT>

</center></td></tr></table>

<p>

First of all, install the target. Play with it a little. All done? ok.

If you've read, as you should, the help files, you will notice that we

already 

have this shareware limitations listed. Here is the snippet from that

file:

<bR>

<h3>HTMLpad Registration</h3>



<p>By purchasing HTMLpad and registering your copy, you will be

entitled to 

additional benefits such as:<br><br>



<ul> 



<li type="box">Not seeing the friendly shareware reminder message 

anymore.</li>

<li type="box">Unlock the Custom Update Stamp feature under the options 

dialog</li>

<li type="box">Automatic notification of updates and new releases</li>

<li type="box">Discounts on future releases</li>

<li type="box">Extended Technical Support</li>



</ul>

<pre>Our task will be to remove the first 2 limitations: the nag and the 

crippling lock.



The target's weak points, which you should be able to identify after playing 

a few minutes with this program, are the following:



1) The Option to Register

2) The "Registered to" String in the about box

3) The Nag Itself



Let's try to stalk the first one; 



Disassembling the target and searching for the invalid reg code

error message, you will land here (some code has been removed in 

order to spare you dw time:



:0046511E E8D1900000              call 0046E1F4

:00465123 3C01                    cmp al, 01

:00465125 7517                    jne 0046513E

(...)



* StringData Ref from Code Obj ->"Thank you for registering HTMLpad! "

                               ->"Keep the registration number in "

                               ->"a safe place in case you need "

                               ->"it at a later date."

                                  |

:00465132 B8E4514600              mov eax, 004651E4

:00465137 E8E484FDFF              call 0043D620

:0046513C EB1C                    jmp 0046515A



* Referenced by a  Jump at Address: 00465125(C)

|

:0046513E 8BC3                    mov eax, ebx

(..)

* StringData Ref from Code Obj ->"You have entered an invalid 

        			      "registration number."

                                  |

:00465150 B864524600              mov eax, 00465264



Bottom line, if after the call at 46511E al is 1 we are registered. 

Of course, if you nop the jne at 465125, you will get a thank you

message, but you will still be unregistered. But let's see where 

else is 46E1F4 called from...



* Referenced by a CALL at Addresses:004610C9, :00464D90, :0046511E, :00473294   

|

:0046E1F4 E803000000              call 0046E1FC

:0046E1F9 C3                      ret



I reckon that it is the first time that I see a call such as this one, 

but nevermind, let's go on. We must now inspect the locations that call

our 6E1F4... I didn't find the code at 610C9 very interesting, you can

and should check for yourself ofcourse... However, at 64D90 we see

this:



:00464D90 E85F940000              call 0046E1F4

:00464D95 84C0                    test al, al

:00464D97 745C                    je 00464DF5

(...)

* Possible StringData Ref from Code Obj ->"UNREGISTERED"

                                  |

:00464DF5 BA8C4E4600              mov edx, 00464E8C

 

If after the call, al is 0, we are REGISTERED TO UNREGISTERED.

Otherwise, the application will get our name from the registry (see 

your own dead listing, I didn't want to overcode this essay) and print 

it instead of UNREGISTERED. So, once again, if the al flag is 1, our 

reg code has been accepted and we will nolonger be "unregistered". But 

that is not all...

In Soft-Ice, set a breakpoint at 46E1F4. Now click on "About HTML PAD"

Soft-Ice will bang, confirming our speculations. 

Now click on Register. Soft-Ice pops up again.

Finally, click on Options (one of them was locked, remember?). Soft-Ice

will pop up once more. So, Now, if you change the instruction at 4610C9

from



call 46e1f4 



to, say



mov al, 00

inc al

jmp 46e1f9



You will take care of all of this target's limits *but* the nag. 



Why? Rememeber that I was surprised that all 6E1F4 did was to call

6E1FC? Why not call 46E1FC in the first place, thus saving a lot

of bytes? (Compiler constraints... you'll find the same pattern at 

73C3C, 7DF2C and 812D4 for instance) In anycase, this means that calling 

6E1F4 has exactly the same effect as calling 6E1FC; so maybe some 

limits call the latter instead of the former... Just to make sure, set

a breakpoint on 46E1FC in Soft-Ice. Now insert a few scripts (this will

make the nag appear). Bingo! Soft-Ice pops up! Press F12 and what do you

know...

Here is what you get:



:00480CEC E80BD5FEFF              call 0046E1FC

:00480CF1 84C0                    test al, al

:00480CF3 7507                    jne 00480CFC

  

You just have to change that jne to jmp and you will never see the nag

again.

However, that makes a lot of changes, and since the only thing that

matters is to get flag 1 at al at the end of the call, we might as 

well just patch the former. 

The boys at intermania have realised this: inside this huge call,

we can admire the following snippet:



* StringData Ref from Code Obj ->"thatguy"

                                  |

:0046E28D BA20E44600              mov edx, 0046E420

:0046E292 E8C959F9FF              call 00403C60

:0046E297 7528                    jne 0046E2C1

:0046E299 6A00                    push 00000000

:0046E29B 668B0D28E44600          mov cx, word ptr [0046E428]

:0046E2A2 B202                    mov dl, 02



* StringData Ref from Code Obj ->"Sorry.  You'll have to crack the "

                                        ->"code again.  In the mean time "

                                        ->"you can fix the little presents "

                                        ->"that are going to be left on your "

                                        ->"machine!"</PRE>



Pathetic! To put this at the sight of everyone TENTHS of bytes before

the end of the call, giving us all the room we want to patch. I suppose 

intermaniacs think they are funny... They are morons... I won't even

bother

to make fun of them, humour is a powerful weapon, but it can only hurt

those

who have a minimum sense of *pride*, which is not the case of the

Intermania 

programmers... You guys don't deserve my respect... Not knowing how to 

program is one thing, but trying to #$%&/!up my machine and NOT doing

it right is an insult to my intelligence... You can

thank the fact that +we are not crackers of the dark side, else you would be

bankrupt before you could say "censorship"!

<P>

Anyway, let's finish this:

<P>

Since the end of the call is as follows:<PRE>



:0046E3BC 8BC3                    mov eax, ebx

:0046E3BE 5E                      pop esi

:0046E3BF 5B                      pop ebx

:0046E3C0 8BE5                    mov esp, ebp

:0046E3C2 5D                      pop ebp

:0046E3C3 C3                      ret



Anyone that cares would just need to change



:0046E3BC 8BC3                    mov eax, ebx



to 



:0046E3BC B001                    mov al, 01</PRE>



And there you go, you are fully registered. Of course, if you want to be 

registered

with a chosen name (for instance 

'thatguy' :-) you have to first make these changes in memory just

before 

you enter

your chosen name and chosen bogus code, 

then close the program, patch it, and rerun. 

<BR>

Alternatively, of course, 

you could also make the changes later, directly inside 

the registry (the dead

listing will show 

you 

where :-)

<BR><BR>



<!-- FINAL NOTES STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 

"100%"  HEIGHT="22" >

<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Final 

Notes</FONT>

</FONT></CENTER></TD></TR></TABLE>



I hope all this didn't sound too confusing, if you have any doubts or

comments

please send them to <A HREF="mailto:"mneto@bigfoot.com"">mneto@bigfoot.com</A> (me)<!-- PASTE 

HERE YOUR FINAL NOTES (if any) -->

</PRE>

<BR><BR>



<!-- OB DUH STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 

"100%"  HEIGHT="22" >

<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Ob 

Duh</FONT></FONT>

</CENTER></TD></TR></TABLE>

 <CENTER>

   <I>I wont even bother explaining you 

   that you should BUY this target program if you intend to use it for

a longer 

   period than the allowed one. Should you want 

   to STEAL this software instead, you don't need to crack its

protection 

   scheme at all: you'll 

   find it on most Warez sites, complete and already regged (just watch it in this case :-)... 

farewell.</I>

</CENTER>



<!-- WAY OUT STARTS HERE -->

<HR>

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>

<!-- EITHER A NICE GIF LIKE THIS -->



<!-- 

<a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" 

ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 

VSPACE=0 HSPACE=0></a>

<br>

<font color=gray>Back to project 3</FonT>

<br><bR>

-->



<!-- OR JUST A LINK LIKE THIS -->



<!--

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to 

Your_chosen_project</A> 

<hr width=33%>

-->



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A 

HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' 

essays</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy 

database</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality 

cracking</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how to 

search</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript 

wars</A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity 

academy</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A 

HREF="ahref/index.html" tppabs="http://www.anticrack.de/fravia/ahref/index.html" http://fravia.org/ideale.htm">antismut CGI-scripts</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse 

engineering legal?</A>

</CENTER>

<hr>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

This page was last updated on 21-07-98 20:12 using <a href="javascript:if(confirm('http://www.intermania.com/htmlpad/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.intermania.com/htmlpad/'" tppabs="http://www.intermania.com/htmlpad/">HTMLpad</a>.

</BODY>

</HTML>"