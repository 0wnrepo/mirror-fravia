<html>
<head>
   <title>archim1.htm: Change a temporary file, InstallShield Demo 5.5</title>
</head>
<body TEXT="#001010" BGCOLOR="#C0C0C0" LINK="#0000EE" VLINK="#405040" ALINK="#FF0000">

<table BORDER="1" CELLSPACING="2" WIDTH="100%">
<caption></caption>

<tr>
<td></td>

<td><!-- Choose  a TITLE probably wont be changed -->
<center><font SIZE="+3">Change a temporary file</font></center>

<center><font SIZE="+3">InstallShield Demo 5.5</font></center>
</td>

<td><!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a HREF="javascript:if(confirm('http://fravia.org/student.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/student.htm#student_loo_na'" tppabs="http://fravia.org/student.htm#student_loo_na"><img SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif" ALT="student" BORDER="0" HEIGHT="43" WIDTH="114" ALIGN="CENTER"></a>&nbsp;</center>

<center><font COLOR="#808080">Not Assigned</font>&nbsp;</center>
</td>
</tr>

<tr>
<td BGCOLOR="#FFFFEA">
<center>27 May 1999</center>
</td>

<td BGCOLOR="#FFFFEA">
<center>by&nbsp;<!-- CHOOSE A HANDLE (wont be changed) --><font SIZE="+3">Archimede</font></center>
</td>

<td VALIGN="CENTER" BGCOLOR="#FFFFEA"><!--<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>--></td>
</tr>

<tr>
<td>
<center><a HREF="javascript:if(confirm('http://fravia.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/index.html'" tppabs="http://fravia.org/index.html"><img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" BORDER="0" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"></a></center>
</td>

<td BGCOLOR="#898030">
<center>Courtesy of Fravia's pages of reverse engineering</center>
</td>

<td BGCOLOR="#898030">
<center><!-- Your truly+ will edit only if really necessary -->slightly
edited</center>

<center>by fravia+</center>
</td>
</tr>

<tr>
<td><font COLOR="#C4C0CF">fra_00xx</font>&nbsp;
<br><font COLOR="#C4C0CF">980527</font>&nbsp;
<br><font COLOR="#C4C0CF">Archimede</font>&nbsp;
<br><font COLOR="#C4C0CF">1100</font>&nbsp;
<br><font COLOR="#C4C0CF">NA</font>&nbsp;
<br><font COLOR="#C4C0CF">PC</font></td>

<td>
<center><!-- Your truly+ comments --><i>Archimede's approach should be 
of some interest for all protectors and specifically for Bill, Eric and all 
other Installshield friends... 
I'm sure that the next &quot;demo&quot; version will be much better protected.<br>
 Sorry for the publishing delay, Archimede.<br> 
Your 'personal glory' (sort of :-) 
is assured. Good work: awaiting more. 
You drink a lot of beer, choose well: 
I suggest you to try 
Leffe Blonde, a very good and widespread beer that you should be able to find in 
Italy as well. I'm drinking 
one right now, eheh :-)</i></center>
</td>

<td></td>
</tr>

<tr>


<td><!-- Leonard Coehn's old song, because we are poets, not only crackers --></td>

<td BGCOLOR="#898030">
<center><b>There is a crack, a crack in everything That's how the light
gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers --></td>

<td></td>
</tr>

<tr>
<td VALIGN="CENTER" BGCOLOR="#C6E7C6">
<center><font COLOR="#0000FF">Rating</font></center>
</td>

<td VALIGN="CENTER" BGCOLOR="#C6E7C6">
<center><!-- CHOOSE A RATING (may be changed) --><font COLOR="#0000FF">(
)<b>Beginner</b> (x)<b>Intermediate</b> ( )<b>Advanced</b> ( )<b>Expert</b></font>&nbsp;</center>
</td>

<td></td>
</tr>
</table>
<!-- END HEAD  -->
<br><!-- CORPUS  --><!-- CHOOSE A COMMENT (may be changed)  -->Long time
since my last essay, but my english did not get better: I hope you'll understand
it anywise! I've found this program really interesting for me and for my
job, so I've decided to trasform it from a trial copy to a fully functional
tool, then, after having done it, I thought that the crack method and approach I used 
could be very helpfull for the
beginners and the protectors who peruse this site and ... here it is!
<br>
<hr>
<center><!-- CHOOSE A TITLE (wont probably be changed) --><font SIZE="+3">Reverse
engineering</font></center>

<center><font SIZE="+3">of</font></center>

<center><font SIZE="+3">InstallShield Eval/DemoVersion 5.5</font></center>

<center><!-- CHOOSE A SUBTITLE (wont proabbly be changed) --><font SIZE="+2">(Change
a temporary file)</font></center>

<center><!-- REPEAT YOUR CHOSEN HANDLE HERE --><font COLOR="#0B7FC1">Written
by Archimede</font></center>
&nbsp;

<p><!-- INTRO STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font SIZE="+2"><font COLOR="#0000FF">Introduction</font>&nbsp;</font></center>
</td>
</tr>
</table>
<font SIZE="+1">&nbsp;Hello guys, new (perhaps for me) protection scheme
and new crack. The idea of modify the temporary</font>
<br><font SIZE="+1">file, created during setup, 'on fly' was given to me
by +Xoanon (we are from the same country) when reading his essay about VBox
protection scheme. To obtain the final result you must change a lot of
bytes and overwrite an intere function in the original program, but after
that you can use the changed file for all the next installations you'll
ever want to make.&nbsp;&nbsp;&nbsp;&nbsp;</font>
<br><!-- PASTE HERE YOUR INTRODUCTION -->

<p><!-- TOOLS STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font SIZE="+2"><font COLOR="#0000FF">Tools required</font>&nbsp;</font></center>
</td>
</tr>
</table>
WDASM (ver 8.x)
<br>SoftICE (3.x)
<br>Hex editor
<br>Another computer
<br>Brain (a little)
<br>Luck (itís never too much)
<br><!-- PASTE HERE YOUR REQUIRED TOOLS -->

<p><!-- TARGET URL STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font SIZE="+2"><font COLOR="#0000FF">Target's URL/FTP</font>&nbsp;</font></center>
</td>
</tr>
</table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->You can
find it at <a HREF="javascript:if(confirm('http://mason.gmu.~rmcclana/windownload.zip  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://mason.gmu.~rmcclana/windownload.zip'" tppabs="http://mason.gmu.~rmcclana/windownload.zip">http://www.installshield.com</a>

<p><!-- PROGRAM HISTORY STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font SIZE="+2"><font COLOR="#0000FF">Program History</font>&nbsp;</font></center>
</td>
</tr>
</table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
<br>I never met this target before and so I don't know anything about
its previous protection schemes, anyway I will explain you its features:
<br>InstallShield allow you to create a professional&nbsp; procedure of
setup for your own program, and since it became soon the standard&nbsp;
in the windows software distribution, everyone has seen a program setup,
made with it, at least once.
<br>The Eval version (but I think they could call it Demo version) permit
to compile the files and to produce a full functional
 application but any setup built using this edition will only run on
the system on which it was developed.
<br>That's why, in order to reverse, you will need two setup programs, one 
built on your computer
and one built on another computer, with the same files but, obviously,
not allowed to work correctly.
<br>&nbsp;
<br><!-- REAL ESSAY  STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font COLOR="#0000FF"><font SIZE="+2">Essay</font></font>&nbsp;</center>
</td>
</tr>
</table>
<br>You got all with you? I mean: an iced bottle of your preferred beer,
a full box of cigarettes -if you smoke- and the tools required as described above? Ok! 
Follow me!

<p>First of all you have to produce two identical setup procedures (with
the same files), one on your computer and one on another one.
<br>So you obtain the same setup files stored in C:\My Installation\(Your
App)\Media\Default\Disk Image\Disk1 folder.
<br>Now you have to copy the files built by the second computer on your
PC in order to better follow the different behaviour
<br>of the two programs.
<br>If you start the protected copy by doubleclicking on the file <b><font SIZE="-1">SETUP.EXE
</font></b>yuo can see a message box which said more or less : 'You must
recompile the file <b><font SIZE="-1">SETUP.INS</font></b> with the professional
edition of the software.'
<br>A MessageBox ?!?!?!?!&nbsp; Nothing easier than breakpointing this
routine with SoftIce and watch in which file this function is called :
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<b>_INS5576!</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
??
<br>Where is this file ? Use the Windows find tool to see where it's stored.
But pay attention: if you push the <b><font SIZE="-1">OK</font></b> button
in the MessageBox the program go on and before quitting delete the file,
so perform the search before confirming the message and you'll find our
precious file in the <b>_istmp.dir</b> directory in C:\Windows\Temp with
other two files created temporary by the setup program.
<br>Save a copy on your hard drive and then let the setup program delete
it.

<p>-------------------------&nbsp;&nbsp;&nbsp; <b>Step One : Crack the
program</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------------

<p>OK ! If the file _ins5576._mp contains an executable code it must be
a file exe or a dll so we must try to change the extension
<br>and voila' the file _ins5576.exe is the right one (now you can see
the icon).
<br>In order to reach the exact snippet of code where the program execute
the protection routine we can use a very simple method: it's a 'dirty'
method not stilisticly correct and requires a little bit of&nbsp; 'handwork'.
Some +Cracker could twist his face but I often try to walk this street
before passing to a harder attack!

<p>Just after SoftIce popping out in the MessageBox API routine press <b><font SIZE="-1">F12
</font></b>( execute till first <b><font SIZE="-1">RET</font></b> instruction
).
<br>Set a breakpoint at the instruction just up (usually the call you are
returning from).Do it for three or four times (until you are in the file
_ins5576.).
<br>Here the occurence you must find:

<p><font SIZE="-1">Set a BP here ---&gt; 004394A0 call User32!MessageBox</font>
<br><font SIZE="-1">You ret here&nbsp; ---&gt;&nbsp; 004394A6 push 01</font>

<p>then <b><font SIZE="-1">F12</font></b>

<p><font SIZE="-1">Set a BP here ---&gt; 0043D4FA call 0043920E</font>
<br><font SIZE="-1">You ret here&nbsp; ---&gt;&nbsp; 0043D4FF push 01</font>

<p>then <b><font SIZE="-1">F12</font></b>

<p><font SIZE="-1">Set a BP here ---&gt; 0043B4B0 call 0043D497</font>
<br><font SIZE="-1">You ret here&nbsp; ---&gt;&nbsp; 0043B4B5 pop ecx</font>

<p>then <b><font SIZE="-1">F12</font></b>

<p><font SIZE="-1">Set a BP here ---&gt; 00437B99 call 0043B3A2</font>
<br><font SIZE="-1">You ret here&nbsp; ---&gt;&nbsp; 00437B9E mov [0048AAEC],
eax</font>
<br>&nbsp;
<br>Then let the program ends and execute the <b>good</b> version of <b>setup.exe.</b>
<br>It'll break where you have set the BP but obviously not all because
somewhere the execution of the program change is course and doesn't pass
trought the bad way! Is it all clear ?
<br>If not, take a look at my previos essay where I explain better this
method: <font SIZE="-1"><a HREF="javascript:if(confirm('http://208.233.94.170/fravia/fravia.org/new_archi.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://208.233.94.170/fravia/fravia.org/new_archi.htm'" tppabs="http://208.233.94.170/fravia/fravia.org/new_archi.htm">WindownloadCrack</a></font>

<p>I'm finishing my cigarettes... and so my beer! ( I'd better correct
my english tomorrow morning).

<p>Ok If all were well done the ICE will pop up only one time at:&nbsp;
<font SIZE="-1">00437B99 </font>Call <font SIZE="-1">0043B3A2</font>
<br>It means that between this address and the next breakpoint the program
should have met there is the protection routine. So reload and run the
<b>good</b> version of <b>setup.exe</b> and after the first breakpoint
(00437B99) step through the code and take note of every conditional jump
you meet (<b><font SIZE="-1">JZ,JE,JNZ</font></b>...etc.) and what the program
does (if he jumps or not). I've found this:

<p>Address:&nbsp;&nbsp;&nbsp;&nbsp; Instr.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Jump or not
<br>.......
<br><b><font SIZE="-1">43B3C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Y</font></b>
<br><b><font SIZE="-1">43B3F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Y</font></b>
<br><b><font SIZE="-1">43B413&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Y</font></b>
<br><b><font SIZE="-1">43B445&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Y</font></b>
<br><b><font SIZE="-1">43B498&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
N</font></b>
<br><b><font SIZE="-1">43B4A1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Y</font></b>
<br><b><font SIZE="-1">43B505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Y</font></b>
<br>..... and more.

<p>Ok repeat the same operation with the <b>bad</b> version and look:

<p>All the same behavior till the address: <b><font SIZE="-1">0043B4A1</font></b>
where the program doesn't jump.
<br>Before executing the instruction change the result of the test eax,eax
by digit on softice command <b><font SIZE="-1">R FL Z, </font></b>that change
the flag
<br>on which depend the action of the <b><font SIZE="-1">JNZ</font></b>,
and release the program (<b><font SIZE="-1">Ctrl+D</font></b>).
<br>That's ok! The program works fine even if you use the protected version
of it!
<br>Nothing very new in this crack but now we have to keep it permanent.

<p>------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>Step two : Change
a temporary file</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------------------------

<p>First of all I need another beer (I'm not an alcholist but sometimes
I like to spend the night in front of a computer and drink
<br>something tasting bitter.)

<p>Ok! Let's go.We need to know how the setup program (setup.exe is the
program is executed for first) call the code in the
<br>file _ins5576._mp after creating it.
<br>Use <b><font SIZE="-1">WDASM</font></b> to disassemble it and look for
some Windows routine a program can use to launch a file or a trhead like
<br><b><font SIZE="-1">CREATEPROCESS </font></b>or <b><font SIZE="-1">CREATETHREAD</font></b>
or ...
<br>The <b><font SIZE="-1">WINEXEC </font></b>function captured my attention
(a little luck and a little experience) and so I decided to breakpoint
it and ran the program.
<br>When ICE pops up I returned from the routine and set a BP just at the
address of the call, in order to stop the program before the call was made
and restart the program once again.
<br>I made it in order to know which value is stored in <b><font SIZE="-1">EAX&nbsp;
</font></b>just before the call, because this register point to the name
of the file that will be executed.
<br>Yes ! Here we are ! But now we have another problem because the files
aren't load into the memory, yet! So we can't change
<br>a memory location and we must step into the file on the hard drive
after his creation and before his execution.
<br>First of all we need to find a snippet of code in the file <b><font SIZE="-1">SETUP.EXE</font></b>
to overwrite and then write the code that opens the file and makes the
change.
<br>1.- Look at the imported function called <b><font SIZE="-1">VERSION.VerLanguageNameA
</font></b>and try to breakpoint it, then run the good application
<br>and wait... nothing breaks. That's good. This function can be overwritten
without compromising the correct progress of the application.
<br>2.- Here the code:
<br>:<font SIZE="-1">004025F0 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
save the value (it point to the file name)</font>
<br><font SIZE="-1">:004025F1 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor edi, edi</font>
<br><font SIZE="-1">:004025F3 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push the parameter for the routine</font>
<br><font SIZE="-1">:004025F4 6880000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000080&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open if
exist</font>
<br><font SIZE="-1">:004025F9 6A03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; file attributes</font>
<br><font SIZE="-1">:004025FB 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;</font>
<br><font SIZE="-1">:004025FC 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;</font>
<br><font SIZE="-1">:004025FD 6800000040&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 40000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open in
GENERIC_WRITE mode</font>
<br><font SIZE="-1">:00402602 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font SIZE="-1">use the
filename pointer just ready</font>
<br><b><font SIZE="-1">* Reference To: KERNEL32.CreateFileA, Ord:0031h</font></b>
<br><b><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</font></b>
<br><font SIZE="-1">:00402603 FF15E4D04000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Call dword ptr [0040D0E4]</font>
<br><font SIZE="-1">:00402609 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
save the Handle of the file returned from CreateFile</font>
<br><font SIZE="-1">:0040260A 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
again</font>
<br><font SIZE="-1">:0040260B 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push the parameter for the routine</font>
<br><font SIZE="-1">:0040260C 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;</font>
<br><font SIZE="-1">:0040260D 689FA80300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0003A89F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
this is the file position where you' ll make your change</font>
<br><font SIZE="-1">:00402612 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
the Handle of the file</font>
<br><b><font SIZE="-1">* Reference To: KERNEL32.SetFilePointer, Ord:0219h</font></b>
<br><b><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</font></b>
<br><font SIZE="-1">:00402613 FF15A4D04000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Call dword ptr [0040D0A4]</font>
<br><font SIZE="-1">:00402619 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retrieve the Hanlde of the file</font>
<br><font SIZE="-1">:0040261A 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
parameters...</font>
<br><font SIZE="-1">:0040261B BF9C274100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov edi, 0041279C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font SIZE="-1">generic pointer in the file data location&nbsp; (I decided
to use this location</font>
<br><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
because all the other </font><b><font SIZE="-2">WINEXEC</font></b><font SIZE="-1">
function in the <b>Setup.exe</b> file use it)</font>
<br><font SIZE="-1">:00402620 C70700000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], 00000000</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<font SIZE="-1">(better if&nbsp; zero)</font>
<br><font SIZE="-1">:00402626 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
...</font>
<br><font SIZE="-1">:00402627 6A02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
number of byte to write</font>
<br><font SIZE="-1">:00402629 6842264000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00402642&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
point to the two byte to write</font>
<br><font SIZE="-1">:0040262E 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
...</font>
<br><b><font SIZE="-1">* Reference To: KERNEL32.WriteFile, Ord:027Bh</font></b>
<br><b><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</font></b>
<br><font SIZE="-1">:0040262F FF158CD04000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Call dword ptr [0040D08C]</font>
<br><b><font SIZE="-1">* Reference To: KERNEL32.CloseHandle, Ord:0018h</font></b>
<br><b><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</font></b>
<br><font SIZE="-1">:00402635 FF15F0D04000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Call dword ptr [0040D0F0]</font>
<br><font SIZE="-1">:0040263B 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retrive the pointer of the file name we have saved at the begin</font>
<br><font SIZE="-1">:0040263C 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This istruction was overwritten
changing the call to Winexec&nbsp;&nbsp;&nbsp;&nbsp; ( see below )</font>
<br><font SIZE="-1">:0040263E 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
This istruction was overwritten changing the call to Winexec</font>
<br><font SIZE="-1">:0040263F FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
This istruction was overwritten changing the call to Winexec</font>
<br><font SIZE="-1">:00402641 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</font>
<br><font SIZE="-1">:00402642 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
The two value to change into the file</font>
<br><font SIZE="-1">:00402643 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nop</font>
<br><font SIZE="-1">:00402644 ??&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
???</font>
<br><font SIZE="-1">:00402645 ??&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
???</font>
<br><font SIZE="-1">:00402646 ??&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
???</font>

<p>This function change the <b><font SIZE="-1">TEST EAX,EAX</font></b> instruction
before the <b><font SIZE="-1">JNZ</font></b> conditional jump at <b><font SIZE="-1">43B4A1</font></b>
like this:
<br>&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>
inc eax</b>
<br><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nop</b>

<p>That's all! We are at the end of our work!
<br>No sorry, I've forgot a very important thing to do:
<br>We must change the program before it calls the <b><font SIZE="-1">WINEXEC</font></b>
routine in order to execute our own code.
<br>So the following:

<p><b><font SIZE="-1">* Reference To: KERNEL32.WinExec, Ord:026Fh</font></b>
<br><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</font>
<br><font SIZE="-1">:00405876 8B350CD14000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, dword ptr [0040D10C]</font>
<br><font SIZE="-1">:0040587C 8D85F8FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea eax, dword ptr [ebp+FEF8]</font>
<br><font SIZE="-1">:00405882 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001</font>
<br><font SIZE="-1">:00405884 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax</font>
<br><font SIZE="-1">:00405885 FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call esi</font>

<p>&nbsp;must be changed like this:

<p><b><font SIZE="-1">* Reference To: KERNEL32.WinExec, Ord:026Fh</font></b>
<br><font SIZE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</font>
<br><font SIZE="-1">:00405876 8B350CD14000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, dword ptr [0040D10C]</font>
<br><font SIZE="-1">:0040587C 8D85F8FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea eax, dword ptr [ebp+FEF8]</font>
<br><font SIZE="-1">:00405882 E869CDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 004025F0</font>

<p>You must overwrite also the two pushing instruction but it's enaugh
to put them at the end of our routine.
<br>Thank for your attention and your patience.
<br>&nbsp;

<p><!-- FINAL NOTES STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font SIZE="+2"><font COLOR="#0000FF">Final Notes</font>&nbsp;</font></center>
</td>
</tr>
</table>
<font SIZE="+1">Thatís all folks !</font>
<br><font SIZE="+1">This is not a difficult crack but it's very long to do
and a little bit boring!</font>
<br><font SIZE="+1">Don't be afraid 'cause once you have prepared a setup
file cracked like this you can save it in the</font>
<br>InstallShield\InstallShild 5.5 Professional Edition\Redistributable\Uncompressed
Files\Language Indipendent\Intel32<font SIZE="+1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and</font>
<br>InstallShield\InstallShild 5.5 Professional Edition\General Data\Blank
Setup\Media\Default\Disk Images\Disk1
<br><font SIZE="+1">directory and the program will put your modified program
on every new setup it'll create.</font>

<p>&nbsp;<!-- PASTE HERE YOUR FINAL NOTES (if any) -->

<p><!-- OB DUH STARTS HERE -->
<table BORDER CELLSPACING="2" WIDTH="100%" HEIGHT="22">
<tr>
<td BGCOLOR="#C6E7C6">
<center><font COLOR="#0000FF"><font SIZE="+2">Ob Duh</font></font>&nbsp;</center>
</td>
</tr>
</table>

<center><i>I wont even bother explaining you that you should BUY this target
program if you intend to use it for a longer period than the allowed one.
Should you want to STEAL this software instead, you don't need to crack
its protection scheme at all: you'll find it on most Warez sites, complete
and already regged, farewell.</i></center>
<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside fravia's page of reverse engineering, choose
your way out:</i></center>

<center><!-- EITHER A NICE GIF LIKE THIS --><!-- <a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>Back to project 3</FonT><br><bR>--><!-- OR JUST A LINK LIKE THIS --><!--<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to Your_chosen_project</A> <hr width=33%>--><img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/index.html'" tppabs="http://fravia.org/index.html">homepage</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/links.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/links.htm'" tppabs="http://fravia.org/links.htm">links</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/searengi.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/searengi.htm'" tppabs="http://fravia.org/searengi.htm">search_forms</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/orc.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/orc.htm'" tppabs="http://fravia.org/orc.htm">+ORC</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/student.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/student.htm'" tppabs="http://fravia.org/student.htm">students'
essays</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/academy.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/academy.htm'" tppabs="http://fravia.org/academy.htm">academy
database</a></center>

<center><img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/realicra.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/realicra.htm'" tppabs="http://fravia.org/realicra.htm">reality
cracking</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/howtosea.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/howtosea.htm'" tppabs="http://fravia.org/howtosea.htm">how
to search</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/javascri.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/javascri.htm'" tppabs="http://fravia.org/javascri.htm">java-script
wars</a></center>

<center><img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/tools.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tools.htm'" tppabs="http://fravia.org/tools.htm">tools</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/noanon.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/noanon.htm'" tppabs="http://fravia.org/noanon.htm">anonymity
academy</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/cocktail.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/cocktail.htm'" tppabs="http://fravia.org/cocktail.htm">cocktails</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/ideale.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/ideale.htm'" tppabs="http://fravia.org/ideale.htm">antismut
CGI-scripts</a>&nbsp;<img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/info.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/info.htm'" tppabs="http://fravia.org/info.htm">mail_fravia+</a></center>

<center><img SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" HEIGHT="13" WIDTH="13" ALIGN="BOTTOM"><a HREF="javascript:if(confirm('http://fravia.org/legal.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/legal.htm'" tppabs="http://fravia.org/legal.htm">Is
reverse engineering legal?</a></center>

<hr><center>
&quot;<font color="blue">Copy-protection schemes</font>&quot;: elegant devices for training the next generation of
assembly-language programmers
</center><hr>
</body>
</html>