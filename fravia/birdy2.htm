<HTML>

<HEAD>

  <META NAME="GENERATOR" CONTENT="Photoshop Filter Hacking">

  <TITLE>birdy2</TITLE>

</HEAD>

<BODY TEXT="#001010" VLINK="#405040">



<P><CENTER><FONT SIZE="+4">SOFTICE NT - PHASE 9<BR>

</FONT><FONT SIZE="+2">Some explanations</FONT>

<BR>

</CENTER>



<H4><CENTER><I>by Birdy Harry</I><BR>

(06 August 1997, slightly edited by Fravia)</CENTER></H4>



<CENTER><HR><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> Courtesy of Fravia's page of reverse engineering<BR>

<HR> <I>Well, never sell a bear until you have killed it... here you go with some more 

Winice NT precisations... hey, I like it... crackers are precise and determined people... 

d'you agree?<BR>This is actually NOT an essay...it's a letter, but it is nevertheless important 

for Winice cracking, and if you have been hooked on this protection scheme as much as I have

 been, you'll enjoy this letter just like any other essay on this subject... a little cryptic it 

 is, I have to admit, though... here you go!</I></CENTER><HR><PRE>



Dear Fravia+,

Looking through your pages I found an interesting comment from Squirlle

and would like to add some (hopefully) helpful hints. Also, I really

appreciated if Squirlle would email me and be more precise on which

difficulties he encountered, because as for now I have to guess them&nbsp;

a bit. I don't have his email adress too, so I'm posting this request&nbsp;

to you.





&gt;I got lots of errors and even after I found out about the need for

&gt;certain visual c++ libraries to follow phase 4.



So the problems began already in phase 4?&nbsp;

The same happened to me, believe me.&nbsp;

Maybe Ignoramus has got the same environmental dlls in his .\system32&nbsp;

folder as I do and just forgot to mention it.&nbsp;

Look... for example... most crackers are coders as well, so I would't&nbsp;

wonder if he had VC++ which brings along all the debug dlls for Windows NT!&nbsp;

If so, I apologize for having not mentioned it.



&gt;Since I could not

&gt;load pnpisa.sys as described (error requesting some debug data)



(This is a very important, unique and advantageous ability of NT and so

I'll talk <U>in pictures</U> now for chrissake! This <U>has</U> to go work!)



Now consider the following applet in your &quot;Control&quot; folder (look at the

caption and you'll understand why sometimes &quot;my&quot; names may not coincide

with yours =D):



<IMG SRC="image3KM.JPG" tppabs="http://www.anticrack.de/fravia/image3KM.JPG" HEIGHT="225" WIDTH="200">



By double-clicking it you get into

<IMG SRC="imageN2P.JPG" tppabs="http://www.anticrack.de/fravia/imageN2P.JPG" HEIGHT="233" WIDTH="438">

Now look at the name! &quot;PnP ISA Enabler Driver&quot; or shortly PNPISA.SYS!!!





Sometimes, I admit, you may have to guess a little the correct file name

itself... in order to rename your target to it. This happens because the&nbsp;

line in this window will stay the same no matter the real file, that is,</PRE>

<PRE>it is not rechecked. But looking into .\System32\Drivers\ this shouldn't</PRE>

<PRE>be too hard.&nbsp;

Again, this is system level business... therefore be careful!





This was the meaning of the other tip: If you experiment with these with

NT on an NTFS partition (as I always would recommend it), have another NT

installation onto another FAT partition! Because only then you can

exchange the faked ones with the real drivers... if you messed up somehow&nbsp;

and erratically rebooted!





You can determine the usage of this driver mainly by looking at the

column in the middle - it says &quot;not used&quot;! This happens because if it was&nbsp;

there would be a notion &quot;Gestartet&quot; or maybe &quot;started&quot; (in the american</PRE>

<PRE>language NT version).&nbsp;

By the way, another driver suitable for our fake replacement would be the

&quot;Pcmcia&quot; on top of PnPISA or the &quot;PCIDump&quot; driver, because NT has not actually

loaded them - *it only tried to do it at system level... (blue screen)*.





To make it clear: &quot;It is completely sausage&quot;, as another of these nice

german phrases goes, which driver you use as long as



&nbsp;&nbsp; * it is listed here and

&nbsp;&nbsp; * it is not used. Especially be careful about this one!



Now, for further information, look at &quot;Startart&quot; or let's make it easy,

the fourth button from top of the DialogBox above. You now have a look</PRE>

<PRE>at the *level* at which the highlighted driver is started. And, of course,</PRE>

<PRE>there are radio buttons, thus you can even change its startup behaviour:

<IMG SRC="imagePKN.JPG" tppabs="http://www.anticrack.de/fravia/imagePKN.JPG" HEIGHT="199" WIDTH="300">





This just is the way the startup mode of WinICE is adjusted (you know:&nbsp;

the Startup Mode Setup). You can do this task much faster this way and  

you don't even get the CleanSweep SmartSweep popup window popping up...

where you may digit the &quot;new installation&quot; a name (as you can see I'm&nbsp;

not in &quot;cracking mode&quot; at the moment =):

<IMG SRC="imageG78.JPG" tppabs="http://www.anticrack.de/fravia/imageG78.JPG" HEIGHT="199" WIDTH="300">





Is that chapter all clear now?

I don't have to mention that the appropriate drivers have to be backed

up in order to restore the system later on, do I?





&gt;I could not get the new checksum.

Chile didn't I tell that you have to use HIEW 5.60 or above? This is

because of the maximum length of the checksum in earlier HIEWs, it was

WORD only, whereas now it is DWORD, which is what we need. I'm telling

you: Hit F8 in HIEW...



&gt;I did some searching on the net and found a helpful news

&gt;article describing how to AUTOMATICALLY change the checksum.

&gt;Simple (although not as instructive, it WORKS) use vc++ editbin.exe

&gt;as follows:&nbsp; editbin /release&nbsp;&nbsp; That's it.



It is the &quot;MSVC COFF binary file editor&quot; -- this is real smart trick,

congratulations! I tested it with a copy of 4NT:





Looking before there was no checksum at all. Then



EDITBIN 4NT.EXE /RELEASE



and looking again. Phew -- A checksum there!!!



Of course it is done right the same way (same algorithm, that is) as it is 

done by NTOSKRNL.EXE, cause both EDITBIN and NTOSKRNL are M$ products; as we 

all know, they hardly change something they got running once =D, e.g. if you 

look at the CD serial number check routine of NT setup and Office setup and 

MSVC setup you will come to see that the total of the digits after the &quot;-&quot; 

always is 14(decimal), let's say &quot;040-2025104&quot;. The three digit number before 

the &quot;-&quot; can be 038, 040 (just add an item :)<BR><BR>



So I'm impressed! But the goal was also: reverse engineering. It was much 

more instructive for me to crawl into the guts of NT and find the sucka my 

way (sorry... I should have said &quot;Ignoramus' way&quot; ;-).<BR>

This was indeed a real challenge, then.<BR>

&gt;NT is not an easy thing to understand without some good training!<BR>

Nobody would doubt it. But if a cracker does not understand it, who else ever will =) ?

<BR><BR>

And by the way what I had to fight more than NT was the win95 OS -- 

<FONT COLOR="#000000">&quot;Sinnlos 95&quot;</FONT> it's called in germany, this 

notion means &quot;without purpose&quot; =D<BR><BR> 

<FONT color="green">

(c) Birdy Harry, 1997. All rights reserved.</FONT>

 </PRE>

		<HR size="2">

<CENTER><I>You are deep inside fravia's page of reverse

engineering, choose your way out:</CENTER>





<P><CENTER><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="tppmsgs/msgs0.htm#84" tppabs="http://www.anticrack.de/fravia/tppmsgs/msgs0.htm#84">homepage </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> <A HREF="tppmsgs/msgs0.htm#73" tppabs="http://www.anticrack.de/fravia/tppmsgs/msgs0.htm#73">links

</A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0" NATURALSIZEFLAG="0"> <A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity

</A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="tppmsgs/msgs0.htm#82" tppabs="http://www.anticrack.de/fravia/tppmsgs/msgs0.htm#82">students' essays </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools

</A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails </A><BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mailFraVia

</A><BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">is reverse engineering legal? </A></FONT></CENTER></P>



<P><CENTER><FONT SIZE="-1"><HR></FONT></CENTER>

</BODY>

</HTML>



The &quot;save as&quot; function is called at startup and at shutdown of the

program, but honestly, I dunno why.



greetz,

Birdy Harry

</PRE>

