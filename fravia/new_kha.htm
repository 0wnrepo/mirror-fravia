<HTML>

<HEAD>

   <TITLE>new_kha.htm NJWIN Crack</TITLE>

<!--  formamus.htm version 02 February 1998 



      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!



      SEARCH THIS TEXT FOR THE STRING "Your_" 



      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 



      THANKS A LOT: this will allow automated retrieval -->

</HEAD>

<BODY TEXT="#001010" BGCOLOR="#C0C0C0" VLINK="#405040">

&nbsp;

<TABLE BORDER CELLSPACING=2 WIDTH="100%" 22" >

<CAPTION><!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... --></CAPTION>



<TR>

<TD></TD>



<TD><!-- Choose  a TITLE probably wont be changed -->

<CENTER><FONT SIZE=+2>BEGINNERS: NJWin 1.6 Checksum Cracking</FONT></CENTER>



<CENTER><FONT SIZE=+1>(Good protection with file checksum and self destruction)</FONT></CENTER>

</TD>



<TD><!-- Choose  a PROJECT GIF, leave this if unsure -->

<CENTER><A HREF="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif" ALT="student" BORDER=0 HEIGHT=43 WIDTH=114 ALIGN=CENTER></A>&nbsp;</CENTER>



<CENTER><FONT COLOR="#808080">Not Assigned</FONT>&nbsp;</CENTER>

</TD>

</TR>



<TR>

<TD BGCOLOR="#FFFFEA">

<CENTER><!-- CHOOSE A DATE (will probably be changed) --><FONT COLOR="#890000">23

April 1998&nbsp;</FONT></CENTER>

</TD>



<TD BGCOLOR="#FFFFEA">

<CENTER>by&nbsp;<!-- CHOOSE A HANDLE (wont be changed) --><FONT SIZE=+3>Kabhoet&nbsp;</FONT></CENTER>

</TD>



<TD VALIGN=CENTER BGCOLOR="#FFFFEA"><!--



<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 



WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>



--></TD>

</TR>



<TR>

<TD>

<CENTER><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" BORDER=0  ALIGN=BOTTOM width="13" height="13"></A></CENTER>

</TD>



<TD BGCOLOR="#898030">

<CENTER>Courtesy of Fravia's page of reverse engineering</CENTER>

</TD>



<TD BGCOLOR="#898030">

<CENTER>slightly edited by fravia+</center>

</TD>

</TR>



<TR>

<TD><FONT COLOR="#C4C0CF">fra_00xx</FONT>&nbsp;

<BR><FONT COLOR="#C4C0CF">98xxxx</FONT>&nbsp;

<BR><FONT COLOR="#C4C0CF">handle</FONT>&nbsp;

<BR><FONT COLOR="#C4C0CF">1100</FONT>&nbsp;

<BR><FONT COLOR="#C4C0CF">NA</FONT>&nbsp;

<BR><FONT COLOR="#C4C0CF">PC</FONT></TD>



<TD>

<CENTER>I didn't edit much this essay. The text is easy to follow, notwithstanding the 

many errors, and will give you, I believe, not only 

an idea, but the real FEELING of having many (capable) 

friends that come from some far far away places, like our new contributor Kabhoet, here, that 

will show you how to patch black and blue a 'self-destroying' protection scheme.<br>

Enjoy!</CENTER>

</TD>



<TD></TD>

</TR>



<TR>

<TD></TD>



<TD BGCOLOR="#898030"><!-- Leonard Coehn's old song, because we are poets, not only crackers --><B>There

is a crack, a crack in everything That's how the light gets in</B></TD>



<TD><!-- Leonard Coehn's old song, because we are poets, not only crackers --></TD>

</TR>



<TR>

<TD VALIGN=CENTER BGCOLOR="#C6E7C6">

<CENTER><FONT COLOR="#0000FF">Rating</FONT></CENTER>

</TD>



<TD VALIGN=CENTER BGCOLOR="#C6E7C6">

<CENTER><!-- CHOOSE A RATING (may be changed) --><FONT COLOR="#0000FF">(x)<B>Beginner</B>

( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>&nbsp;</CENTER>

</TD>



<TD></TD>

</TR>

</TABLE>

<!-- END HEAD  -->

<BR><!-- CORPUS  --><!-- CHOOSE A COMMENT (may be changed)  -->An useful

essay for everyone, because I don't know the rating of this kind program

protection.

<BR>Assume that everyone who read this know very basic of softice, w32dasm

and of course assembly language.

<BR>

<HR>

<CENTER><!-- CHOOSE A TITLE (wont probably be changed) --><FONT SIZE=+2>Good

protection,</FONT></CENTER>



<CENTER><!-- CHOOSE A SUBTITLE (wont proabbly be changed) --><FONT SIZE=+2>But

has a weakness</FONT></CENTER>



<CENTER><!-- REPEAT YOUR CHOSEN HANDLE HERE --><FONT COLOR="#0B7FC1">Written

by Kabhoet</FONT></CENTER>

&nbsp;



<P><!-- INTRO STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT SIZE=+2><FONT COLOR="#0000FF">Introduction</FONT>&nbsp;</FONT></CENTER>

</TD>

</TR>

</TABLE>



<PRE><!-- PASTE HERE YOUR INTRODUCTION --></PRE>

Actually I got this program from my friends. They said this target has a very

strange habit. They put the registration number correctly but when

exiting from the program and getting into it again, always got message 

"This is shareware

version and bla...bla...bla". Hmmm, seems that the guys in NJWIN try

to challenge us crackers. So....Let's play the game.



<P><!-- TOOLS STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT SIZE=+2><FONT COLOR="#0000FF">Tools required</FONT>&nbsp;</FONT></CENTER>

</TD>

</TR>

</TABLE>

- Soft Ice

<BR>- W32Dasm

<BR>- HIEW(Hacker View) make a patch.<!-- PASTE HERE YOUR REQUIRED TOOLS -->



<P><!-- TARGET URL STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT SIZE=+2><FONT COLOR="#0000FF">Target's URL/FTP</FONT>&nbsp;</FONT></CENTER>

</TD>

</TR>

</TABLE>

<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) --><A HREF="javascript:if(confirm('http://www.njstar.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.njstar.com/'" tppabs="http://www.njstar.com/">NJWIN

1.6</A>, get it now !!!!! You wont regret, because it is a very useful program. 

Of course you should pay for it if you really use it.



<P><!-- PROGRAM HISTORY STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT SIZE=+2><FONT COLOR="#0000FF">Program History</FONT>&nbsp;</FONT></CENTER>

</TD>

</TR>

</TABLE>

<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->NJWIN enables any application

to view Chinese, Japanese and Korean text on web pages and email. Features: 

auto code detection and user friendly interface. v1.60 supports Netscape&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Communicator 4.0,&nbsp; Internet&nbsp; Explorer 4.0, and Office 97. and

bla,bla,bla.



<P><!-- REAL ESSAY  STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Essay</FONT></FONT>&nbsp;</CENTER>

</TD>

</TR>

</TABLE>

<BR>First thing we should know is that this program always perform checksum

when we close the program. Even if only 1 char in the program changes, this

target will harakiri (it means delete itself). Wow, a very clever program,

isn't it? So we should perform TWO steps to defeat the program.



<P><B><U>First Step : Disable the self destruction.</U></B>

<BR>Launch the w32dasm and dissamble the file (NJWIN.EXE). Hmmm, this

is seem a 16 bit program and you will get a little difficult to crack it.

So we need some help from soft ice. First we should add EXP=C:\WINDOWS\SYSTEM\KERNEL32.DLL

at WINICE.DAT. If not softice won't find the simbols. Now make a copy

of njwin.exe eg. nj1.exe and use an hex editor to change something in nj1.exe.

Launch nj1.exe and you will get njwin menu at the top. Press Ctrl+D and

make breakpoint at : BPX getmodulefilename. Now choose Close from NJWIN

menu and blam...... you get into soft ice. Press F11 and now you at this

location. And slowly trace it using F10.

<PRE>:0001.44E9 9A22370000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call KERNEL.GETMODULEFILENAME

:0001.44EE 68FD44&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push SEG ADDR of Segment 0001

:0001.44F1 688876&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 7688

:0001.44F4 8D86EAFE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FEEA]

:0001.44F8 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.44F9 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.44FA 9A56081B45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 0001.0856

:0001.44FF 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0008

:0001.4502 8BF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov si, ax

:0001.4504 8956F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov [bp-0C], dx

:0001.4507 0BD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or dx, ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

:0001.4509 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jne 450E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

:0001.450B E98A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 4698</PRE>

...Trace it until this line.

<PRE>:0001.467A 8B46EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ax, [bp-16]

:0001.467D 8B56EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dx, [bp-14]

:0001.4680 3946EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp [bp-12], ax

:0001.4683 7505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jne 468A

:0001.4685 3956F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp [bp-10], dx

:0001.4688 740E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je 4698</PRE>



<PRE>* Referenced by a Jump at Address:0001.4683(C)

|

:0001.468A 8D86EAFE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FEEA]

:0001.468E 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.468F 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.4690 9A3C2E7842&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 0001.2E3C&nbsp; ; It seem this procedure

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp!

;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; used to self destruction.</PRE>



<PRE>* Referenced by a Jump at Address:0001.4678(U)

|

:0001.4695 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0004</PRE>

Why I could know this procedure ??? This time we are using nj1.exe that

we have change. So it must be execute that procedure. But if we using the

original one, this step have been passed and never execute that procedure.

(Try it yourself).



<P>So we know the call procedure. Now we need to patch it to fool the program

so that it never enter that place. Using w32dasm, Menu Search and then find text.

Type call 0001.2E3C in the dialog box and w32dasm would take you to :

<PRE>

First->

:0001.07F5 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0008

:0001.07F8 8D46F2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp-0E]

:0001.07FB 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.07FC 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.07FD 9A3C2E7C06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 0001.2E3C

:0001.0802 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0004

:0001.0805 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or ax, ax

:0001.0807 7403&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je 080C

Change add sp,0008 at 0001.07F5 using HIEW to jmp 0805.



Second->

:0001.35A2 8D86CEFE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FECE]

:0001.35A6 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.35A7 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.35A8 9A3C2EFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 0001.2E3C

:0001.35AD 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0004

:0001.35B0 8B46EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ax, [bp-14]

:0001.35B3 EB04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 35B9

Change lea ax,[bp+FECE] at 0001.35A2 using HIEW to jmp 35AD.



Third->

:0001.468A 8D86EAFE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FEEA]

:0001.468E 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.468F 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.4690 9A3C2E7842&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 0001.2E3C

:0001.4695 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0004

Change lea ax, [bp+FEEA] at 0001.468A using HIEW to jmp 4695.</PRE>

Ok.... Now we have completely disabled the self destruction part of our target's protection 

scheme and now we can patch the registration.



<P><B><U>Second Step : Make it Registered.</U></B>

<BR>Even if we know the registration number, and we try to register, it is

useless because this program seems to have been made just in order to 

fool the crackers.<bR>

Patch me and you'll loose me. But even inside a good protection there must be a 

weakness, as +ORC teached us.<br>

Now we need softice to breakpoint cleverly. Press Ctrl+D and then&nbsp;<BR>

:BPX GetPrivateProfileString

<BR>Why we should break at that point ??? Simple to answer, it is because

NJWIN store their registration data into C:\WINDOWS\NJWIN.INI and read

it from there. So we should break it at the time program want to get information

from that .ini file.

<BR>After that, try to launch the program and blam....you get into soft

ice. Press F11 and trace it with F10. You will see the listing at the below

...

<BR>&nbsp;

<PRE>:0001.3B83 9AB93B0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call KERNEL.GETPRIVATEPROFILESTRING

:0001.3B88 80BEF6FD3F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp byte ptr [bp+FDF6], 3F

:0001.3B8D 752E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jne 3BBD

:0001.3B8F FF36DC05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push word ptr [05DC]

:0001.3B93 FF36DA05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push word ptr [05DA]

:0001.3B97 FF36E005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push word ptr [05E0]

:0001.3B9B FF36DE05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push word ptr [05DE]

:0001.3B9F FFB6ECFB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push word ptr [bp+FBEC]

:0001.3BA3 FFB6EAFB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push word ptr [bp+FBEA]

:0001.3BA7 8D86F6FD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FDF6]



Try to trace it until here......



:0001.3C8A 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 0004

:0001.3C8D 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push dx

:0001.3C8E 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.3C8F 8D86F6FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FCF6]

:0001.3C93 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.3C94 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.3C95 8D86F6FD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ax, [bp+FDF6]

:0001.3C99 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ss

:0001.3C9A 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ax

:0001.3C9B 9AC26ADA3C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 0001.6AC2

:0001.3CA0 83C40C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add sp, 000C

:0001.3CA3 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dec ax

:0001.3CA4 7505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jne 3CAB&nbsp;&nbsp;&nbsp;&nbsp; ; If wrong then unregistered

:0001.3CA6 C6061A0601&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov byte ptr [061A], 01 ; else good boy..</PRE>

Aha... Now we know that if "good boy" then the target assign value to [061A]

with 01. Now we should use w32dasm to find text : mov byte ptr [061A] and blizzz.....we

got into ...

<PRE>:0001.3D35 32C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor al , al&nbsp;

:0001.3D37 A21A06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov byte ptr [061A], al

:0001.3D3A A21B06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov byte ptr [061B], al

:0001.3D3D EB0D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 3D4C</PRE>

It seem the default value for [061A] is 00. So we patch it using HIEW.

Change <B><U>xor al,al</U></B> AT 0001.3D35 to <B><U>mov al,1</U></B>&nbsp;&nbsp;

and the program will always think this that the cracker is a registered 

user and finish merriuly.



<P>I'm sorry if my English is little bit messed because I'm not ..... guy.

<BR><!-- FINAL NOTES STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT SIZE=+2><FONT COLOR="#0000FF">Final Notes</FONT>&nbsp;</FONT></CENTER>

</TD>

</TR>

</TABLE>

<!-- PASTE HERE YOUR FINAL NOTES (if any) -->

<BR>So....Goodbye....And if you want to contact me feel free to mail <A HREF="mailto:kabhoet@yahoo.com">kabhoet@yahoo.com</A>

and may be could sharing our knowledge about cracking method and other

protection. Thank you.

<BR><BR>

<!-- OB DUH STARTS HERE -->

<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >

<TR>

<TD BGCOLOR="#C6E7C6">

<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Ob Duh</FONT></FONT>&nbsp;</CENTER>

</TD>

</TR>

</TABLE>



<CENTER><I>I wont even bother explaining you that you should BUY this target

program if you intend to use it for a longer period than the allowed one.

Should you want to STEAL this software instead, you don't need to crack

its protection scheme at all: you'll find it on most Warez sites, complete

and already regged, farewell.</I></CENTER>

<!-- WAY OUT STARTS HERE -->

<HR>

<CENTER><I>You are deep inside fravia's page of reverse engineering, choose

your way out:</I></CENTER>



<CENTER><!-- EITHER A NICE GIF LIKE THIS --><!-- 



<a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" 



ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>



<br>



<font color=gray>Back to project 3</FonT>



<br><bR>



--><!-- OR JUST A LINK LIKE THIS --><!--



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 



BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to Your_chosen_project</A> 



<hr width=33%>



--><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red"

 BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM !><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALI!

GN=BOTTOM><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students'

essays</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy

database</A></CENTER>



<CENTER><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality

cracking</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how

to search</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript

wars</A></CENTER>



<CENTER><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity

academy</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut

CGI-scripts</A>&nbsp;<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A></CENTER>



<CENTER><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is

reverse engineering legal?</A></CENTER>



<HR><!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML>



