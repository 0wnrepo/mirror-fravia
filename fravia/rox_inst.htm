<HTML>

<HEAD>

   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

   <XMETA name="Author" confiltered="Rox">

   <XMETA name="GENERATOR" confiltered="Mozilla/4.5 [it] (Win95; I) [Netscape]">

   <TITLE>rox_inst.htm: +RoXrOb's InstalSHIELD 5 Script Zen Cracking</TITLE>

</HEAD>

<BODY text="#000000" bgcolor="#CCCCCC" link="#0000EE" vlink="#551A8B" alink="#FF0000">



<CENTER><FONT size=+2>InstalSHIELD 5 Script Zen Cracking</FONT>

<P>(by&nbsp; +RoXrOb, slightly edited by fravia+)<P>June 1999<HR>Courtesy of fravia's pages of reverse engineering

<HR>

</CENTER>



<P><BR>



<P>It's fantastic how it is possible to reverse programs' code even if 

there are no available

informations , but only some feeling, some dreaming and then the ability to 

find the solution (Zen, probably).

<BR>When I tried to crack this program, I did know nothing about InstallSHIELD

nor did I knew much how to crack an installation process.

<BR>Then, thanks to Fravia's page (and to the whole +HCU) I started 

to find good informations,

which are the base to be able

<BR>to solve the problems time after time

<P>LEVEL:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I think that also the beginners

can understand this tutorial, because it's no necessary to attempt

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

with hard techniques that go into the operative system and it's not to

use tools how softice

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

which enter in the hearth of the code. I explain every procedures with

whom I arrived to the

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

solution of this crack:

<P>TOOLS&nbsp;&nbsp; :&nbsp; 1)&nbsp;&nbsp; I5Comp ----->&nbsp;&nbsp; compression

utility for InstallSHIELD ver. 5

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

2)&nbsp;&nbsp; IsDcc&nbsp; v. 1.22&nbsp; ----->&nbsp; installSHIELD Decompiler

supports installshield till ver 5.5

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

3)&nbsp;&nbsp; UltraEdit 32 v. 5.21&nbsp; ----->&nbsp; Hex Editor or others

one.

<P>TARGET :&nbsp;&nbsp; MATHCAD 8, a program for mathematic projects, functions

studies etc.

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

I don't know where found it. However, I think this tutorial is not important

to crack

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Mathcad 8 only, but somewhat it could be useful to understand a cracking

system for others

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

programs with similar protection, therefore also who don't have Mathcad

8 (which could be

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

very hard to download from the web as it's approximately 128 MB included

doc), can use

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

this procedure for similar ones.

<BR>&nbsp;

<BR>&nbsp;

<BR>

<BR>

<CENTER>

<P>INFO</CENTER>



<P>During the installation it needs the serial number, then it's possible

to install only in U.S.A. and Canada.

<BR>Therefore, there are 2 protections:&nbsp; 1)&nbsp; SERIAL&nbsp;&nbsp;&nbsp;

2) COUNTRY CODE VERIFICATION.

<BR>When I start to crack the MathCad 8 installation,&nbsp; I try immediately

to use Softice, however after few

<BR>time I get weary to control some code lines and breakpoints on nag

screen looking for the right flag.

<BR>I begun to inquire about InstallSHIELD and I discover some useful informations.

Naturally there are two

<BR>fundamental fils:&nbsp; <U>SETUP.EXE</U>&nbsp; the executable which

load the process, but the most important is <U>SETUP.INS,</U>

<BR>the script that manage all the installation parameters of InstallSHIELD.

<BR>&nbsp;

<BR>&nbsp;

<BR>

<BR>

<CENTER>

<P><U>LET'S START</U></CENTER>



<P>When SETUP.EXE is launched, it's creates a directory&nbsp; "_istmp0.dir"

into the system temp directory

<BR>(Es: C:\Windows\temp), where are decompress all the files required

to the setup for the installation.

<P>NOTE: I used the tool <U>I5COMP</U> only to verify in which compress

file (own compression system InstallSHIELD)

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

there reside the decompress files in this directory. This is the structure:

<BR>&nbsp;

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _DATA.CAB&nbsp;

=&nbsp; file containig all the files that will be install into the system

for MathCad 8 functioning.

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _USER1.CAB

=&nbsp; part of the files will be copy into the temporary directory for

the installation:

<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _SYS1.CAB&nbsp;&nbsp;&nbsp;

=&nbsp; other files copy into the temporary directory.

<BR>&nbsp;

<BR>&nbsp;

<BR>

<BR>

<CENTER>

<P><U>1ST PART : Tricking the COUNTRY CODE</U></CENTER>



<P>At the beginning of this crack, I had a valid (serial) for Mathcad 8,

but unfortunately when I introduced it, I saw the

<BR>Nag Screen with this message: "This product version is only for sale

in the U.S. and Canada. Setup will exit now."&nbsp; (COUNTRY CODE).

<BR>The message is readable in no installation files (research with windows),

obvious sign it was included in any

<BR>compress files inside of these files _USER1.CAB or _SYS1.CAB. To verify

it there are two methods:

<P>1) It's possible to launch the installation and, when required informations,

to open the temporary directory

<BR>&nbsp;&nbsp;&nbsp;&nbsp; "_istmp0.dir" , mentioned before, and execute

with the research into file (of windows) on all the files (*:*)

<BR>&nbsp;&nbsp;&nbsp;&nbsp; the strings included into Nag Screen "This

product version is only.....".

<P>2)&nbsp; _USER1.CAB and _SYS1.CAB filse have to be decompress with <U>I5COMP</U>

into a directory, then, as before,

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; it needs to execute the research of

the Nag Screen string.

<P>Both methods allow to discover a file containing all the messages of

MessageBox showed during the installation -

<BR>the file is (<U>VALUE.SHL</U>):

<P>-[Date]

<BR>-STATUS_HBK=Copying Practical Statistics Electronic Book files...

<BR>-STATUS_IMPROC=Copying Image Processing patch files...

<BR>-MSG_DELETING_OLD=Cleaning up old Mathcad program files...

<BR>-MAX_MCAD_FOR_UPGRADE=8.0.2.0

<BR>-ZEOS=kbdru441.kbd

<BR>-MSG_INVALID_OLD_MEDIA=The media you inserted is not a valid Mathcad

disk. Please enter a valid

<BR>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

Mathcad disk or&nbsp; cancel the installation.

<BR>-KEYBIND_MSG=Select your initial key bindings. You can change them

later in the View Preferences dialog.

<BR>-.

<BR>-.&nbsp;&nbsp;&nbsp; other lines

<BR>-.

<BR>-MSG_DOMESTIC_SCARE=This product version is only for sale in the <FONT color="#FF0000">&lt;-----</FONT>



<U><FONT color="#FF0000">(THIS IS THE COUNTRY</FONT></U>

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

U.S. and Canada.\n\nSetup will exit now.&nbsp;&nbsp;&nbsp; <FONT color="#FF0000">&lt;-----&nbsp;<U>

CODE STRING)</U></FONT>

<BR>-.

<BR>-.&nbsp;&nbsp;&nbsp; other lines

<BR>-.

<BR>-MSG_INVALID_SERIAL=Invalid serial number. Please check your serial

<FONT color="#FF0000">&lt;-----<U>(THIS&nbsp;

MSG WILL BE USED</U></FONT>

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

number and enter it again.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;



<FONT color="#FF0000">&lt;-----</FONT>&nbsp; <U><FONT color="#FF0000">INTO

THE 2ND PART)</FONT></U>

<BR>-.

<BR>-.&nbsp;&nbsp; other lines

<BR>-.

<BR>-MSG_INFO2a=this CD. Each book can be installed on your

<BR>-MSG_INFO3b=install Acrobat Reader from there if you need it.

<BR>-MSG_INFO2b=&nbsp;&nbsp;&nbsp; Practical Statistics

<BR>-.

<BR>-.

<BR>-etc

<P>-[General]

<BR>-Language=0009

<BR>-Type=STRINGTABLESPECIFIC

<BR>-Version=1.00.000

<BR>&nbsp;

<P>If now, with an Hexeditor, you open the file (SETUP.INS) you will note

that there isn't the string "This product version is only....."

<BR>but it's easy to search the label of this string, that is "MSG_DOMESTIC_SCARE",

thus the file (SETUP.INS) print a MessageBox which&nbsp; is really the

Country Code's Nag Screen.

<BR>Now that we know the Nag Screen's liable, we have to find the method

to try to understand something more about it.

<BR>Right in this moment we use the tool <U>"IsDcc"</U> to decompile the

file (SETUP.INS). It needs to write, from the dos prompt:

<P>isdcc setup.ins > setup.lis&nbsp; (where > is useful to redirect the

output of the command isdcc on a file setup.lis)

<P>Well, now that we have the decompiling list <U>(SETUP.LIS)</U> let's

analyze it:

<BR>after some labels there is:

<P><TT>- label130:</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = number50 = 68;&nbsp; <FONT color="#FF0000">&lt;--&nbsp;

lNumber4 = 0 or 1</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; if (lNumber4 = 0) then&nbsp;&nbsp; <FONT color="#3333FF">&lt;-----

PROT1</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; goto label132;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;



<FONT color="#FF0000">&lt;--&nbsp; if lNumber4 = 0&nbsp;&nbsp; !!! GOOD

GUY !!!</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; endif;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; function174();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;



<FONT color="#FF0000">&lt;--&nbsp; if lNumber4 = 1</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = LAST_RESULT;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = lNumber4 &lt; 0;&nbsp; 

<FONT color="#FF0000">&lt;--&nbsp;

lNumber4 = 0 or 1</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; if (lNumber4 = 0) then&nbsp;&nbsp; <FONT color="#3333FF">&lt;-----

PROT2</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; goto label132;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;



<FONT color="#FF0000">&lt;--&nbsp; if lNumber4 = 0&nbsp;&nbsp; !!! GOOD

GUY !!!</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; endif;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; StrLoadString("", "MSG_DOMESTIC_SCARE",

lString2)<FONT color="#FF0000">&lt;-- if lNumber4 = 1 !!! BAD GUY !!!</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; MessageBox(lString2, -65535);&nbsp; <FONT color="#FF0000">&lt;--

"This product version is only....."</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp; abort;</TT>

<P>this is the part we are interesting in for the control on COUNTRY CODE.Nag

Screen.

<BR>You may see the routine launching out the Nag Screen. Unluckily I don't

know yet enough the structure and the

<BR>language of the file (SETUP.INS) (script) just decompiled to go up,

with certainty, to the parameters and functions

<BR>used (I'd like to have more documentations about them), but I note

something (ZEN):

<BR>let's open the file (SETUP.INS) and (SETUP.LIS) with "UltraEdit 32",

here follows there is the part of the file

<BR>(SETUP.INS) hexadecimal listing around the string "MSG_DOMESTIC_SCARE"

:

<BR>&nbsp;

<DL>&nbsp;

<BR><TT>62 99 FF 41 01 00 FF FF 21 00 32 9A FF 41 01 00&nbsp; b..A....!.2..A..</TT>

<BR><TT>00 00 21 00 32 9B FF 41 00 00 00 00 00 00 01 00&nbsp; ..!.2..A........</TT>

<BR><TT>2C 00 70 7F 00 00 00 09 00 28 01 32 97 FF 42 38&nbsp; ,.p......(.2..B8</TT>

<BR><TT>00 41 05 00 00 00 41 44 00 00 00 22 00 70 84 00&nbsp; .A....AD...".p..</TT>

<BR><TT>95 42 97 FF 41 <FONT color="#3333FF">00 00 00 00</FONT> B5 00 80

AE 00 70 BA&nbsp; .B..A.........p. <FONT color="#FF0000">&lt;---- dword

(0) </FONT><FONT color="#3333FF">PROT1</FONT></TT>

<BR><TT>00 21 00 32 97 FF 42 00 00 28 01 32 97 FF 42 97&nbsp; .!.2..B..(.2..B.</TT>

<BR><TT>FF 41 01 00 00 00 41 <FONT color="#FF0000">00 00 00 00</FONT> 22

00 70 84 00&nbsp; .A....A....".p.. <FONT color="#FF0000">&lt;- dword (0)</FONT></TT>

lNumber4 &lt; 0

<BR><TT>95 42 97 FF 41 <FONT color="#3333FF">00 00 00 00</FONT> 12 01 61

00 00 61 12&nbsp; .B..A......a..a.<FONT color="#FF0000"> &lt;---- dword

(0) </FONT><FONT color="#3333FF">PROT2</FONT></TT>

<BR><TT>00 <FONT color="#3333FF">4D 53 47 5F 44 4F 4D 45 53 54 49 43 5F

53 43</FONT>&nbsp; .<FONT color="#3333FF">MSG_DOMESTIC_SC &lt;---- String</FONT></TT>

<BR><TT><FONT color="#3333FF">41 52 45</FONT> 52 99 FF 2A 00 62 99 FF 41

01 00 FF FF&nbsp; <FONT color="#3333FF">ARE</FONT>R..*.b..A....</TT>

<BR>&nbsp;

<P><FONT color="#000000">It's notice, looking at two files (SETUP.LIS in

text format) and (SETUP.INS in hexadecimal format)</FONT>

<BR><FONT color="#000000">that the constants (both strings and numerical)

appears in (SETUP.INS) in order like (SETUP.LIS),</FONT>

<BR><FONT color="#000000">namely going to the high from string

</FONT>"MSG_DOMESTIC_SCARE"

you meet a&nbsp; DWORD

<BR>00 00 00 00 which is the first zero into the listing of code in (SETUP.LIS)

at the line

<BR>"if (lNumber4 = 0) then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#3333FF">&lt;-----

PROT2</FONT>", then there is a DWORD 00 00 00 00&nbsp; which is the zero

of the line

<BR>&nbsp;"lNumber4 = lNumber4 &lt; 0;" and then the DWORD 00 00 00 00

which is the zero of the line

<BR>"if (lNumber4 = 0) then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color="#3333FF">&nbsp;

&lt;----- PROT1". </FONT><FONT color="#000000">We have 2 possibilities

to modify the flow of the program</FONT>

<BR><FONT color="#000000">through these flags. The most effective is the

first above as it avoid completely the execution of the</FONT>

<BR><FONT color="#000000">function which derives the COUNTRY CODE "function

174 ()" and jump over Nag Screen (</FONT><FONT color="#3333FF">PROT 1</FONT><FONT color="#000000">).</FONT>

<BR><FONT color="#000000">Changing the DWORD in </FONT><FONT color="#3333FF">PROT1

da 00 00 00 00 in 01 00 00 00&nbsp; </FONT><FONT color="#000000">I change

the control on the flag</FONT>

<BR><FONT color="#000000">which starts the nag screen.</FONT>

<BR><FONT color="#000000">Now we may launch it (SETUP.EXE), but an instant,

appears a message saying the file (SETUP.INS)</FONT>

<BR><FONT color="#000000">is damaged. At once I think to a check-sum on

the file. To make up for the sum, I try the easier matter,</FONT>

<BR><FONT color="#000000">I reduce of 1&nbsp; a letter of the string </FONT>"MSG_DOMESTIC_SCARE"

(that after the crack will be never used)

<BR>in "MSG_DOMESSIC_SCARE"&nbsp; namely "S" in place of "T" (53h in place

of 54h). Well Done.

<BR>Everything works correctly. (Naturally this modifications works only

for the countries different from U.SA.. &amp; Canada)!!

<CENTER>

<P><U>2ND PART : SERIAL NUMBER</U></CENTER>



<P>I also asked myself, if I never have had the serial number?

<BR>View my intuition about the position of the constants into the file

(SETUP.INS) worked, well I followed the same

<BR>reasoning for the serial number. There is this message:

<BR>"Invalid serial number. Please check your serial number and enter it

again."

<BR>which appeares only if put the wrong serial number,this string, how

you can see above, is existing into the&nbsp; file

<BR>(VALUE.SHL) as text of the label "MSG_INVALID_SERIAL", thus let's go

into the file (SETUP.LIS) to look

<BR>for this string:

<P><TT>-label126:</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = lNumber0

= 0;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#FF0000">&lt;-- lNumber4 = 0

or 1(=1 if lNumber0=0)</FONT><FONT color="#3333FF">&lt;-- PROT3</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (lNumber4 = 0) then

<FONT color="#3333FF">&lt;---

PROT4</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

goto label131;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#FF0000">&lt;--

if lNumber4 = 0&nbsp;&nbsp; !!! GOOD GUY !!!</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endif;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function182(lString0,

lString1, string5, string6, string7, lNumber1);</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber0 = LAST_RESULT;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = lNumber0

= <FONT color="#3333FF">12</FONT>;&nbsp;&nbsp;&nbsp; <FONT color="#FF0000">&lt;--

lNumber4 = 0 or 1</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (lNumber4 = 0) then

<FONT color="#3333FF">&lt;---

PROT5</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

goto label128;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#FF0000">&lt;--

if lNumber4 = 0 !!! BAD GUY !!!</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endif;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return(lNumber0);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;



<FONT color="#FF0000">&lt;-- if lNumber4 = 1&nbsp;&nbsp; !!! GOOD GUY

!!!</FONT></TT>

<BR><TT>-</TT>

<BR><TT>-label127:</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function171(string7);</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = LAST_RESULT;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber4 = lNumber4

= 1;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (lNumber4 = 0) then</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

goto label129;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endif;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; function3("", string5,

string6, string7, 0);</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber0 = LAST_RESULT;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber1 = 0;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; goto label130;</TT>

<BR><TT>-</TT>

<BR><TT>-label128:</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StrLoadString("", "MSG_INVALID_SERIAL",

lString2);&nbsp; <FONT color="#FF0000">&lt;--</FONT> <FONT color="#FF0000">!!!

BAD GUY !!!</FONT></TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox(lString2,

-65535);</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber1 = 1;</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lNumber0 = 0;</TT>

<BR><TT>-</TT>

<BR><TT>-label129:</TT>

<BR><TT>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; goto label127;</TT>

<BR>&nbsp;

<P>This is the part we are most interesting in for the control&nbsp; on

the SERIAL NUMBER.

<BR>You may see the routine that ask for the function which shows the message

the serial number is not valid.

<BR>Let's open the files (SETUP.INS) and (SETUP.LIS) with "UltraEdit 32",

here follows there is the part of the file

<BR>(SETUP.INS) hexadecimal listing near the string "MSG_INVALID_SERIAL"

:

<BR>&nbsp;

<P><TT>45 52 49 41 4C 5F 50 52 4F 4D 50 54 52 9A FF 21&nbsp; ERIAL_PROMPTR..!</TT>

<BR><TT>00 32 9A FF 41 00 00 00 00 00 00 01 00 21 00 32&nbsp; .2..A........!.2</TT>

<BR><TT>9B FF 41 00 00 00 00 00 00 09 00 29 01 28 01 32&nbsp; ..A........).(.2</TT>

<BR><TT>97 FF 42 9B FF 41 05 00 00 00 41 <FONT color="#FF0000">00 00 00

00</FONT> 22&nbsp; ..B..A....A...." <FONT color="#FF0000">&lt;---- dword

(0) </FONT><FONT color="#3333FF">PROT3</FONT></TT>

<BR><TT>00 70 83 00 95 42 97 FF 41 <FONT color="#FF0000">00 00 00 00</FONT>

B5 00 80&nbsp; .p...B..A....... <FONT color="#FF0000">&lt;---- dword (0)

</FONT><FONT color="#3333FF">PROT4</FONT></TT>

<BR><TT>B6 00 70 41 01 62 9B FF 62 9A FF 52 1E 00 52 1F&nbsp; ..pA.b..b..R..R.</TT>

<BR><TT>00 52 20 00 42 9A FF 21 00 32 9B FF 42 00 00 28&nbsp; .R .B..!.2..B..(</TT>

<BR><TT>01 32 97 FF 42 9B FF 41 05 00 00 00 41 <FONT color="#3333FF">0C</FONT>

00 00&nbsp; .2..B..A....A... <FONT color="#3333FF">&lt;---- ref. constant</FONT></TT>

<BR><TT>00 22 00 70 80 00 95 42 97 FF 41 <FONT color="#FF0000">00 00 00

00</FONT> 2F&nbsp; .".p...B..A..../ <FONT color="#FF0000">&lt;---- dword

(0) </FONT><FONT color="#3333FF">PROT5</FONT></TT>

<BR><TT>01 B7 00 42 9B FF 00 00 08 00 B5 00 80 AB 00 70&nbsp; ...B...........p</TT>

<BR><TT>87 00 62 20 00 21 00 32 97 FF 42 00 00 28 01 32&nbsp; ..b .!.2..B..(.2</TT>

<BR><TT>97 FF 42 97 FF 41 05 00 00 00 41 01 00 00 00 22&nbsp; ..B..A....A...."</TT>

<BR><TT>00 70 81 00 95 42 97 FF 41 00 00 00 00 B5 00 80&nbsp; .p...B..A.......</TT>

<BR><TT>03 00 70 77 01 61 00 00 62 1E 00 62 1F 00 62 20&nbsp; ..pw.a..b..b..b</TT>

<BR><TT>00 41 00 00 00 00 21 00 32 9B FF 42 00 00 21 00&nbsp; .A....!.2..B..!.</TT>

<BR><TT>32 9A FF 41 00 00 00 00 2C 00 70 82 00 00 00 04&nbsp; 2..A....,.p.....</TT>

<BR><TT>00 12 01 61 00 00 61 12 00 <FONT color="#3333FF">4D 53 47 5F 49

4E 56</FONT>&nbsp; ...a..a..<FONT color="#3333FF">MSG_INV &lt;-- String</FONT></TT>

<BR><TT><FONT color="#3333FF">41 4C 49 44 5F 53 45 52 49 41 4C</FONT> 52

99 FF 2A 00&nbsp; <FONT color="#3333FF">ALID_SERIAL</FONT>R..*.</TT>

<P><FONT color="#000000">You note, looking at 2 files (SETUP.LIS) and (SETUP.INS)&nbsp;

and how made for the Country Code</FONT>

<BR><FONT color="#000000">namely going to top of the file from the string

</FONT>"MSG_INVALID_SERIAL",

but here seeing the flags

<BR>which call for the message invalid serial number are most at the top

from the string; as reference point we

<BR>will examine (12d) = (0ch) of the line "<TT>lNumber4 = lNumber0 = 12;".</TT>

<BR>Starting from this value, we may find, near the bottom, the first DWORD

00 00 00 00

<BR>which correnspond to zero in the listing of code in (SETUP.LIS) at

the line

<BR>"<TT>if (lNumber4 = 0) then&nbsp; <FONT color="#3333FF">&lt;--- PROT5</FONT></TT>".

<BR>Instead from (0Ch) going toward the top, there is a DWORD 00 00 00

00 which is the zero of the line

<BR>"<TT>if (lNumber4 = 0) then&nbsp; <FONT color="#3333FF">&lt;--- PROT4</FONT></TT>"

and then the DWORD 00 00 00 00 which is the zero of the line

<BR>"<TT>lNumber4 = lNumber0 = 0;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#FF0000">&lt;--

lNumber4 = 0 or 1(=1 if lNumber0=0)</FONT><FONT color="#3333FF">&lt;--

PROT3</FONT></TT><FONT color="#3333FF">".</FONT>

<BR><FONT color="#000000">We have 3 possibilities to modify the flow of

the program through these flags.</FONT>

<BR><FONT color="#000000">Particularly:</FONT>

<P><FONT color="#000000">1) AVOIDS DEMANDS SERIAL NUMBER and NO COUNTRY

CODE:</FONT>

<BR><FONT color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

the modifications on </FONT><FONT color="#3333FF">PROT3 oPROT4 (either)

</FONT><FONT color="#000000">Changing

DWORD 00 00 00 00 in</FONT>

<BR><FONT color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

01 00 00 00.</FONT>

<BR><FONT color="#000000">2) ACCEPTS WHATEVER SERIAL NUMBER and NO COUNTRY

CODE:</FONT>

<BR><FONT color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

the modifications on </FONT><FONT color="#3333FF">PROT5&nbsp; </FONT><FONT color="#000000">Changing

DWORD 00 00 00 00 in 01 00 00 00.</FONT>

<P>Always never forget Check-Sum (like above). All Done!!

<P>How you may see, different types of crack are possible with or without

serial number,the choice is by you, also

<BR>the possibilities to crack, with another approach, the installation

of Mathcad 8. I think this is the quicker once understood

<BR>the procedure, on the contraty I'm amaze about the ease and the stupidity

of this protection, in spite of my partial ignorance about the structure

of the scripts), especially of the check-sum on (SETUP.INS), it would be

better&nbsp; to put none check-sum.

<BR>But how I learned from +ORC, there really exist something that we will call 

"Zen cracking" for lack of a better definition, it means among other things 

to try, first of all,

the easy solutions that could take you away, far above the code, on their wings of facility.

<P>(Thanks to my girlfriend for translation assistance)

<BR>(by +RoXrOb)</DL>



</BODY>

</HTML>