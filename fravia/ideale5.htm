<HTML>

<HEAD>

<TITLE>ideale5.htm: How to fish scripts or programs that should have been hidden</TITLE>

</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<A NAME="anchortop"></A>

<!-- Begin Introdo -->

<CENTER>

<A href="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm"><IMG SRC="antism.gif" tppabs="http://www.anticrack.de/fravia/antism.gif" ALT="No_commercial!" 

ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></A>

<BR>

<FONT color=gray>Crackers against Smut</FONT>



</CENTER>

<H1>

<FONT size=+4>

<CENTER>Fravia's <FONT color=red>Server exploits</FONT>: ONE</FONT><FONT size=3><BR>(elementary Micro$oft's insecurity: IIS)</FONT></CENTER></H1>

<CENTER>

~<BR>

<B>(How to fish scripts or programs that should have been hidden)</B><BR>

<BR>~<BR>

By Fravia+, Started <FONT color=red>06 September 1998</FONT><BR>Page severely under construction... 

SEND MORE CONTRIBUTIONS!

</CENTER><BR><HR size=2>

<!-- Begin whatwewant --><CENTER>

<I>Thank to Mark & Paul for part of the following

</I></CENTER>

<HR>

<FONT size=+2>

Micro$oft IIS fishing possibilities</FONT><P>

If you want to hide code or programs, most 

will advice you that, given the choice of server side or 

client side scripting, you should always choose server side, because it 

hydes your code from prying eyes. Well, this is not always so.

<P>

Microsoft IIS has a nice bug: if you enter the name of a script-based 

page into your browser and put a full stop at the end of the URL, IIS returns 

the raw ASP page, rather than the script output.

<P>

This exploit was published some months ago and Microsoft 

provided a fix for it (which as you know does not mean anything 

at all, since the rate of internet bug-fixing is well below 45% :-) and now 

another new exploit has been found: under certain circumstances you can get 

hold of any ASP script, <U>or even grab copies of executables</U> sitting on 

your target server.

<P>

The exploit is based on the fact that the native Windows NT file system (NTFS) 

supports multiple data streams within a single file. Here the MS 'online' 

documentation: <FONT color=purple><PRE>

Multiple Data Streams



NTFS supports multiple data streams. The stream name identifies 

a new data attribute on the file. Streams have separate opportunistic 

locks, file locks, allocation sizes, and file sizes, but sharing is per file. 



The following is an example of an alternate stream:



myfile.dat:stream2





This feature permits related data to be managed as a single unit. 

For example, Macintosh computers use this type of structure to 

manage resource and data forks. Or, a company might create a program 

to keep a list of changes to the file in an alternate stream, thus 

keeping archive information with the current version of the file.



As another example, a library of files might exist where the files 

are defined as alternate streams, as in the following example:



library:file1

       :file2

       :file3



Suppose a "smart" compiler creates a file structure like the following example:



program:source_file

       :doc_file

       :object_file

       :executable_file



Note Because NTFS is not supported on floppy disks, when you copy an NTFS 

file to a floppy disk, data streams and other attributes not supported by 

FAT are lost.

</PRE></FONT>

The really important data stream is called $Data, the stream that stores the actual 

content of the file. If you type in the UTL of a script you are interested in, 

and you add ::$DATA to the end of it, for example<P>

<CENTER><FONT color=blue>http://www.target.com/security.asp::$DATA</FONT></CENTER>

<BR>

the server mappings will be bypassed and the raw script returned. Just what 

'secure' e-commerce enabled sites need :-)<P>

Obviously this can only happen if the files are being stored on an NTFS volume, 

so anyone running web server off a FAT volume will not be affected by this 

exploit, but there are so many exploit out there for FAT volumes, that to get 

those scripts is as easy as shooting the red cross.

<P>

Note that this regards ASP, PL, IDC, SHTML and any other script or executable file 

types!

<P>

Never forget that root is usually<P>

<FONT color=blue>\inetpub\wwwroot</FONT> in M$ Internet Information Server, <BR>

<FONT color=blue>\home\httpd</FONT> in Apache <BR> and 

that lazy sysads (or all sysads that have had enough with all bugs) tend to 

stuff most of the things inside root.<P>

Another interesting example (for instance perusing bank accounts), is that 

if you find somewhere a 'forgotten' Access database file in some remore 

subdirectory of your target you just need to point your browser to this file 

(if you have Access installed on your system) in order to see the whole 

database. It's read-only, of course, but hey: info is info!

<HR>











<P>

<!-- End whatwewant -->

<FONT size=+3><CENTER>

Good luck, good hunt!<BR></FONT>

</CENTER>



<!-- Begin this section mover -->

<HR ALIGN=CENTER WIDTH=100% SIZE=3><CENTER>

<A href="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm"><IMG SRC="antism.gif" tppabs="http://www.anticrack.de/fravia/antism.gif" ALT="No_commercial!" 

ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></A>

<BR>

<FONT color=gray>Crackers against Smut</FONT>



</CENTER>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 

VSPACE=0 HSPACE=0><A href="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">Antismut main page</A> 

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 

VSPACE=0 HSPACE=0><A href="general.htm" tppabs="http://www.anticrack.de/fravia/general.htm">A general approach</A>

<BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 

VSPACE=0 HSPACE=0><A href="ideale1.htm" tppabs="http://www.anticrack.de/fravia/ideale1.htm">combing</A> i.e. how to find the 

"commercial smut" sites

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 

VSPACE=0 HSPACE=0><A href="ideale2.htm" tppabs="http://www.anticrack.de/fravia/ideale2.htm">source checking</A> i.e. how to exploit 

their intrinsic weaknesses

<BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 

VSPACE=0 HSPACE=0><A href="ideale3.htm" tppabs="http://www.anticrack.de/fravia/ideale3.htm">cgi-script one</A> CGI-tricks, page 

one

<BR>

<!-- End this section mover -->

<HR ALIGN=CENTER WIDTH=100% SIZE=3>

<!-- Begin  main mover -->

<CENTER>

<FONT size=+2>Fravia's main site</FONT>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>   

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anon</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="coumes.htm" tppabs="http://www.anticrack.de/fravia/coumes.htm">counter measures</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">+HCU Academy</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="stalking.htm" tppabs="http://www.anticrack.de/fravia/stalking.htm">stalking</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="slaves.htm" tppabs="http://www.anticrack.de/fravia/slaves.htm">enslavement</A> 

<BR> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>  

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A> 

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering legal?</A> 

</CENTER>

<!-- End main mover -->





</BODY>

</HTML>