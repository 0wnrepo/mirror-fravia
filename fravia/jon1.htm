<HTML>

<HEAD>

<TITLE>Jon1</TITLE>

</HEAD>

<BODY BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<CENTER><FONT size="+3">Kremlin 1.1, a stupidly protected encryption utility<BR></FONT><FONT size="+2">

(An useful encryptor for our studies, btw)</FONT> <BR>

<IMG SRC="stupid.gif" tppabs="http://www.anticrack.de/fravia/stupid.gif" ALT="HCU" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0">

<BR><BR>



<H4>by Jon<BR>

<BR>

(17 August 1997, slightly edited by Fravia)</H4>

<HR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Fravia's page 

of reverse engineering<BR><BR><I>Well, it's pretty obvious how much important 

this kind of targets are for our trade: encryption and decryption (in a broad 

sense :-) are similar activities.<BR><BR>Yet I'm not happy with the fact that an 

+HCU follower (and that's what Jon is, despite the fact that he is a newbye) has 

not finished a good reverse engineering work... and await Jon's completation of 

this essay... the scheme in Kremlin is indeed very easy to reverse: there is no 

point in simply having ONE choice of encryption algorhytm if you can easily 

have all of them... Jon, are you reading this?</I></CENTER><HR size="2"><PRE><FONT size="+3">

Kremlin 1.1	</FONT>



Download Kremlin 1.1 at <A href="tppmsgs/msgs1.htm#180" tppabs="http://www.anticrack.de/fravia/tppmsgs/msgs1.htm#180">http://wwww.mach5.com/</A>



I found this nice shareware utility a day I was searching for an encryption

utility. It looked pretty good, so I decided to try it. 

Of course, like all shareware programs, it had a nag-screen and some

limitations. It didn't look too hard to crack, since it only uses a simple 

registration-code scheme. I looked trough the help-file to find some hints, 

and I found out that it had <U>two</U> types of registration-codes, one to 

remove the nag, and one that not only removes the nag, but also enables all 

encryption algorithms. I also found that both codes should be 10 digits long 

(as you can see, it is always worth to check first of all the target's own 

documentation :-)

Since I'm not so familiar with Softice yet, I decided to try an easier way 

to crack this target: the Windows registry approach. 

I looked at HKEY_CURRENT_USER\Software\Mach5 Software\Kremlin, and found 

something interesting: the key &quot;glommer&quot;. 

I tried to change its value to 10 random numbers (because the size of the 

code is 10 numbers long), and then I started Kremlin.

<FONT color="blue">The nag was gone!</FONT>This is an incredible stupid protection scheme! 

But there was still a problem: the &quot;limitation&quot; that the help file spoke of: 

the strongest encryption-algorithms were still missing. 

I tried everything in the program to find any hints, and then I noticed that 

in the options-menu there was the option &quot;Remember last algorithm used&quot;. 

I checked it, selected an algorithm and encrypted a random file (to allow

the program to record the last algorithm used). 

I quitted Kremlin, and started regedit. 

Now there were quite a lot of new keys. 

The most interesting was &quot;actualalg&quot; (actual algorithm). 

I changed its value to 1, and started Kremlin, and now the before unselectable 

&quot;Blowfish&quot; algorithm was selected and ready to use!

This means that you can change this value to select any one of the following

algorithms: ASCII=0, Blowfish=1, DES=2, IDEA=3, NewDES=4, Psuedo-RC4=5,

Safer=6 and Vigenere=7. 

This protection-scheme is probably the most stupid that exist, since even a 

newbie cracker, like myself, can quikly figure it out without using a debugger or 

a disassembler! 

BTW, when you have edited the registry to use your favorite algorithm, and start 

Kremlin, DON'T select another algorithm inside it, since that algorithm will then 

be the default.



Enjoy!



Jon <JON@post5.tele.dk>



   </PRE>

 <FONT color="green">(c) jon 1997. All rights reserved</FONT>

<HR ALIGN="CENTER" WIDTH="100%" SIZE="3">

<CENTER><I>You are deep inside fravia's page of reverse engineering,  

choose your way out:</I></CENTER>

<BR><CENTER>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">

<A HREF="project7.htm" tppabs="http://www.anticrack.de/fravia/project7.htm">Project 7</A><BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">

<A HREF="javascript:if(confirm('http://fravia.org/tppmsgs/msgs0.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tppmsgs/msgs0.htm#84'" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84">homepage </A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 

<A HREF="javascript:if(confirm('http://fravia.org/tppmsgs/msgs0.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tppmsgs/msgs0.htm#73'" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73">links </A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">

<A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity </A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="javascript:if(confirm('http://fravia.org/tppmsgs/msgs0.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://fravia.org/tppmsgs/msgs0.htm#82'" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82">students' essays </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database </A><BR>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut CGI-scripts </A>







<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_Fravia </A><BR>





<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering illegal? </A></CENTER>

<CENTER><HR ALIGN="CENTER" WIDTH="100%" SIZE="2"></CENTER>

</BODY>

</HTML>