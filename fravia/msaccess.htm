<HTML>
<HEAD>
<TITLE>msaccess.htm:           Cracking Access Databases
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><TD></TD><TD>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<CENTER>
        <FONT SIZE="+2"> Cracking Access Databases</FONT><BR>
        <FONT SIZE="+1"> Beating M$ with his own tools</FONT> 
      </CENTER></TD><TD>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<CENTER> <A href="project7.htm" tppabs="http://www.anticrack.de/fravia/project7.htm" ><IMG SRC="stupid.gif" tppabs="http://www.anticrack.de/fravia/stupid.gif" ALT="most stupid" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></A><BR>
    <FONT color="gray">Most stupid protection</FONT><BR>
</CENTER></TD></TR><TR><TD bgcolor="#FFFFEA"><CENTER><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
24 September 1999
</FONT></CENTER></TD><TD bgcolor="#FFFFEA"><CENTER>by <FONT size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
LaptoniC
</FONT></CENTER></TD><TD VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"  target="_blank"><img src="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" alt="hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</TD></TR><TR><TD><CENTER><A href="index.html" tppabs="http://www.anticrack.de/fravia/index.html" target="_blank"><IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"alt="bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></A></CENTER></TD>
<TD BGCOLOR="898030"><CENTER>Courtesy of Fravia's page of 
reverse engineering</CENTER> 
</TD><TD BGCOLOR="898030"><CENTER>
<!-- Your truly+ will edit only if really necessary -->
slightly edited
<BR>
by fravia+
</CENTER></TD></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<TR><TD><FONT color="#C4C0CF">fra_00xx<BR>980924<BR>LaptoniC<BR>1000<BR>ST<BR>PC<BR></FONT></TD><TD><CENTER><I>
A most stupid protection indeed. I think this essay could be useful for newbies and beginners that 
want to understand the relationships between modules and this kind of targets.<BR>
For protectors: you SHOULD NEVER, NEVER, NEVER write inside a module something like:<FONT color=blue></I></CENTER><PRE>
If LicCheck = 0 Then
'are the licence details already stored somewhere on the computer?
</PRE></FONT><CENTER><I>
Duh.<BR>The fact that you can use access' debug functions to crack - and even to produce a 
keygenerator! - is something that shareware authors should take note of...
</I></CENTER></TD><TD></TD></TR><TR><TD></TD>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><CENTER><B>There is a crack, a crack in everything 
That's how the light gets in</B></CENTER>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
</TD><TD></TD></TR><TR><TD VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><CENTER><FONT color=blue>Rating</FONT></CENTER>
</TD><TD VALIGN = "MIDDLE" bgcolor="#C6E7C6"><CENTER>
        <FONT color=blue> <!-- CHOOSE A RATING (may be changed) --> (x)<B>Beginner</B> 
        ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT> 
      </CENTER></TD><TD></TD></TR></TABLE>
<!-- END HEAD  --><BR>
<!-- CORPUS  --> <!-- CHOOSE A COMMENT (may be changed)  --> This essay shows 
the stupidity of M$ and its protections. 
<HR><CENTER>
  <FONT SIZE="+2"> <!-- Repeat your TITLE  --> Cracking Access Databases </FONT><BR>
  <FONT SIZE="+2"> <!-- Repeat your SUBTITLE --> </FONT><FONT size="+1">Beating 
  M$ with his own tools</FONT><FONT SIZE="+2"> </FONT><BR>
  <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
LaptoniC
</FONT></CENTER><BR><BR>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Introduction</FONT>
</FONT></CENTER></TD></TR></TABLE>
<PRE>
"<FONT color=blue>Have you ever found a program which resists any attack by WinIce and where no Decompiler
exists ? Even no other tool works ?</FONT>" says Pepper in his essay..Yes i have found a program 
which cant be attacked  by softice.(at least for me).Our target is only one .mdb file.It 
is executed  by Access runtime.Usual breakpoints doesnt help you much.I couldn't found any 
valuable information after one week.In this essay i will completely nake M$ protection schema 
and code keygen for this program.Sorry for my bad English I think you speak Turkish bad too :)
<!-- PASTE HERE YOUR INTRODUCTION -->
</PRE>
<BR><BR>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Tools required</FONT>
</FONT></CENTER></TD></TR></TABLE>
Microsoft Access 97 (it is part of M$ Office) <BR><A href="javascript:if(confirm('http://www.ashishsystems.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.ashishsystems.com/'" tppabs="http://www.ashishsystems.com/" target="_blank">GetAccess 98</A><BR>Visual Basic if you want to code keygen

<!-- PASTE HERE YOUR REQUIRED TOOLS -->
<BR><BR>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Target's URL/FTP</FONT>
</FONT></CENTER></TD></TR></TABLE>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
<A href="javascript:if(confirm('http://www.miesoftware.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.miesoftware.com/'" tppabs="http://www.miesoftware.com/" target="_blank">SummitPro 2000</A>
<BR><BR>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Program History</FONT>
</FONT></CENTER></TD></TR></TABLE>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
First essay about Access databases is written by <A href="pepper2.htm" tppabs="http://www.anticrack.de/fravia/pepper2.htm" target="_blank">Pepper</A>.I suggest you to read it first.It will
give you brief information about access databases and the procedure.
<BR><BR>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Essay</FONT></FONT>
</CENTER></TD></TR></TABLE>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->
<PRE>
Program is really big 18 mb.It is nightmare for dialup users like me.Program is not 
important at all.Main goal is understanding the protection of mdb files.
This program is database program for companies.It is usefull for big companies to track 
meetings, events etc.Program needs serial to unlock its some features.Main protection is in
the sp2000.mdb.If this program is access database lets try to open with Access 97.If you have
read pepper's essay you know that calculation is done by modules.I have tried to open all 
modules and looked what is going on.I have opened all modules but Gfstartup and Mieutilities.
When you try to open this modules, access says that "You dont have access to ....".Lets try to
open this modules.I have bpx on messagebeep like pepper but couldnt found the way.(If you find
it please letme know)Before reinventing the wheel, I decided to search well.After good search 
I found <A href="javascript:if(confirm('http://www.ashishsystems.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.ashishsystems.com/'" tppabs="http://www.ashishsystems.com/" target="_blank">GetAccess 98</A>.Here is what GetAccess claims in its helpfile "GetAccess'98 unsets Access
database file password&User level Security.It also reveals the database password if available."
GetAccess is Vb i hope finding a serial is not a big deal.Open the database and choose 
"Remove Security Permissions Also".Wait, wait, wait it is very long process.Lets try to open 
Mieutilities module.Yeah it worked.Lets analyze what is in this module.

Public Function LicCheck()
On Error GoTo LCErrorBit
Dim dbs As Database, rst As Recordset
Set dbs = CurrentDb
Set rst = dbs.OpenRecordset("Software Details")
rst.MoveFirst
ProdCode = rst("ProductCode")
ExtLName = rst("LicenceeName")
LicName = Left(ExtLName, Len(ExtLName) - 1) & ProdCode ;prodcode is SP2000 in the table
LicNum = rst("LicenceNumber")
If IsNull(LicName) Or LicName = "" Or IsNull(LicNum) Or LicNum = 0 Then
    LicCheck = 0
    GoTo LCExitPoint
End If
L1Len = Len(LicName)
DC = 0
For J = 1 To L1Len
    DC = DC + (Asc(Mid(LicName, J, 1)) * (L1Len + 1 - J + 3))
Next J
DC = DC * Int((L1Len + 14.3) / 2)
If Int(DC) + 71077345 = Int(UnGNum(LicNum)) Then LicCheck = 1 Else LicCheck = 0
LCExitPoint:
If LicCheck = 0 Then
'are the licence details already stored somewhere on the computer ;ehehe programmers comment
    On Error GoTo CantReadF1
    SystemDirectory = GetSysDir()
    FileNumber = FreeFile
    Open SystemDirectory & "\config.sli" For Input As #FileNumber 
    Input #FileNumber, WLicName, LicNum
    Close #FileNumber
    SetAttr SystemDirectory & "\config.sli", vbHidden + vbSystem
    GoTo FoundStoredDetails
    
CantReadF1:
Resume NothingValidStored

FoundStoredDetails:
    On Error GoTo LCErrorBit
    If IsNull(LicName) Or LicName = "" Or IsNull(LicNum) Or LicNum = 0 Then
        LicCheck = 0
        GoTo NothingValidStored
    End If
    LicNum = CLng(LicNum)
    LicName = Left(WLicName, Len(WLicName) - 1) & "SP2000"
    L1Len = Len(LicName)
    DC = 0
    For J = 1 To L1Len
        DC = DC + (Asc(Mid(LicName, J, 1)) * (L1Len + 1 - J + 3))
    Next J
    DC = DC * Int((L1Len + 14.3) / 2)
    If Int(DC) + 71077345 = Int(UnGNum(LicNum)) Then LicCheck = 1 Else LicCheck = 0
    If LicCheck = 0 Then GoTo NothingValidStored
    If LicCheck = 1 Then
        rst.Edit
        rst("LicenceeName") = WLicName
        rst("LicenceNumber") = LicNum
        rst.Update
        rst.Close
        Exit Function

It opens Software Details table and take Product Code ,Licence Name and LicenceNumber.It
computes real serial number and compare it.What is this Ungnum function ?

Public Function GNum(SN)
On Error Resume Next
SNStr = CStr(SN)
N1Str = Left(SNStr, 2)
N2Str = Left(SNStr, 1)
N1 = CInt(N1Str) + 17
N2 = CInt(N2Str) + 6
N1 = N1 * N2
GNum = SN + N1
End Function
Public Function UnGNum(SN)
On Error Resume Next
SNStr = CStr(SN)
N1Str = Left(SNStr, 2)
N2Str = Left(SNStr, 1)
N1 = CInt(N1Str) + 17
N2 = CInt(N2Str) + 6
N1 = N1 * N2
UnGNum = SN - N1
End Function

This info is enough to code keygen.If you have ever used access 97 you know that it has debug
menu.You can surf in the code like in softice.Open software details table ad fill name and 
license number.Run it step by step.When you are at If Int(DC) + 71077345 ... note int(dc)
open debug menu and type gnum(int(dc)+71077345).This is your serial.You may ask why i didnt 
changed this License check=0 stuff.I have tried but it crashes the program maybe it is because
of startupgf module.Access use visual basic language.You can easily code keygen by just copy
and paste.However program looks config.sli file in system directory you can make key file also.
Key file format is like this "Name","Serial" ie. "LaptoniC","12345678"
</PRE>
<BR><BR>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Final Notes</FONT>
</FONT></CENTER></TD></TR></TABLE>
<PRE>
Sorry for my bad english and writing skill ,I am totally newbie but trying to learn.I hope 
this essay helped you.As you see, M$ protection is worst than no protection.I end my essay
with a little poet<BR>
Hey cousin Billy<BR>Hey cousin Billy<BR>Is there anything<BR>That you can do for me<BR> 
</PRE>
<CENTER><I>Thought of the day :M$ programs may one day backfire.</I></CENTER>
<BR>
Greetings: Accz, Bisoux, Eternal Bliss, Fravia+, Jeff, lurk_err, Psychotrn, +Sandman, Tkc, 
T@rnado, and everyone who did teach me (great) knowledge.
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
</PRE>
<BR><BR>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<TR><TD bgcolor="#C6E7C6"><CENTER><FONT size=+2><FONT color=blue>Ob Duh</FONT></FONT>
</CENTER></TD></TR></TABLE><CENTER><I>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a 
   longer period than the allowed one. Should you want to STEAL this 
   software instead, you don't need to crack its protection scheme at all: 
   you'll find it on most Warez sites, complete and already regged, 
   farewell, don't come back.</I></CENTER>

<!-- WAY OUT STARTS HERE -->
<HR><CENTER><I>You are deep inside fravia's page of reverse engineering,  
choose your way out:<BR><BR></I></CENTER>
<BR><CENTER>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"  target="_blank"><img src="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" alt="project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<img src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" alt="bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm"   target="_blank">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html" target="_blank">homepage</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm" target="_blank">links</A> 
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm" target="_blank">search_forms</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm" target="_blank">+ORC</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://www.anticrack.de/fravia/protec.htm" target="_blank">how to protect</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm" target="_blank">academy database</A>
<BR>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm" target="_blank">reality cracking</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm" target="_blank">how to search</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm" target="_blank">java-script wars</A>
<BR>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm" target="_blank">tools</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm" target="_blank">anonymity academy</A> 
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm" target="_blank">cocktails</A>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm" target="_blank">antismut CGI-scripts</A>

<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm" target="_blank">mail_fravia+</A>
<BR>
<IMG src="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"ALT="bulletr.gif" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm" target="_blank">Is reverse engineering legal?</A>
</CENTER>
<HR>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>
