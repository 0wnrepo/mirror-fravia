<html>

<HTML>

<HEAD>

<TITLE>straine1.htm: +HCU Millennium Strainer the road to the strainer</TITLE>

</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 ALINK=#405040 VLINK=#8850AA>

<CENTER>

<FONT size=+2>+HCU Millennium Strainer: 26 July 1999 "Here it is!"

</FONT>

<TABLE>

<TR><TD><CENTER><IMG SRC="ff1.jpg" tppabs="http://www.anticrack.de/fravia/ff1.jpg" alt="hcu.gif" 

ALIGN=BOTTOM WIDTH=300 HEIGHT=415 BORDER=0 VSPACE=0 HSPACE=0></CENTER></TD><TD><CENTER><FONT size=+2>A delayed strainer</FONT><HR width=44%>

<FONT size=+1>

The "Millennium" strainer was plagued by a series of problems, the main ones being the 

long disappearence of +ORC and +Aesculapius and the syn-attacks against my site.

<BR>As usual among us, you will be able to follow, if you are interested, the various 

phases that brought us to the Millennium Strainer (which is NOW ready, but see also "+Aesculapius intents" 

below). You are all allowed to criticize, as Olorin has done, <U>anything</U> that we did/do/will ever do :-) <BR><BR> 



<BR>

<FONT color=red>[</FONT><A HREF="#mille">The Millennium strainer</A> 26 July 1999<FONT color=red>]</FONT>



<HR width=44%>

<FONT color=red>[</FONT><A HREF="#frav">+Fravia's "placeholder"</A> May 1999<FONT color=red>]</FONT>  

<BR>

<FONT color=red>[</FONT><A HREF="#grey">+Greythorne's suggestions</A> May 1999<FONT color=red>]</FONT> 

<BR>

<FONT color=red>[</FONT><A HREF="#olorant">Olorin critics the placeholder</A> July 1999<FONT color=red>]</FONT> 

<BR>



<FONT color=red>[</FONT><A HREF="#fraste">Fravia's and Steinowitz's "placeholder</A> June 1999<FONT color=red>]</FONT>  

<HR width=44%>

<FONT color=red>[</FONT><A HREF="#aescul">ENTRANCE TO THE 1999 +HCU COURSES</A> July 1999<FONT color=red>]</FONT> 

<HR width=44%>

<FONT color=red>[</FONT><A HREF="#voxrant">VoxQuietis critics the "secret pages" concept</A> July 1999<FONT color=red>]</FONT> 

<BR>



</FONT></TD></TR></TABLE>

</CENTER>

</P>





<!-- Aescu two -->

<CENTER><A name="mille"></A>

<HR SIZE="1" NOSHADE>

<H2>THE MILLENNIUM STRAINER<BR>26 July 1999</H2><HR width=44%>

<HR SIZE="1" NOSHADE>



</P><I>Dear readers, I'm proud to introduce the Millennium strainer, for the +HCU 2000 

courses. I know that we are late: due to the problems that are listed elsewhere 

we have had a three-months delay in 

the presentation of the strainer this year. I would tehrefore propose that all your 

answers 

for admission should be presented either to <FONT color=red>+</FONT>Aesculapius, to <FONT color=red>+</FONT>ORC, 

to +Greythorne, or to me  <FONT color=red>BEFORE THE 15 December 1999</FONT>, so that you will have four 

months and two weeks to solve the strainer and we will have some time for the evaluation 

of all results. We hope that +ORC will send his contribute very soon, but we 

will anyway publish the fourth challenge of this strainer before the end of August.

</I></P>

<FONT size=+2>

<A href="millen1.htm" tppabs="http://www.anticrack.de/fravia/millen1.htm">millen1.htm</A>: Presentation of the Millennium strainer by <FONT color=red>+</FONT>Aesculapius

<HR width=44%>

<A href="javascript:if(confirm('http://129.105.116.5/fravia/aescu_mi.zip  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://129.105.116.5/fravia/aescu_mi.zip'" tppabs="http://129.105.116.5/fravia/aescu_mi.zip">aescu_mi.zip</A>: This is the program "aescul.exe": 

a little demonstration of how we can cripple any

debugger even if it runs as a device driver like SoftICE (R), or dwells

in the silicon world as an application-level one, like the rest (except

TRW).</FONT>

<HR>

</P><I>It is not necessary to underline the importance of this strainer and of these 

studies. You know it already very well. I know in particular that protectors awaited 

impatiently a challenge like the first and third ones of the Millennium Strainer: 

"Anti-debugging & Decompiling Techniques". As everything (all valid solutions) will 

as usual be presented in december, both those that took part to the strainer and those 

that could not solve it will benefit from it. Which is good: infact we are interested in the evolution of even more 

good anti-decompiling techniques. So, what can I say more: enjoy!

</I></P>

</CENTER>

<!-- +Fravia's "placeholder" -->

<A name="frav"></A>

<HR width=88%>

<CENTER><H1>Fravia's first "placeholder", May 1999</H1></CENTER><BR><BR>

Fellow reversers,<BR>

I published the "tn3270" strainer-idea, that you'll find <A href="#stra">below</A> on my main messageboard on the last day of April 1999, since 

the +HCU has always published a strainer in April and notwithstanding the disarray for the 

"three caretakers" 

caused by 

the syn-attacks against my site, +gthorne's new daughter and the disappearence of +Aesculapius, 

I wanted to "keep up one of the few reversers' traditions we have".<HR width=44%>Things have changed 

for the better at the moment: my <A href="index.htm" tppabs="http://www.anticrack.de/fravia/index.htm">new fortress</A> is 

holding well against all sort of attacks, and <A href="javascript:if(confirm('http://www.fravia.org/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.fravia.org/'" tppabs="http://www.fravia.org/">http://www.fravia.org</A> will 

be redirected there very soon. +Aesculapius reappeared with lessons and tasks (restricted for +HCUkers) and 

a new <A href="javascript:if(confirm('http://www.netcolony.com/members/hculinux/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.netcolony.com/members/hculinux/'" tppabs="http://www.netcolony.com/members/hculinux/">+HCU Linux</A> page is developing nice thank to +Rezident. Moreover, 

consider the following as just one of the  

"possible" strainers.<HR width=44%>

As you all know the intent of the +HCU is NOT to form a 'cracker' group. Our little "+" don't mean at 

all that we are "better" than anyone else, in fact there are excellent 

reversers in many groups that 

could teach us quite a lot, if they cared to. Yet we strive for knowledge and 

we spread reversing knowledge like 

few others do, following old +ORC's tradition and steps. Our aim

is simply to put together, somewhere on the web,  

protectors, coders, reversers and crackers of a specific kind: people able not only 

to learn <U>but also to teach</U> all the many techniques 

that can be useful in this more and more electronic life of ours. Secret codes with secret meanings 

abound more and more, as 

we very well know, and 

not only inside software. It is time to reverse at least some of them, it is time to explain, and 

it is always time to learn. Building on the shoulders of 

each other we will go forward, reversing more and more, 

learning and explaining, teaching and understanding, 

towards what I hope will be 

a better world, or at least a world we will understand better.<BR>

fravia+ May 1999

<!-- +Greythorne's suggestions -->

<A name="grey"></A>

<HR width=88%>

<CENTER><H1>+Greythorne, May 1999</H1></CENTER><BR><BR>

regarding the strainer idea in itself

<BR><BR>

i noticed it was mentioned that people working together made not a good strainer

<BR><BR>

what needs to be noted is that my suggestion was that people submit strainers - and then after they are all in, then graded and members allowed in, THEN AND ONLY THEN are the hcuers to collaborate and make a combined project out of it

<BR><BR>

now this of course assumes that people are working on the idea and not deciding that this is not a good strainer

<BR><BR>

and no mammon_ i wasnt stealing your idea ;) i found it in a macro virus actually as well - it was a dropper that echoes to debug.com just like you do (but i agree 100% that to steal it is not doing ones own work ;) *poke poke!*

<BR><BR>

what i want to see are people who want to get into areas they have not before truly mastered, in order so that the corporate world does not run the lives of us all

<BR><BR>

this is why the hcu exists in the first place

hacking and cracking are both in the agenda from day 1 (just read some of +orc's propaganda.. quite humourous and a bit much at times but getting past that, the point was made) --- reversing big brother requires more than 'jnz/jz good code' but getting around the machines and software remotely as well as the ones on your desks

<BR><BR>

personally, i would love to see some ideas as well - i am open to the idea of someone coming up with a project idea, planing it and attacking it (for those of you who have been to grad school you may be familiar with the idea)

<BR><BR>

this means that it has to be ratified by the hcu of course

<BR><BR>

the reason i suggest this is that sometimes there are great ideas that are missed, and also there are topics that as you may guess from reading the other messages on this topic - may not be interesting to the people posting for whatever reason

<BR><BR>

instant access was a rough one - i definately agree, and i for one spent months working on it when i had the chance -- part of which because it wasnt exactly the clearest english for that matter but then technical documents are never extremely clear anyhow

<BR><BR>

in another life i might have been a linguist rather than a computer type, but then thats why i write well, and tend to not get the greatest 'grades' on my technical drafts -- to much clearer to read than the professorial types like (if it's readable it doesnt belong in a computer science classroom...)

<BR><BR>

but anyway, i would love to see some ideas, and i would also love to see what comes of the original strainer idea posted above

<BR><BR>

much of the reason hcu has been slow going lately is communication - finally 

egroups has fixed their size problem and we can now use it for hcu mail lists 

(some lists being the primary method we have been using until these last few 

months when servers changed and well, now things are automated in such a way 

that time can again be on our side)

<BR><BR>

it takes work to make an organization live, and though that term applies loosely to hcu - which is made up of lone wolf types with a desire to learn, members do need to think of challeneges

<BR><BR>

if i were to make the most of a suggestion to those of you who are new and wish to get better at cracking, and in preparation for hcu classes, GET FAMILIAR WITH WIN32 ASM - if you can write programs in it, you have a serious step up on cracking win32 apps. So much has happened lately to make this easy, that it is important to learn it.

<BR><BR>

well, before i go into anything else, and before i have any more coffee, i am done for now 8^)

<BR><BR>

please post any responses on fravia's main messageboard, i would love to hear your ideas - or get on the hcuml and post there, the list is only newly running again and it takes usually a few weeks to get back on track

<BR><BR>

+Gthorne 



<!-- Olorin's critics -->

<CENTER><A name="olorant"></A>

<HR SIZE="1" NOSHADE>

<H2>Olorin's critics</H2><HR width=44%>

<FONT size=+1>Quite a negative judgment of fravia's and Steinowitz proposal :-(<BR>As you will read below, 

+Aesculapius is preparing the "real" Millennium strainer, so we will see what we do with this 

proposal of ours. I still think, Olorin notwithstanding :-) that meddling with the TN3270 

protocol is quite an interesting 

endeavour... raeders will judge!</FONT>

<HR SIZE="1" NOSHADE>

</CENTER>

<BR>

Disclaimer - This is only opinion, although it contains references useful to anyone attempting

the strainer.<BR><BR>Firstly, what has been set is nothing more than an over elaborate

implementation of back door programs such as Back Orifice, NetBus and Unix rootkits.<BR><BR>The

remote execution section totally relies on the ability beforehand to either trick a user into

running a trojanned program, or having access to the computer beforehand.<BR><BR>What is

REserver.exe and REclient.exe other than BOserver.exe and BOclient.exe with a tn3270 added on for

no particular reason. "Use the TN3270 protocol for this and you'll be able to use this as a full

shell account! And you don't need passwords to verify your access to the server" - Oh wow.

Unlimited access without passwords. That sounds just like the rootkits that any decent security

site carries, eg packetstorm, before antionline shut them down. Luckily for antionline, they got

a copy of all the files first, at <A href="javascript:if(confirm('http://www.anticode.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.anticode.com/'" tppabs="http://www.anticode.com/">www.anticode.com</A>. You

can find rootkits and telnet servers to sit on a port there.<BR><BR>Using previously configured

associations between a web browser, windows, and the command line represents little more than an

overly complicated set of interfaces, better suited to a GUI or simply executing the

client.<BR><BR>Rewriting a tn3270 client, an interface developed for IBM mainframes from scratch

has bugger all to do with reverse engineering and nothing to do with good programming practice.

Save yourselves the trouble, and checkout <A

href="javascript:if(confirm('http://www.geocities.com/SiliconValley/Peaks/7814/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.geocities.com/SiliconValley/Peaks/7814/'" tppabs="http://www.geocities.com/SiliconValley/Peaks/7814/">http://www.geocities.com/SiliconValley/

Peaks/7814/</A> for a windows client with complete source, and <A

href="javascript:if(confirm('http://www.hgsys.demon.co.uk/linux.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.hgsys.demon.co.uk/linux.htm'" tppabs="http://www.hgsys.demon.co.uk/linux.htm">http://www.hgsys.demon.co.uk/linux.htm</A> for a

linux client and source.<BR><BR>For further information about tn3270, checkout <A

href="javascript:if(confirm('http://www.tn3270.com/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.tn3270.com/'" tppabs="http://www.tn3270.com/">http://www.tn3270.com/</A> or <A

href="javascript:if(confirm('http://www.cisco.com/univercd/cc/td/doc/cisintwk/dsgngde/tn3270/tndg_c2a.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.cisco.com/univercd/cc/td/doc/cisintwk/dsgngde/tn3270/tndg_c2a.htm'" tppabs="http://www.cisco.com/univercd/cc/td/doc/cisintwk/dsgngde/tn3270/tndg_c2a.htm">http://www.ci

sco.com/univercd/cc/td/doc/cisintwk/dsgngde/tn3270/tndg_c2a.htm</A><BR><BR>Hmmm, to make things

tricky, lets throw in a little regular expression and pattern matching. Yawn.<BR><BR>The three

sections on different interfaces, javascript, perl and c are nonsensical. If a person had access

to to a remote workstation just once, why would you install a tn3270 server? On a non-standard

port? Just install the personalized version of BO2K. Virtually each server is unique, running on

a different port with a different protocol, and responding to different types of encryption and

pass-phrases. Nothing is defaulted.<BR><BR>The last section - The only part to have any real

reversing content, taking telnet.exe and adding in the ability to parse the commandline so that

not only the host and port are recognized, but an optional extra parameter that represents the

command to be executed. Hmmmm telnet to a telnet server, and execute a command. BUT *and this is

the tricky bit* put that command on the command line. Oh, and do it purely in assembly while

working with a pre-built executable. That'll be some patch.<BR><BR>Since when did the HCU become

a bunch of extremely inefficient hackers, writing ridiculously over complex back doors and

trojans?<BR>

<BR>

<BR>

mailto:olorin(at)netlink(dot)com(dot)au





<!-- fravia's and Steinowitz's placeholder -->

<CENTER><A name="fraste"></A>

<HR SIZE="1" NOSHADE>

<H2>+HCU Millennium Strainer ~ Part 1</H2><HR width=44%>

<H1>Remotely Executing on the Web</H1>

<HR SIZE="1" NOSHADE>

</CENTER>



<CENTER><H1>Steinowitz (and fravia+), May 1999</H1></CENTER><BR><BR>



<H3>Introduction</H3>



<P>Since fravia+ is very busy with rebuking the attacks

on fravia.org, he asked me to write down how the

Millennium Strainer should be. Both fravia+ and I think

that Reverse Engineering on the web is the future,

therefore, this strainer is about Remotely Executing.

While cracking software appz is done by the dozens of

crackgroups which exist at the moment, elite reverse

engineers like +HCUkers should move on to where the

future is: the Internet.</P>



<P>Because of this, the +HCU strainer should not only

test your reverse engineering skills. An elite reverse

engineer needs knowledge of coding, reverse

engineering <I>and</I> the Internet. This strainer

requires you to know quite a lot about all three.

Let's proceed with the assignment!</P>



<H3>Remotely Executing</H3>



<P>The main objective of this strainer is to make it

possible to run any executables you choose on a target

machine where you have had access. Let me explain to

you how this should work.</P>

<P><UL>

<LI>To make it possible to run any executables on a

target machine, you should write two executables

(REserver.exe and REclient.exe).

<LI>Write these executables in C, using ANSI C

functions where possible to make your programs as

portable as possible.

<LI>REserver.exe should run on the target machine,

accept any connections requested by REclient.exe and

then execute what REclient.exe orders.

<LI>REserver should then catch the output of the

program (and the exit code of the program) and send it

back to REclient which shows it to the user.

<LI>When you enter tn3270:// in your browser's address

textbox, Windows will automatically start Telnet.

<LI>The TN3270 protocol is a rarely used telnet-like

protocol, invented by IBM.

<LI>Re-associate the protocol with REclient.exe.

<LI>Then, REclient.exe should be executed by entering

the following:<BR>

<I>tn3270://212.212.75.75/C.d.bBatchfiles.bRun.2Ebat</I><BR>&nbsp;&nbsp;&nbsp;&nbsp;(which

would run 'C:\Batchfiles\Run.bat' on a Windows system

212.212.75.75)<BR>

<I>tn3270://myserver.com/.sbin.scat.20.setc.spasswd</I><BR>&nbsp;&nbsp;&nbsp;&nbsp;(which

would run '/bin/cat /etc/passwd' on a UNIX system

myserver.com)

<LI>Decoding/encoding works like this: slashes (/) are

replaced with .s, backslashed (\) are replaced with

.b, colons (:) are replaced with .d, all other special

characters (non-alphanumerical) are replaced with a

dot followed by their hexadecimal ASCII codes (for

example, a point becomes .2E and a space becomes .20).

<LI>REclient should decode the argument passed to it

by the browser, connect to REserver running on the

target machine and make REserver start the executable

requested by its user.

<LI>Find the specifications of the TN3270 protocol and

implement it in both your server and client.

<LI>If you managed to do all this, you should proceed

implementing another function. Before, I only talked

about catching the output of a program and sending it

to the client, but what when I want to run /bin/bash

or command.com? Indeed, we should also allow users to

provide information (or new commands in case of a

shell) to the executables running on the target

machine. Use the TN3270 protocol for this and you'll

be able to use this as a full shell account! And you

don't need passwords to verify your access to the

server (providing REserver.exe is running)!

<LI>REserver should be able to handle more than one

connection at the same time (with a maximum of 10).

<LI>Think about how you can make sure that REserver is

always running on a target machine! Think about adding

a RunServices key to the Windows registry. Besides,

for UNIX systems, you could write a sh script which

checks if REserver is still running. Set a crontab for

this sh script and you're settled even when your UNIX

restarts!

<LI>Don't forget to implement decent error trapping

routines!

</UL></P>



<P>A complete solution should at least cover solutions

for both Windows 95/98 systems <I>and</I> UNIX

systems. Read 'Portability' for more info on this.</P>



<H3>Web-interfaces</H3>



<P>After coding all this and testing it well, it's

obvious that this isn't as easy-to-use as it should

be. What we need are a couple of decent interfaces

which make it really easy for users to use REclient.

Encoding commands like the examples I gave is easy to

do, but I don't want to be forced to look up the

hexadecimal ASCII codes for all kinds of special

characters. Let's describe a couple of interfaces you

should make it you want to do it perfect. I would

waste time if I would explain to you why these

interfaces should be web-interfaces. :-)</P>



<P><B>Interface 1 - JavaScript</B></P>



<P>If you don't know how to make webpages with

standard HTML tags: learn it right now! Don't you dare

to use M$ FrontPage (or any other WYSIWYG HTML editor)

for this assignment, because that would be a serious

insult. :-)<BR>

Notepad or pico/gvim is good enough for our

purposes!</P>



<P>Alright, write a webpage where a user could enter

1) hostname/IP of the target machine and 2) the

executable which REserver should start. When this user

clicks the button, a JavaScript function should encode

hostname/IP and command to execute in the URL format I

explained earlier:

tn3270://target_machine/encoded_command. Change the

browser's location to this new URL and your

REclient.exe will do what it should do... (If you

re-associated the TN3270 protocol with it!) 



<P><B>Interface 2 - Perl</B></P>



<P>Write a Perl CGI script which does exactly the same

as the JavaScript page described above. Don't forget

that it should be a CGI script! (Thus: it shouldn't be

executed as a program from your command prompt. If you

don't have installed Perl on your local workstation,

you could install your script on a webserver where you

have CGI permissions. Don't forget that you'll still

need REclient.exe installed on your local

machine!)</P>



<P><I>Note</I> If you're a real +HCUker, you also

write Perl scripts which do exactly the same as

REserver.exe and REclient.exe! Believe me, that it's

easy if you finished your C version and know something

about the differences between C and Perl!</P>



<P><B>Interface 3 - C (again)</B></P>



<P>Last, but not least, one more web-interface. As a

matter of fact, this one isn't just an interface. This

one should be both web-interface <I>and</I> REclient

in one. I think you already understand what I mean

with this. No? Ok, read on and you'll understand!</P>



<P>I started this essay writing that the Internet will

become more and more important for all elite reverse

engineers who want to keep up with the best.

Therefore, for those who don't already know all about

this, it's getting time to learn everything about CGI

programming. Remember: you can't reverse engineer if

you can't engineer! Why did you learn coding in

assembly? Indeed, you couldn't reverse engineer

without it! That's why this strainer also requires you

to know quite a bit about the Internet and CGI, a.k.a.

Common Gateway Interface. And since most servers are

UNIX-based platforms, it's also getting time for all

those Bill Gates-people to shutdown Windows, restart

with some UNIX platform and see how long a system can

be stable without restarting at all!</P>



<P>Remotely executing whatever you want sounds good,

but remotely executing whatever you want by ordering a

remotely hosted client to arrange this sounds even

better! I really hope you can follow my deep thoughts.

If you don't: get a glass with your favourite

cocktail, sit back and relax, enjoy your drink and

think about it. Believe me: it'll work! :-)</P>



<P>For those who didn't already understand: write a

CGI program in C which provides your with a

web-interface. When you enter data in the

web-interface and submit it, the CGI program should

behave as it were REclient.exe. All output should be

correctly formatted HTML code. This CGI program should

be installed on a webserver where you have CGI

permissions. To prevent unauthorised users from using

this interface, you should implement a password

protection. Write another CGI program in C which the

system administrator (you) can use to add/remove users

to the user list. Passwords should always be stored 

in an encrypted format.</P>



<P>An example.<BR>

When I'm allowed to login on a UNIX system called

target.com only once, I can upload the source of

REserver, compile the program and run it. At that

point, I have unlimited access.<BR>

I installed the REinterface CGI program I wrote in C

on my ISP's server, www.myISP.com. I can now access

this by surfing to

http://www.myISP.com/~switz/REinterface. A nice

interface appears on my screen. I enter the name of

the target machine, target.com. I also enter the

command I want to run on the target machine: '/bin/cat

/etc/passwd'. Furthermore, I enter my login name and

password. After I did all that, I click the button. A

couple of moments later, the output appears on my

screen: the contents of the file /etc/passwd! (And, of

course, if the system admin of target.com configured

his system well, I will only see 'No access to

/etc/passwd' or an almost empty (shadowed) password

file, but our REinterface and REserver work fine and

that's the main point!)</P>



<P><I>Please note:</I> This REinterface sure is a nice

piece of web engineering, but you <I>cannot</I>

provide any input to the executable after it started.

For example, you can't provide any commands to

'/bin/bash' or 'command.com' after you started it! A

large benefit of this interface is that you don't need

to install REclient.exe on your local machine: you can

use this interface from wherever you are, provided

that you have access to the Internet.</P>



<H3>Reversing M$ Window$ Telnet</H3>



<P>When you are able to accomplish everything above,

you have proved that you have knowledge of both coding

and the Internet. But you're not ready yet, no way! A

Millennium Strainer isn't something which you solve in

a couple of days! Take your time...</P>



<P>Some time ago, I wrote that telnet.exe is the

program normally associated with the TN3270 protocol.

Well, how about using that?? Notepad.exe has been the

target of many reverse engineers: I have seen several

Notepads with added functionality. I think that the

standard M$ Window$ 95/98 Telnet executable is at

least as interesting: a full reverse might be a very

good exercise. However, that's not the objective of

this strainer. Combine the section 'Remotely

Executing' with what I just wrote and you'll

understand what you're to do next.</P>



<P>When you arrive at this point, you already have

written REclient.exe and you have written several

web-interfaces. But there's one more client we want:

use your reverse engineering skills to create a client

out of telnet which you can use in combination with

the same REserver as you used in all cases before.

Yes, you're totally right when you conclude that you

only have to code one server, but quite some

interfaces/clients. :-)</P>



<P>Dive deep into telnet.exe. All code needed to

communicate with a target machine is already

available, but where is the code you need to modify?

Micro$oft helped you a great deal by leaving so much

wasted space in the executable: there's quite some

room to add your own code. However, I wouldn't be

surprised if it would be necessary to add more.</P>



<P>Here are some ideas about what you could try to

achieve with telnet.exe.</P>



<P><UL>

<LI>Don't associate the TN3270 protocol with

REclient.exe. Instead, modify telnet.exe in such a way

that it starts REclient.exe when telnet is started

with an argument starting with tn3270://. (Telnet

immediately closes.) It's not an efficient way of

associating the TN3270 protocol with REclient, but it

proofs that you know something about reverse

engineering. When telnet is started with a normal

telnet:// argument, normal communication should

follow.

<LI>You could also try to make telnet.exe work as

REclient.exe. As I said before: many functions

necessary for communication are already present.

(Check out the differences between the telnet and

tn3270 protocol if you managed to implement the tn3270

protocol in your REserver!)

<LI>When you try to make telnet.exe work as

REclient.exe, you could choose to replace functions

not needed anymore. But you could also choose to keep

it possible to use telnet.exe as your 'normal' telnet

client.

<LI>Finally, I always find it very annoying that

telnet.exe only knows a couple of 'standard' ports:

telnet, daytime, echo, qotd and chargen. Get a list

with standard ports and add those ports of which you

think they are useful to add. (Don't forget to add the

port of your REserver! And don't forget that

connecting to that port doesn't work like a normal

connection!)

</UL></P>



<P>The more you do, the better! Just do what you think

you are able to do. The other parts of the Strainer

are pretty straight-forward. You should use your

imagination (and Zen skills!) with this part: think of

what <I>you</I> think would be a nice change to

telnet.exe, as long as it is related to the rest of

the Strainer!</P>



<H3>Essay(s)</H3>



<P>Since it's almost getting time for you to start

with this assignment, I'll mention a couple ideas of

things you could do to achieve a better final result.

When you send in your results of this assignment, only

sending (commented!) source codes, binaries and

scripts isn't enough. <I>Why</I> did you do what you

did? And <I>how</I> did you do it? Answer those

questions in one or more essays about the development

of your results. And since we may assume that you

don't develop your final 'product' out of nothing, it

probably wouldn't be a bad idea to include some

pre-final versions of your programs. Think about

it!</P>



<H3>Portability</H3>



<P>I already mentioned that you should at least make

it possible to compile REserver and REclient (and

REinterface!) under both UNIX and Windows. To make

your programs that portable, you need to use ANSI C

functions as much as possible. There are some

functions, however, which you'll need, but are not

portable. Since we don't want multiple versions of

source and header files for Windows and UNIX, you'll

have to think of something else. The solution is easy:

use some preprocessor directives and a Windows/UNIX

flag....</P>



<P>Since there are always differences between C

compilers, it could happen that you were able to

compile your executables under both Windows and UNIX,

but anyone else trying to do the same (with another

compiler) could have troubles compiling. To avoid

this, don't forget to mention which compilers and

operating systems you used. Include all version

numbers!</P>



<H3>Last words</H3>



<P>I already wrote this before, but I can't repeat it

often enough: the more you do, the better.

Furthermore, you should work slow and basic. Don't try

to do everything at once, because you won't succeed if

you do it that way. Completing an assignment like this

requires knowledge, patience and a little Zen. But I

think it's even more important to show that you are

willing to learn and that you're capable to do so.</P>



<P><I>A journey of a thousand miles is started by

taking the first step.</I><BR>

-- Chines proverb</P>

<P><I>Civilisation advances by extending the number of

important operations we can perform without thinking

about them.</I><BR>

-- A.N. Whitehead</P>



<P>After these wise words, there's not much left to

say. You should solve and send in the strainer before

mid-September, as usual. If you think you're ready

before September, I really think you haven't done

enough, even if you did everything I mentioned in this

essay. There's so much else you could do to make it

even better! (Think of a good name for your project!)

Use the time you have!</P>



<P>I'm really anxious to see the results: I can hardly

wait till fravia publishes the results on his website.

(That will take some time though.) In the mean time,

I'll see if I have enough time to complete this

assignment myself...</P>



<B><P>Good luck,</P>



<P>+fravia and Steinowitz</P></B>



<P><HR SIZE="1" NOSHADE>

<FONT SIZE="-1">Mail +fravia at

fravia_(at)yahoo(dot)com if you have any questions

concerning this +HCU Remote Execution Millennium

Strainer.</FONT></P>





<!-- Aescu one -->

<CENTER><A name="aescul"></A>

<HR SIZE="1" NOSHADE>

<H2>Master +Aesculapius intents<BR>16 July 1999</H2><HR width=44%>

<HR SIZE="1" NOSHADE>

</CENTER>





fravia+ wrote:

<BR><PRE>

&gt; By all means, +Aescu.

&gt; The surrogate of a strainer I have posted on my site

&gt; was just intended as a "place-holder".

&gt;</PRE>

<BR><BR>

    I'm glad; you'll have the strainer in one week

(maybe less than that) because I

need to polish some minor aspects of it. The targets

will be: Challenge 1: CodeSafe v.

3.1, Challenge 2: CuteFTP v. 3.0.2, Challenge 3:

Restorator 2.5 (possibly, I'm still

thinking on this one), Challenge 4: I'm thinking in

leaving this space empty with a

note to +ORC in case he wants to contribute, if he

doesn't answer I'll include a fourth

target (Cdrwin 3.7d).

<BR><BR>

    Challenge 1 will require knowledge in PE header

layout, Structured Exception

Handling, Debug API Set and SoftICE detection tricks.

<BR><BR>

    Challenge  2: Undefeated until now. Server

authenticated. It will require knowledge

on WSA, CRC, and internet protocols.

<BR><BR>

    Challenge 3: Tough target and a great tool.

<BR><BR>

    Challenge 4: CDRWIN 3.7d (if +ORC does not send 

any contribution 

or any of +you doesn't want to

propose an alternative target). Cdrwin key system has been defeated

by only two crackers in the world

after 4 years of attempts (I was the first one, the

other guy is retired from

cracking).

<BR><BR>

    So the strainer is tough, but not that tough and

it will explore almost every

attribute a cracker worth of entering the +HCU should

have. Internet use will be

explored too.

<BR><PRE>

&gt;

&gt; If you want to start, beside sending me the new strainer

&gt; (we'll postpone the admission frist  accordingly), 

&gt; you could send me your first lesson for the '99 levy: I'll

&gt; open a password protected part of my fortress so that +Hcukers

&gt; only (or almost, but those that will anyway find their way

&gt; there will be also pretty good AFAICJ :-) will thus partecipate

&gt; and give their precious feed-back. If you prefer an emaillist 

&gt; approach just tell me, I'm sure that +Zero and +Malattia 

&gt; would gladly take care of that.

</PRE>



    Whatever, the page with password and participation

of some important personalities

(not necessarily all of them belonging to the +HCU) is a good

idea.<BR>

    I'll send you my first lesson in about two days

(it is ready, but I need to polish the

preface text).

<BR><PRE>

&gt;

&gt; Happy to have you back on board.

&gt; Lotta things to do.

&gt; Let's sail and reverse along!

&gt;

&gt; Later, +brother

&gt; fravia+

&gt;

</PRE>

    nice to see you too...

<BR><BR>

cya<BR>

+Aesculapius.<BR>



<HR width=22%><CENTER><FONT size=+2>20 JULY 1999</FONT><BR>

Here <A href="goto99co.htm" tppabs="http://www.anticrack.de/fravia/goto99co.htm">goto99co.htm</A> the <FONT color=red><B>entrance</B></FONT> to the +HCU 1999 courses, by 

<FONT color=red>+</FONT>Aesculapius and other older ones :-)



</P>







<!-- VoxQuietis' critics -->

<A name="voxrant"></A>

<HR SIZE="1" NOSHADE>

<FONT size=+3>VoxQuietis' critics</FONT> (July 1999)<HR width=44%>

<BR><FONT size=+1>An intersting point: secrecy as cause of decline. I partly agree, 

with VoxQuietis, actually. I think I don't need to demonstarte that I don't 

like at all the idea of keeping any sort of 

knowledge "inside a box". Unfortunately we have until now found no other 

way to <U>speed up</U> work on some 

'delicate' matters without giving at the same time ammunitions for 

the lamest sort of hacking & cracking to all the "script lamerkids" out there. 

Actually the "strainer" idea itself - take a look at <A href="millen1.htm" tppabs="http://www.anticrack.de/fravia/millen1.htm">this 

year strainer</A>, for instance - is IMO 

a good way to go public <U>and</U> keep restrict AT THE SAME TIME.</FONT>

<HR SIZE="1" NOSHADE>

</CENTER>

<BR>

<BR>

Dear reversing colleagues, <BR><BR>There is a long thread on accessing the "secret" HCU

pages,<BR>which proves a vast interest in the topic, irrespective of <BR>the fact that some

people, which are insiders of course,  <BR>are quite reluctant having such a topic discussed

here. <BR><BR>Nevertheless the interest is here, as the previous discussion <BR>shows, and, in my

opinion, it is a interesting one, since <BR>quite a couple of things are treated, that all the

visitors <BR>of this messageboard are interested in: <BR><BR>The HCU pages are supposed to

contain information on S/W <BR>reverse engineering. They are hidden. So the basic insticts <BR>of

every reverser around will be trigged by the mere presence <BR>of these pages. <BR><BR>On the

other hand one should ask oneself, what is the actual <BR>matter of both the HCU pages, this

year's strainer, and a <BR>possible hacking of the HCU pages? And that's were reflection

<BR>comes in, which here usually is called "reality cracking". <BR><BR>I think we all could agree

that "cracking" or "S/W reverse <BR>engineering" more or less is targeting on the inner working

<BR>of your own computer. Maybe there is a little bit of warez <BR>stuff, too. But in the long

run, people are studying at <BR>Fravia's, or at HCU, since they are compelled by the

<BR>undercover actions of S/W, e.g. by M$ mm256.dat or word <BR>unique user ID. And of course

there is the fascination of <BR>exploring the way someones computer works. <BR><BR>It should be

clearly stated, that this interest is very much <BR>different from the classical "hacker", who

usually gets is <BR>satisfaction from sniffing inside remote computers. Thus the <BR>hacker is

more interested in transmission protocols than in <BR>recovering S/W flow of operation.

<BR><BR>And that's the point, where this year's strainer comes in: <BR>Fravia's challenge is much

more hacking oriented than all <BR>the strainers were in the past. To put it bluntly, the 1999

<BR>strainer will attract a person interested in hacking more <BR>than ever. Thus it should be

obvious, that hacking the <BR>HCU pages directly, i.e. without solving the strainer, <BR>becomes

an attractive solution. <BR><BR>But still the question is not answered, what would be the

<BR>price of hacking the HCU pages, i.e. what kind of information <BR>will be located within the

essays/courses. Well, its easy <BR>to speculate on that, but who does really know ...<BR><BR>The

principle of sharing knowlege ultimately would demand <BR>to publish all the essential

informations. And it would <BR>ask for a quick publication, because even to withhold

<BR>information temporarily finally would damage the ethic <BR>constitution of this community.

<BR><BR>So it is evident, that secret information in the long run <BR>would give the root of

declination of the HCU. Of course <BR>actually there are no signs that things allready started

<BR>to move to this direction. But whenever there are things <BR>kept away from the public's

eyes, there is an inherent <BR>danger of something I'd like to call the "Freimaurer-syndrome".

<BR>Remember that the Freimaurer long time ago tried to advance <BR>democracy (or at least some

democratic issues, as free <BR>speech) within secrecy. We all know, where this approach

<BR>ended. And we all know, that it due to the internal construction <BR>needed to end like it

did. <BR><BR>Best regards<BR>VoxQuietis<BR>

<BR>



<HR><CENTER>

<I>You'r deep inside fravia's pages of reverse engineering</I>

<BR><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=CENTER WIDTH=88% HEIGHT=6 BORDER=0

VSPACE=0 HSPACE=0><BR><BR>

<!-- Begin Javascript relocator <font color=red>~</fonT> Javascript code by fravia+ -->

<FORM name="FraviasForm">

<SCRIPT LANGUAGE="javascript">

<!--



function FravPage(list) {

	      location.href = list.options[list.selectedIndex].value

}



// -->

</SCRIPT>

<DIV align="center">



<P center="&lt;center&gt;&lt;/center&gt;">&nbsp;<SELECT name="fraviale" size="1">



<OPTION>Choose another page!</OPTION>

<OPTION value="index.htm">Main page</OPTION>

<OPTION value="academy.htm">Software reversing Lab</OPTION>

<OPTION value="realicra.htm">Reality cracking Lab</OPTION>

<OPTION value="noanon.htm">Anonymity Lab</OPTION>

<OPTION value="ideale.htm">Site busting Lab</OPTION>

<OPTION value="howtosea.htm">How to search Lab</OPTION>

<OPTION value="sealight.htm">--Search engines (light)</OPTION>

<OPTION value="searengi.htm">--Search engines (heavy)</OPTION>

<OPTION value="links.htm">Links</OPTION>

<OPTION value="tools.htm">Tools</OPTION>

<OPTION value="javascri.htm">Javascript reversing</OPTION>

<OPTION value="screamin.htm">Screaming truth</OPTION>

<OPTION value="entran.htm">Main entrance</OPTION>

<OPTION value="new_what.htm">What's new on fravia's</OPTION>

<OPTION value="info.htm">Mail fravia+</OPTION>

<OPTION value="http://greythorne.home.ml.org">+Greythorne's</OPTION>

<OPTION value="http://www.InsideTheWeb.com/mbs.cgi/mb186724">Tools of our trade msgboard</OPTION>

<OPTION value="http://www.InsideTheWeb.com/mbs.cgi/mb155985">Main msgboard</OPTION>

</SELECT>



<INPUT type="button" value="Let's go!" onclick="FravPage(this.form.elements[0])">

<BR>

</DIV>



</FORM>

<!-- end Javascript relocator -->

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=88% HEIGHT=6 BORDER=0

VSPACE=0 HSPACE=0><BR><BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage </A><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0>

<A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links </A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>

<A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity </A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC </A>



<IMG

SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays </A>



<IMG

SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database </A>



<IMG

SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="botstart.htm" tppabs="http://www.anticrack.de/fravia/botstart.htm">bots wars</A>



<BR>

<IMG

SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut </A>



<IMG

SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13

BORDER=0 VSPACE=0 HSPACE=0><A

HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13

BORDER=0 VSPACE=0 HSPACE=0><A

HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms </A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia </A><BR>





<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering illegal?

</A></CENTER>

<HR size=4></FONT></CENTER></CENTER>





</BODY>

</HTML>