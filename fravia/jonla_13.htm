<HTML>



<HEAD><!--  formamus.htm version 02 February 1998 

      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

      SEARCH THIS TEXT FOR THE STRING "Your_" 

      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

      THANKS A LOT: this will allow automated retrieval -->



<TITLE>jonla_13.htm: BEGINNERS: A key-gen for AddItem</TITLE>

</HEAD>



<BODY BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22" WIDTH="100%">

  <TR>

    <TD>&nbsp;</TD>

    <TD><P align="center"><BIG>BEGINNERS: KeyGenerator for AddItem</BIG><FONT size="+1">:<BR>

    - Turning a *NAG* in to a keygen!</FONT> </TD>

    <TD><P align="center"><A href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG 

    SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif"

   ALT="student" ALIGN="CENTER" WIDTH="114"

    HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></A> <BR>

    <FONT color="gray">Not Assigned</FONT> </TD>

  </TR>

  <TR>

    <TD bgcolor="#FFFFEA"><P align="center"><FONT COLOR="890000">

 12 February 1998 </FONT></TD>

    <TD bgcolor="#FFFFEA"><P align="center">by <FONT size="+3">

 Jon</FONT></TD>

    <TD VALIGN="center" bgcolor="#FFFFEA">

 </TD>

  </TR>

  <TR>

    <TD><P align="center"><A href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG

    SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" BORDER="0"

    VSPACE="0" HSPACE="0" width="13" height="13"></A></TD>

    <TD BGCOLOR="898030"><P align="center">Courtesy of Fravia's page of reverse engineering </TD>

    <TD BGCOLOR="898030"><P align="center"> <PRE> </PRE></TD>

  </TR>

<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->

  <TR>

    <TD><FONT color="#C4C0CF">fra_00E4<BR>

    980212<BR>

    Jon<BR>

    0000<BR>

    NA<BR>

    XX<BR>

    </FONT></TD>

    <TD><P align="center"><I><!-- Your truly+ comments -->Well, as anyone knows we are 

not so much favourable to the publishing of key generators, why the hell 

should we allow all lamers of the planet to use stolen software? Yet in this case it's 

the protection scheme itself that is 'reversed' (changing a SINGLE byte) and used as a keygenerator... 

a nice essay for beginners, by Jon. 

Very useful for those among you that DO NOT KNOW how to work with Softice in 

order to fish simple echos. A useful lesson for shareware programmers as well, clearly the

idea of pushing a "not valid registered number" location that can be turned into a "valid registered number" 

location changing a single byte is ludicrous to say the least.<BR>

This is an essay for beginners (almost for NEWBYES) yet it may be enjoyed by any reverser</I></CENTER></TD>

<TD><CENTER>Related:<BR><BR>

<A href="progcor.htm" tppabs="http://www.anticrack.de/fravia/progcor.htm"><IMG SRC="useful.gif" tppabs="http://www.anticrack.de/fravia/useful.gif" ALT="+prog cor" ALIGN=BOTTOM 

WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></A><BR>

<FONT color=gray>Programmers'<BR>corner</FONT></CENTER>

</TD>

</TR>

  <TR>

    <TD>&nbsp;</TD>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

    <TD BGCOLOR="898030"><P align="center"><B>There is a crack, a crack in everything That's

    how the light gets in</B> <!-- Leonard Coehn's old song, because we are poets, not only crackers --> </TD>

    <TD>&nbsp;</TD>

  </TR>

  <TR>

    <TD VALIGN="MIDDLE" bgcolor="#C6E7C6"><P align="center"><FONT color="blue">Rating</FONT> </TD>

    <TD VALIGN="MIDDLE" bgcolor="#C6E7C6"><P align="center"><FONT color="blue"><!-- CHOOSE A RATING (may be changed) --> (x)<B>Beginner</B>

    ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT> </TD>

    <TD bgcolor="#C6E7C6"><!--<center><font color=red>NEWBYES</fonT>

</center>--></TD>

  </TR>

</TABLE>

<!-- END HEAD  -->



<P><BR>

Useful for beginners, who haven't discovered the ease of &quot;fishing&quot; serials with

SoftIce yet. I'll also show how to crack &quot;creative&quot;: Turning a <STRONG>*NAG*</STRONG>

in to a key-gen!</P>



<HR>

<FONT SIZE="+2"><!-- CHOOSE A TITLE (wont probably be changed) -->





<P align="center"></FONT><BIG>KeyGenerator for AddItem</BIG><FONT size="+1">:<BR>

- Turning a *NAG* in to a keygen!</FONT> <BR>

<FONT COLOR="0B7FC1"><!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by Jon</FONT><BR>

</P>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT SIZE="+2"><FONT color="blue">Introduction</FONT>

    </FONT></TD>

  </TR>

</TABLE>



<PRE>Greetings, all!



Today, I'll crack several nice little programs, all made by the shareware 

programmer Firas El-Hasan. His programs are all nice Window$-utilities,

that are pretty useful. But unfortunately they all have a <STRONG>*NAG*</STRONG> at launch,

which is really annoying, considering that the programs are probably all

made within a couple of hours...

The programs are:



<U>SysDate</U> - A program which shows you the day of the month in the system tray.

<U>StartClean</U> - Cleans shortcuts, that points to nonexisting files.

<U>SysLaunch</U> - A &quot;lite&quot; version of the start menu, for fast access of your

favorite apps.

<U>QuickDesk</U> - Minimizes all the windows with ALT+TAB, or by a click on the

tray icon.

<U>HotCorners</U> - Starts your screensaver, when you leave the mouse-pointer in

one of the desktop corners (nice!).

<U>DirectNet</U> - Automatically dials your ISP, and launches an Internet-app. of

your choice (useful?).

<U>AddLink</U> - Allows you to right-click on a program, and add it to the

start-menu.

Also: <U>DOS-Explore</U> and <U>DialMSN</U> (MSN??? Yucchh!!!), but they are freeware,

so no cracking is needed :-)



I'll use two different approaches to cracking the protection-schemes:

1. Using SoftIce to &quot;Hear the echo&quot;.

2. Using SoftIce/HIEW to turn the program in to a key-gen.



As a template, I'll use AddLink, which is one of the most useful of them.

Actually, StartClean is the most useful, but a dude named Qapla has already

made a tutorial for that program (good work, BTW). 

I'll describe the crack in a way, that'll make it easy apply the same 

approach on the other programs. And I'll also describe, if there's 

something that you should take note of, when using the same approach on the

other programs...</PRE>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT SIZE="+2"><FONT color="blue">Tools required</FONT>

    </FONT></TD>

  </TR>

</TABLE>



<P>SoftIce 3.22 for Win95/NT (any version is useful, though).<BR>

HIEW 5.66 (or whatever hex-editor you prefer).</P>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT SIZE="+2"><FONT color="blue">Target's

    URL/FTP</FONT> </FONT></TD>

  </TR>

</TABLE>

<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->



<P>You can fetch the apps. at the authors homepage:<BR>

<STRONG><A href="javascript:if(confirm('http://users.aol.com/felhasan/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://users.aol.com/felhasan/'" tppabs="http://users.aol.com/felhasan/">http://users.aol.com/felhasan/</A></STRONG></P>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT SIZE="+2"><FONT color="blue">Program History</FONT>

    </FONT></TD>

  </TR>

</TABLE>

<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->



<P>None that I know of (I stumbled over the apps. by coincidence)... Check out the <STRONG><A

href="javascript:if(confirm('http://users.aol.com/felhasan/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://users.aol.com/felhasan/'" tppabs="http://users.aol.com/felhasan/">authors homepage</A></STRONG>, for more info.</P>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT color="blue" SIZE="+2">Essay</FONT> </TD>

  </TR>

</TABLE>

<!-- PASTE HERE THE TEXT OF YOUR ESSAY

     THIS IS OF COURSE THE MOST IMPORTANT PART

     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 

     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE

     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->



<PRE>So let's begin!



Start by installing AddLink (or one of the apps., that you wish to crack).

Start AddLink by right-clicking on any file, select Send To --&gt;  Start Menu.

A nasty <STRONG>*NAG*</STRONG> will show, and remind you to &quot;pay&quot; for the program. Go in to 

SoftIce (<STRONG>CTRL+D</STRONG>) and

<STRONG>BPX Lstrcmp</STRONG>

Press <STRONG>F5</STRONG> to get out of SoftIce...

Select Register...

Enter your name (in my case): <STRONG>-=[JON!]=-</STRONG>

And a fake serial: <STRONG>1212121212</STRONG> (Copyright © <FONT

color="#FF0000">+ORC</FONT>)

Hit ENTER...

Now, SoftIce BREAKS at <STRONG>Lstrcmp</STRONG>!

Type:

<STRONG>BC *</STRONG>

To clear the breakpoint.

Press <STRONG>F11</STRONG> to go back, where it was CALLed from, scroll up a little, and you

see this:



<STRONG>CALL   00401BB0           ;Calculate valid code.

LEA    EAX,[ESP+18]       ;Copy your code to EAX.

ADD    ESP,08

PUSH   EAX                ;PUSH your code.

PUSH   004051C8           ;PUSH valid code.

CALL   [Kernel32!lstrcmp] ;Compare strings.

TEST   EAX,EAX            ;Are you registered?

JNZ    00401BA5           ;If not, JMP to *NAG*!</STRONG>



Now, to retrieve the valid code, you'll need to set a breakpoint on the line

where your code is PUSHed. To do this, simply double-click on that line. 

(If you have mouse disabled, do a BPX XXXX:YYYYYYYY, where XXXX:YYYYYYYY is

the memory location). Now, go out of SoftIce and enter the name and a bogus

code again. Press OK, and SoftIce breaks again. Type:

<STRONG>BD *</STRONG>

to temporarily disable the breakpoint (it will be used later).

Type:

<STRONG><BIG>D 004051C8</BIG></STRONG>

And you discover that the valid code for the name <STRONG>-=[JON!]=-</STRONG> is:

<STRONG>14621-136061-2316-6752</STRONG>.

But why stop here? Why not make a key-gen? To do so, UNREGISTER the program,

by deleting its registry-entries (<STRONG>HKEY_CURRENT_USER\SOFTWARE\ADDLINK</STRONG>).

Now that it's unregistered, start the program, go in to SoftIce and enable

your breakpoint once again:

<STRONG>BE *</STRONG>

Enter something fake and press OK. SoftIce breaks once again, where the

valid code is PUSHed. 

Clear your breakpoint:

<STRONG>BC *</STRONG>

Now, write down the HEX-numbers for the PUSH function: <STRONG>68C8514000</STRONG>

<HR size=1>68C8514000 	PUSH   004051C8          ;PUSH valid code.<HR size=1>

Keep pressing <STRONG>F10</STRONG>, until you see these lines of code:



<STRONG>PUSH   00

PUSH   00

PUSH   004051B4             ;PUSH the text &quot;Incorrect code!&quot;

PUSH   ESI

CALL   [USER32!MessageBoxA] ;CALL the *NAG* dialog.

MOV    EAX,00000001         ;Set EAX=1 (unregistered).</STRONG>



Now, type:

<STRONG>E XXXX:YYYYYYYY</STRONG>

Where XXXX:YYYYYYYY is the memory-location of <STRONG>PUSH   004051B4</STRONG>

Enter the hex-digits you've written down (<STRONG>68C851400</STRONG>).

Press <STRONG>F5</STRONG> to get out of SoftIce, and what shows before your eyes?! A <STRONG>*NAG*</STRONG>

with the valid code for your name!!! <FONT

color="#0000FF">Cool</FONT>, huh?

To make the crack permanent:

<STRONG>HIEW ADDLINK.EXE</STRONG>

Search, <STRONG>F7</STRONG>: <STRONG>6A006A0068<FONT

color="#0000FF">B4</FONT>51400056</STRONG>

                      ^^

Replace   : <STRONG>6A006A0068<FONT

color="#0000FF">C8</FONT>51400056</STRONG>



Save (<STRONG>F9</STRONG>) and exit (<STRONG>F10</STRONG>), and you've got yourself a working key-generator!



<HR size=1>6A006A00<B>68B4514000</B>56  ;push incorrect code has been changed into

6A006A00<B>68C8514000</B>56  ;push correct code<HR size=1>



This can be applied to all the other apps. (some minor differences, of

course), with the exception of QuickDesk and SysLaunch. This is because,

the memory location in which the valid serial is stored is overwritten

before the <STRONG>*NAG*</STRONG> is shown :-( But you can, of course 

still &quot;fish&quot; a serial, using the same method described above.</PRE>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT SIZE="+2"><FONT color="blue">Final Notes</FONT>

    </FONT></TD>

  </TR>

</TABLE>



<PRE>What have we learned?

1.If Lstrcmp is used the compare the codes, it's easy to locate the right 

one, since it has already been calculated!

2. If the programmer hasn't cleared the valid code before the &quot;Incorrect

code!&quot; <STRONG>*NAG*</STRONG>, we can in most cases turn our worst enemy in to a key-gen!

3. The shareware programmers should make the protection-schemes different 

if they have more that one product!

4. SoftIce is the best debugger!

5. Cracking rulez!



Greetings:

<FONT

color="#FF0000">+ORC</FONT>, The +HCU, Fravia+, +Gthorne, all (+)crackers, all the cool cracking 

groups, all those who have killed a spammer, and of course to you, reader of

this essay!



Have Fun! :-)



By Jon, February 9th, 1998.</PRE>



<PRE>PS:

If you have any comments on this crap (good or bad), don't hesitate to

e-mail me at: jon101514(at)cyberjunkie(point)com</PRE>



<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">

  <TR>

    <TD bgcolor="#C6E7C6"><P align="center"><FONT color="blue" SIZE="+2">Ob Duh</FONT> </TD>

  </TR>

</TABLE>

<I>



<P align="center">I wont even bother explaining you that you should BUY these target

programs if you intend to use them for a longer period than the allowed one. Should you want

to STEAL this software instead, you don't need to crack its protection schemes 

at all:

you'll find it on most Warez sites, complete and already regged, farewell.</I> <!-- WAY OUT STARTS HERE --> </P>



<HR>

<I>



<P align="center">You are deep inside fravia's page of reverse engineering, choose your

way out:</I> <BR>

<A href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG 

    SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif"

   ALT="student" ALIGN="CENTER" WIDTH="114"

    HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></A>

<BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM"

WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html"

tppabs="http://www.fravia.org/index.html">homepage</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm"

tppabs="http://www.fravia.org/links.htm">links</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm"

tppabs="http://www.fravia.org/searengi.htm">search_forms</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM"

WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm"

tppabs="http://www.fravia.org/student.htm">students' essays</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm"

tppabs="http://www.fravia.org/academy.htm">academy database</A> <BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM"

WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm"

tppabs="http://www.fravia.org/realicra.htm">reality cracking</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm"

tppabs="http://www.fravia.org/howtosea.htm">how to search</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm"

tppabs="http://www.fravia.org/javascri.htm">javascript wars</A> <BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM"

WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm"

tppabs="http://www.fravia.org/tools.htm">tools</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm"

tppabs="http://www.fravia.org/noanon.htm">anonymity academy</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm"

tppabs="http://www.fravia.org/cocktail.htm">cocktails</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm"

tppabs="http://fravia.org/ideale.htm">antismut CGI-scripts</A> <IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif"

tppabs="http://www.fravia.org/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13"

BORDER="0" VSPACE="0" HSPACE="0"><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm"

tppabs="http://www.fravia.org/info.htm">mail_fravia+</A> <BR>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN="BOTTOM"

WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm"

tppabs="http://www.fravia.org/legal.htm">Is reverse engineering legal?</A> </P>



<HR>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML>