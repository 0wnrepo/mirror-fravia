<HTML>

<HEAD>

<!--  formamus.htm version 02 February 1998 

      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!

      SEARCH THIS TEXT FOR THE STRING "Your_" 

      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 

      THANKS A LOT: this will allow automated retrieval -->

<TITLE>hs2l_22.htm Web Browser emulation</TITLE>

</HEAD>



<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100% 

HEIGHT=" 22">

<TR><td></td>

<td>

<!-- Choose  a TITLE probably wont be changed -->

<center><FONT SIZE="+2">Web Browser emulation<bR>(Letting web pages get less info about you)</fonT><br>

        <FONT SIZE="+1">and some "anti-anti-internet exploder"

tricks</fonT>

</center>

</td>



<td>

<!-- Choose  a PROJECT GIF, leave this if unsure -->

<center><a href="student.htm#student_loo_na" tppabs="http://www.anticrack.de/fravia/student.htm#student_loo_na"><IMG SRC="notassi3.gif" tppabs="http://www.anticrack.de/fravia/notassi3.gif"

ALT="student" 

ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 

HSPACE=0></a>

<br>

<font color=gray>Not Assigned</FonT>

</center></td></tr>

<tR>

<td bgcolor="#FFFFEA"><center>

<FONT COLOR="890000">

<!-- CHOOSE A DATE (will probably be changed) -->

3 May 1998

</FONT></center>

</td>

<td bgcolor="#FFFFEA"><center>by <font size=+3>

<!-- CHOOSE A HANDLE (wont be changed) -->

Hs2L

</fonT></center>

</td>

<td VALIGN="center" bgcolor="#FFFFEA">

<!--

<a href="hcu98_3.htm" tppabs="http://www.anticrack.de/fravia/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://www.anticrack.de/fravia/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 

WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

-->

</td>

</tr>

<TR><td><center><a href="index.html" tppabs="http://www.anticrack.de/fravia/index.html"><IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALIGN="BOTTOM" 

BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>

<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 

reverse engineering</center> 

</center></TD>

<td BGCOLOR="898030">

<center>

<!-- Your truly+ will edit only if really necessary -->

slightly edited<br>

by fravia+</center></td>

</TR>

<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not

ass... -->

<tr><td><font

color="#C4C0CF">fra_00xx<bR>980503<br>H2sL<br>0100<br>NA<br>PC<br></fonT>

</td><td><i><center>

<!-- Your truly+ comments -->

Well, a nice addition to our reversing efforts! Hs2L proves here that EVERYTHING 

can be reversed, and our silly little tricks too... the simple truth is that 

NOTHING can last long if a true reverser lays his eyes (and brain) on it... and 

that our science is powerful indeed... but this we knew already, didn't we?<br>

Of course we'll open right now an <u>anti-reversing reversed browsers</u> new section... 

that name information you (cleverly) changed is 

NOT the only difference between browsers, dear H2sL... :-)

</i></center></td>

<td></td>

</tr>

<TR><td></td>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything



That's how the light gets in</b></center>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

</center></TD><td></td>

</TR>

<TR>

<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

Rating</FONT></FONT></center>

</TD>

<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>

<!-- CHOOSE A RATING (may be changed) -->

( )<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>

</center></td>

<td></td>

</tr>

</table>

<!-- END HEAD  -->

<bR>

<!-- CORPUS  -->



<!-- CHOOSE A COMMENT (may be changed)  -->

Since this site is somewhat anti-micro$oft, this essay will be a departure

from the norm since it discusses reversing the micro$oft hostile tricks but

it's reversing anyway, so it might be appropriate.

<hR>

<center>

   <FONT SIZE="+2">

<!-- CHOOSE A TITLE (wont probably be changed) -->

Faking Web Browsers

   </FONT><BR>

   <FONT SIZE="+2">

<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->

Letting web pages get less info about you

   </FONT><BR>

   <FONT COLOR="0B7FC1">

<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 

Hs2L

   </FONT>

</center><br><br>



<!-- INTRO STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 

HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font

color=blue>Introduction</fonT>

</fonT></center></td></tr></table>

<pre>

We are going to reverse Fravia's anti internet exploder tricks and figure

out how to fool web pages<!-- PASTE HERE YOUR INTRODUCTION -->

</prE>



<!-- TOOLS STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 

HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools

required</fonT>

</fonT></center></td></tr></table>

Hex Editor (HexWorkshop)

Borland Resource Workshop (not a must)

A local copy of 2 web pages.

First, Mammons page (use the link in the tools section)

and Fravia's counter measure page (the one where it tells you what browser

you're using)

A window spy tool (not a must)

<!-- PASTE HERE YOUR REQUIRED TOOLS -->

<br><br>



<!-- REAL ESSAY  STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 

HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font

color=blue>Essay</fonT></fonT>

</center></td></tr></table>

<!-- PASTE HERE THE TEXT OF YOUR ESSAY

     THIS IS OF COURSE THE MOST IMPORTANT PART

     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 

     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE

     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->

<pre>

This essay outlines an  extremely trivial task as you will see.

Anyway... (many of you all will probably kill me for this), for 

some time I have been using Micro$oft's IE as my web browser. 

I accidently deleted a few libraries that are required by Netscape 

3.0 Gold (which is STILL NOW my favorite browser BTW) So, for

some time I had no choice but to go with IE3 until I got the 

necesarry runtime files.

So, needless to say, when I tried to visit Mammons site which I visit every

now and then, I was at the losing end of what is IMHO, a hilarious script 

in Mammon's web page. Basically, if you enter his site with IE, you

automatically get booted to the Netscape home page. There are probably 

lots of anti-ie sites so I decided to do some work on reversing these 

"anti-whatever_browser" scripts.

So, lets take a look at the relevant source code for Mammons web page (yes

even a simple excersise like this ends up with some deadlisting or other)

<font color=blue>

...

function disclaimer(){

  var i=navigator.appName

  var j="Microsoft Internet Explorer"

      if ( i==j ) {

            msie=window.open("msie.html", "Micro$oft?",

              "width=250,height=75,status=no,scrollbars=no,toolbar=no,

              location=no,menubar=no,resizable=no,directories=no");

            dclose=msie.setTimeout("closeme()",2500);

            Location.href="http://www.netscape.com";

                   }

      else {

            location.replace("http://www.eccentrica.org/Mammon");

            }

...</fonT>



So, as you can see, the function navigator.appName returns the name of the

Internet Browser you are using. This info is,ofcourse,sent from the browser

itself or one of it's libraries. If we can find out where it's coming from

we can edit it and change the Browser name that is returned by 

navigator.appName



Here's the relevant snippet from Fravia's counter measure page:

<font color=blue>

...

document.write("MMM..., my dear ") 

document.write(n)

document.write("... I see you've got ")

</fonT>

and...

<font color=blue>

document.writeln( navigator.appName + " (" + 

navigator.appCodeName + ") " + navigator.appVersion + "")

</fonT>

So, over here, navigator.appName,navigator.appCodeName and

navigator.appVersion are called to comunicate with the browser and get 

the relevant infomation.



So, the question is, where does all this info come from. Well, lets open 

Internet Exploder in BRW and see what we find. Well, it turns out that it's only

got icons, bitmaps, and versions, no string tables. That means the relevant info

is coming from a library (*.dll). Well, I fired up my buggy internet exploder

and used my windows spying tool to get parent the controls (Any windows spying

tool will do. You can probably write a quick one in VB or Delphi like I did)

It turns out that the actual viewing window is from MSHTML.DLL and the toolbar

is from SHDOW_something_or_other.dll. So, we'll try MSHTML.DLL and see what we

find. After opening the file in Hex Workshop, we do a search for "Microsoft

Internet Explorer" since that's the value returned by navigator.appName and

we hit paydirt. This is the relevant hex dump:



000216CC 4D69 6372 6F73 6F66 7420 496E Microsoft In

000216D8 7465 726E 6574 2045 7870 6C6F ternet Explo

000216E4 7265 7200 4D6F 7A69 6C6C 612F rer.Mozilla/

000216F0 322E 3020 2863 6F6D 7061 7469 2.0 (compati

000216FC 626C 653B 204D 5349 4520 332E ble; MSIE 3.

00021708 3041 3B20 5769 6E64 6F77 7320 0A; Windows 

00021714 3935 2900 0000 0000 5356 57BE 95).....SVW.



Have you seen Fravia's counter measure page in your we browser?

Well, I get something like this with Internet Exploder:



MMM..., my dear Hs2L... I see you've 

got Microsoft Internet Explorer (Mozilla) 2.0 (compatible; MSIE 3.0A;

Windows 95) 

let's hope it does not suck.





I don't have to knock you over the head to make you see the connection. Now

we know the relevant info is in MSHTML.DLL

Ok, lets change it:



000216CC 4E6F 6E65 206F 6620 796F 7572 None of your

000216D8 2062 7573 696E 6573 7320 2121  business !!

000216E4 2121 212E 4765 746C 6F73 742F !!!.Getlost/

000216F0 5468 6973 2069 6E66 6F20 6973 This info is

000216FC 6E6F 6E65 206F 6620 796F 7572 none of your

00021708 2062 7573 696E 6573 7320 626C  business bl

00021714 6168 2900 0000 0000 5356 57BE ah).....SVW.





We try to save the file and what happens? We get a stupid "sharing

violation" message. Even after rebooting and editing MSHTML.DLL. IF we attempt to

save, we see this message. Looks like Bill Gates & Co. doesn't want us playing

around with these files (even though they are legally OURS). So, we simply exit

windows to DOS and either use Hiew and make the changes in DOS, or save the changes

with HexWorkshop to a different file and rename them in DOS mode.



Now, a web page will think your browser's name is "None of your business!"

This suits us fine because now we won't be prone to any anti-IE tricks or

by a rare chance, if we come across anti-Netscape tricks we won't be prone to

those too. What about Browser Faking with Netscape?

As I said,I'm yet to collect the relevant files I'm missing but, unlike

IE, Netscape stores most of its resources (if not all) in the executable

That probably explains why Netscape is 3MB while IE is 35KB.So, we can load

up BRW with Netscape and search for the relevant string tables. You should

find one with the string "Netscape" and one with "Mozilla" These are the

strings to change. Make the changes, recompile and you're done. 

Now,we just wait and see what fravia+ and Mammon will do to catch these 

anti-anti-ie tricks :).

</prE>

<br><br>



<!-- FINAL NOTES STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 

HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final

Notes</fonT>

</fonT></center></td></tr></table>

<pre>

Please don't flame me for using IE, I prefer Netscape just as much as the 

next guy, but as I said, I'm yet to collect the relevant files. 

Send your insults and comments to shivanan@ens.lk<!-- PASTE HERE YOUR FINAL

NOTES (if any) -->

</pre>

<br><br>



<!-- OB DUH STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 

HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob

Duh</fonT></fonT>

</center></td></tr></table>

 <center>

   <i>Ob duh doesn't apply here, we are modyfying our own browsers, and 

we can do whatever we want with our own files, so get lost, silly lawyers!</i>

</center>



<!-- WAY OUT STARTS HERE -->

<hr>

<center><i>You are deep inside fravia's page of reverse engineering,  

choose your way out:</i></center>

<br><center>

<!-- EITHER A NICE GIF LIKE THIS -->



<!-- 

<a href="project3.htm" tppabs="http://www.anticrack.de/fravia/project3.htm"><IMG SRC="project3.gif" tppabs="http://www.anticrack.de/fravia/project3.gif" 

ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0

HSPACE=0></a>

<br>

<font color=gray>Back to project 3</FonT>

<br><bR>

-->



<!-- OR JUST A LINK LIKE THIS -->



<!--

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://www.anticrack.de/fravia/project1.htm">Back to

Your_chosen_project</A> 

<hr width=33%>

-->



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://www.anticrack.de/fravia/index.html">homepage</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://www.anticrack.de/fravia/links.htm">links</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://www.anticrack.de/fravia/searengi.htm">search_forms</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://www.anticrack.de/fravia/orc.htm">+ORC</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://www.anticrack.de/fravia/student.htm">students' essays</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://www.anticrack.de/fravia/academy.htm">academy database</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://www.anticrack.de/fravia/realicra.htm">reality cracking</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://www.anticrack.de/fravia/howtosea.htm">how to search</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://www.anticrack.de/fravia/javascri.htm">javascript wars</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://www.anticrack.de/fravia/tools.htm">tools</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://www.anticrack.de/fravia/noanon.htm">anonymity academy</A> 

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://www.anticrack.de/fravia/cocktail.htm">cocktails</A>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://www.anticrack.de/fravia/ideale.htm">antismut

CGI-scripts</A>



<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://www.anticrack.de/fravia/info.htm">mail_fravia+</A>

<br>

<IMG SRC="bulletr.gif" tppabs="http://www.anticrack.de/fravia/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://www.anticrack.de/fravia/legal.htm">Is reverse engineering

legal?</A>

</CENTER>

<hr>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML>

